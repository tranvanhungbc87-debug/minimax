{
  "script": "// ==UserScript==\n// @name         Kz Tool - Clone Voice (Kh\u00f4ng c\u1ea7n API) - Modded\n// @namespace    mmx-secure\n// @version      1.2.0\n// @description  T\u1ea1o audio gi\u1ecdng n\u00f3i clone theo \u00fd c\u1ee7a b\u1ea1n. Kh\u00f4ng gi\u1edbi h\u1ea1n. Th\u00eam ch\u1ee9c n\u0103ng Gh\u00e9p h\u1ed9i tho\u1ea1i & \u0110\u1ed5i v\u0103n b\u1ea3n h\u00e0ng lo\u1ea1t.\n// @author       Huy Nguyen - Kz Tool (Zalo: 0986562876)\n// @match        https://www.minimax.io/audio*\n// @icon         https://www.google.com/s2/favicons?sz=64&domain=minimax.io\n// @run-at       document-end\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_addStyle\n// @require      https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js\n// @connect      unpkg.com\n// @connect      cdn.jsdelivr.net\n// ==/UserScript==\n\n\n/* ========================================================================== */\n/* B\u1ea2N QUY\u1ec0N PH\u1ea6N M\u1ec0M THU\u1ed8C V\u1ec0: HUY NGUYEN - KZ TOOL                        */\n/* ZALO: 0986562876                                                          */\n/* ========================================================================== */\n\n\n(function () {\n    'use strict';\n\n    // =================================================================\n    // == CH\u1ed0NG F12 / CH\u1ed0NG DEVTOOLS ==\n    // =================================================================\n    (function() {\n        'use strict';\n        \n        // 1. Disable right-click\n        document.addEventListener('contextmenu', function(e) {\n            e.preventDefault();\n            return false;\n        }, true);\n        \n        // 2. Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U\n        document.addEventListener('keydown', function(e) {\n            // F12\n            if (e.key === 'F12' || e.keyCode === 123) {\n                e.preventDefault();\n                return false;\n            }\n            // Ctrl+Shift+I (DevTools)\n            if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.keyCode === 73)) {\n                e.preventDefault();\n                return false;\n            }\n            // Ctrl+Shift+J (Console)\n            if (e.ctrlKey && e.shiftKey && (e.key === 'J' || e.keyCode === 74)) {\n                e.preventDefault();\n                return false;\n            }\n            // Ctrl+Shift+C (Inspect Element)\n            if (e.ctrlKey && e.shiftKey && (e.key === 'C' || e.keyCode === 67)) {\n                e.preventDefault();\n                return false;\n            }\n            // Ctrl+U (View Source)\n            if (e.ctrlKey && (e.key === 'U' || e.keyCode === 85)) {\n                e.preventDefault();\n                return false;\n            }\n        }, true);\n        \n        // 3. Detect DevTools b\u1eb1ng c\u00e1ch check window size\n        let devtoolsOpen = false;\n        const threshold = 160;\n        \n        const detectDevTools = () => {\n            const widthThreshold = window.outerWidth - window.innerWidth > threshold;\n            const heightThreshold = window.outerHeight - window.innerHeight > threshold;\n            const orientation = widthThreshold ? 'vertical' : 'horizontal';\n            \n            if (!(heightThreshold && widthThreshold) && \n                ((window.Firebug && window.Firebug.chrome && window.Firebug.chrome.isInitialized) || \n                 widthThreshold || heightThreshold)) {\n                if (!devtoolsOpen) {\n                    devtoolsOpen = true;\n                    console.clear();\n                    // Redirect v\u1ec1 trang ch\u1ee7 n\u1ebfu ph\u00e1t hi\u1ec7n DevTools\n                    if (window.location.href.includes('minimax.io/audio')) {\n                        window.location.href = 'https://www.minimax.io/audio/voices-cloning';\n                    }\n                }\n            } else {\n                devtoolsOpen = false;\n            }\n        };\n        \n        // 4. Detect DevTools b\u1eb1ng debugger statement\n        const detectDevToolsDebugger = () => {\n            const before = new Date().getTime();\n            debugger;\n            const after = new Date().getTime();\n            \n            if (after - before > 100) {\n                // DevTools detected\n                console.clear();\n                if (window.location.href.includes('minimax.io/audio')) {\n                    window.location.href = 'https://www.minimax.io/audio/voices-cloning';\n                }\n            }\n        };\n        \n        // 5. Clear console \u0111\u1ecbnh k\u1ef3\n        const clearConsoleInterval = setInterval(() => {\n            console.clear();\n        }, 1000);\n        \n        // 6. Check DevTools \u0111\u1ecbnh k\u1ef3\n        setInterval(detectDevTools, 1000);\n        \n        // 7. Protect console methods\n        const noop = () => {};\n        const methods = ['log', 'debug', 'info', 'warn', 'error', 'table', 'trace', 'dir', 'group', 'groupCollapsed', 'groupEnd', 'clear'];\n        methods.forEach(method => {\n            console[method] = noop;\n        });\n        \n        // 8. Detect DevTools using toString()\n        const element = new Image();\n        Object.defineProperty(element, 'id', {\n            get: function() {\n                devtoolsOpen = true;\n                if (window.location.href.includes('minimax.io/audio')) {\n                    window.location.href = 'https://www.minimax.io/audio/voices-cloning';\n                }\n            }\n        });\n        \n        console.log('%c', element);\n        \n        console.log('%c\u26a0\ufe0f C\u1ea2NH B\u00c1O B\u1ea2O M\u1eacT', 'color: red; font-size: 40px; font-weight: bold;');\n        console.log('%cN\u1ebfu c\u00f3 ng\u01b0\u1eddi b\u1ea3o b\u1ea1n copy/paste code v\u00e0o \u0111\u00e2y, \u0111\u00f3 c\u00f3 th\u1ec3 l\u00e0 l\u1eeba \u0111\u1ea3o!', 'color: yellow; font-size: 16px;');\n        \n    })();\n\n\n    // =================================================================\n    // == PH\u1ea6N CSS V\u00c0 C\u00c1C H\u00c0M KH\u00c1C ==\n    // =================================================================\n\n    const SCRIPT_CSS = `.logo{background:#fff;width:fit-content;padding:2px;border-radius:8px}.logo-user{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.mmx-login-prompt-btn{position:fixed;z-index:999990;background-color:#6a4ff1;color:#fff;padding:10px 20px;font-size:16px;font-weight:700;border:none;border-radius:8px;cursor:pointer;box-shadow:0 5px 15px rgba(0,0,0,0.3);text-decoration:none;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Arial,sans-serif;transition:transform .2s ease,background-color .2s ease;top:10px;left:50%}.mmx-login-prompt-btn:hover{background-color:#462fb8}#mmx-login-overlay{position:fixed;inset:0;z-index:999999;background:#0f1220;color:#e5e7eb;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Arial,sans-serif;display:flex;align-items:center;justify-content:center}#mmx-login-card{width:420px;max-width:92vw;background:#171a2a;border:1px solid #27304a;border-radius:14px;padding:22px 20px;box-shadow:0 10px 30px rgba(0,0,0,.45)}#mmx-login-card h2{font-size:20px;color:#8be9fd}#mmx-login-card p.sub{color:#94a3b8;font-size:13px}#mmx-login-form label{display:block;font-size:13px;margin-bottom:6px;color:#c7d2fe}#mmx-api-input{width:100%;box-sizing:border-box;padding:12px;border-radius:10px;border:1px solid #334155;background:#0b1020;color:#e2e8f0;outline:none}#mmx-api-input::placeholder{color:#64748b}#mmx-login-actions{display:flex;gap:10px;margin-top:14px;align-items:center}#mmx-login-btn{flex:1;padding:10px 14px;background:#50fa7b;color:#0b1020;border:none;border-radius:10px;font-weight:700;cursor:pointer}#mmx-login-btn[disabled]{opacity:.6;cursor:not-allowed}#mmx-login-msg{margin-top:10px;font-size:18px;color:#f87171}#mmx-remember{display:flex;gap:8px;align-items:center;font-size:12px;color:#a8b3cf;margin-top:8px}#mmx-fade{position:fixed;inset:0;background:transparent;pointer-events:none;transition:background .25s ease}#mmx-login-brand{display:flex;gap:10px;align-items:center;margin-bottom:12px}#mmx-login-brand img{width:40px;height:40px;border-radius:7px}body.mmx-active{overflow:hidden}#gemini-main-container{display:flex;width:100vw;height:100vh;position:fixed;top:0;left:0;background-color:#282a36;color:#f8f8f2;z-index:9999;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif;gap:10px;padding:10px;box-sizing:border-box}.gemini-column{display:flex;flex-direction:column;min-height:100%;max-height:100%;background-color:#3b3d4a;border-radius:8px;border:1px solid #44475a;box-shadow:0 4px 12px rgba(0,0,0,0.2)}#gemini-col-1{width:20%}#gemini-col-2{width:60%}#gemini-col-3{width:20%}.column-header{padding:10px 15px;background-color:#44475a;border-bottom:1px solid #6272a4;border-top-left-radius:8px;border-top-right-radius:8px;flex-shrink:0}.column-header h3{margin:0;font-size:16px;color:#bd93f9}.column-content{padding:15px;overflow-y:auto;flex-grow:1}.box-info-version{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.column-content::-webkit-scrollbar{width:6px}.column-content::-webkit-scrollbar-track{background:#282a36}.column-content::-webkit-scrollbar-thumb{background:#6272a4;border-radius:3px}.column-content::-webkit-scrollbar-thumb:hover{background:#bd93f9}.section{margin-bottom:20px}.section h4{margin:0 0 10px;color:#bd93f9;font-size:14px;border-bottom:1px solid #44475a;padding-bottom:5px}#gemini-file-input,#gemini-language-select,#gemini-main-textarea{width:100%;box-sizing:border-box;background-color:#282a36;color:#f8f8f2;border:1px solid #6272a4;border-radius:4px;padding:10px;margin-bottom:8px;font-size:14px}#gemini-main-textarea{height:42vh;resize:vertical}#gemini-text-stats{display:flex;justify-content:space-around;font-size:12px;color:#f1fa8c;background-color:#44475a;padding:5px;border-radius:4px;margin-top:5px}button{width:100%;padding:12px;border:none;border-radius:5px;font-weight:700;font-size:14px;cursor:pointer;transition:all .2s ease-in-out}button:disabled{background-color:#6c757d!important;color:#333!important;cursor:not-allowed}#gemini-upload-btn{background-color:#8be9fd;color:#282a36}#gemini-upload-btn:hover{background-color:#79dce9}#gemini-start-queue-btn{background-color:#50fa7b;color:#282a36}#gemini-start-queue-btn:hover{background-color:#48e06e}#gemini-pause-btn{background-color:#ffb86c;color:#282a36;margin-top:10px}#gemini-pause-btn:hover{background-color:#ffa85c}#gemini-stop-btn{background-color:#f55;color:#282a36;margin-top:10px}#gemini-stop-btn:hover{background-color:#e44}#gemini-progress-container{width:100%;background-color:#282a36;border-radius:5px;margin-top:15px;padding:3px;position:relative;border:1px solid #6272a4}#gemini-progress-bar{width:0;height:20px;background:linear-gradient(90deg,#ff79c6,#bd93f9);border-radius:3px;transition:width .4s ease-in-out}#gemini-progress-label{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-weight:700;font-size:12px;text-shadow:1px 1px 2px #000}#gemini-final-result{margin-top:20px}#gemini-time-taken{font-size:14px;color:#8be9fd;text-align:center;margin-bottom:10px;font-weight:700}#gemini-waveform{background-color:#282a36;border-radius:5px;border:1px solid #6272a4;padding:10px}#waveform-controls a,#waveform-controls button{display:inline-block;width:auto;padding:8px 15px;margin:0 5px;text-decoration:none;font-weight:700;border-radius:5px}#waveform-play-pause{background-color:#ffb86c;color:#282a36}#gemini-download-merged-btn{background-color:#8be9fd;color:#282a36}.banner-column a{display:block;margin-bottom:15px}.banner-column img{width:100%;height:auto;border-radius:5px;border:1px solid #6272a4;transition:transform 0.2s,box-shadow .2s}.banner-column img:hover{transform:scale(1.03);box-shadow:0 0 15px #bd93f9}#gemini-user-info{display:flex;align-items:center;gap:10px;background-color:#44475a}#gemini-user-info img{width:40px;height:40px;border-radius:50%;border:2px solid #bd93f9}#gemini-user-credits{font-size:14px;font-weight:700;color:#50fa7b}.social-minimax{margin:20px 0!important}.social-minimax a{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;justify-content:flex-start;gap:10px;margin-bottom:10px!important;cursor:pointer;font-size:14px;font-weight:700}.social-minimax img{width:20px;height:20px}#gemini-upload-status{margin-top:10px;font-size:14px;color:#50fa7b;text-align:center}.social-minimax-login{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:auto;gap:10px}.social-minimax.social-minimax-login{margin-bottom:0!important}.chinh-sach-su-dung,.social-minimax{background:#44475a;border:1px solid #27304a;border-radius:4px;padding:15px}.chinh-sach-su-dung h2,.social-minimax h2{font-size:16px;font-weight:700;margin-bottom:10px}.chinh-sach-su-dung ul{list-style:auto;padding-left:20px}.chinh-sach-su-dung ul{}.chinh-sach-su-dung li{margin-bottom:10px}.box-ads-img{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:auto;gap:10px}a.youtube123{display:flex;gap:10px;flex-direction:row;flex-wrap:nowrap;align-items:center;justify-content:flex-start;font-size: 16px;font-weight: bold;color: #ffe900;}.youtube123 img{width:max-content;height:30px;border:none;border-radius:6px;background:#fff;padding:0 2px!important}\n/* Styles for Merge Button */\n#gemini-merge-btn {\n    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%) !important;\n    color: #1a1d2e !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n}\n\n#gemini-merge-btn:hover {\n    background: linear-gradient(135deg, #fcd34d 0%, #fbbf24 100%) !important;\n    box-shadow: 0 4px 20px rgba(251, 191, 36, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n\n/* Styles for Punctuation Settings Button */\n#open-punctuation-settings-btn {\n    background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%) !important;\n    color: #ffffff !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n}\n\n#open-punctuation-settings-btn:hover {\n    background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%) !important;\n    box-shadow: 0 4px 20px rgba(168, 85, 247, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n\n/* Styles for History Modal Button */\n#open-history-modal-btn {\n    background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;\n    color: #ffffff !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n}\n\n#open-history-modal-btn:hover {\n    background: linear-gradient(135deg, #34d399 0%, #10b981 100%) !important;\n    box-shadow: 0 4px 20px rgba(16, 185, 129, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n\n/* Styles for T\u1ea1o file h\u00e0ng lo\u1ea1t Button */\n#open-batch-modal-btn {\n    background: linear-gradient(135deg, #f1fa8c 0%, #e8ea75 100%) !important;\n    color: #282a36 !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    box-shadow: 0 4px 15px rgba(241, 250, 140, 0.3) !important;\n}\n\n#open-batch-modal-btn:hover {\n    background: linear-gradient(135deg, #e8ea75 0%, #d4d65e 100%) !important;\n    box-shadow: 0 6px 20px rgba(241, 250, 140, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n\n/* Styles for Log Modal Button */\n#open-log-modal-btn {\n    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important;\n    color: #ffffff !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n}\n\n#open-log-modal-btn:hover {\n    background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%) !important;\n    box-shadow: 0 4px 20px rgba(59, 130, 246, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n\n/* Styles for Load Text File Button */\n#load-text-file-btn {\n    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important;\n    color: #ffffff !important;\n    font-weight: 600 !important;\n    border: none !important;\n    padding: 6px 12px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3) !important;\n    font-size: 12px !important;\n}\n\n#load-text-file-btn:hover {\n    background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%) !important;\n    box-shadow: 0 4px 15px rgba(59, 130, 246, 0.5) !important;\n    transform: translateY(-1px) !important;\n}\n\n/* Styles for Waveform Control Buttons */\n#waveform-play-pause {\n    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%) !important;\n    color: #1a1d2e !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n}\n\n#waveform-play-pause:hover {\n    background: linear-gradient(135deg, #fcd34d 0%, #fbbf24 100%) !important;\n    box-shadow: 0 4px 20px rgba(251, 191, 36, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n\n#gemini-download-merged-btn {\n    background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;\n    color: #fff !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3) !important;\n}\n\n#gemini-download-merged-btn:hover {\n    background: linear-gradient(135deg, #34d399 0%, #10b981 100%) !important;\n    box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n\n#gemini-download-chunks-btn {\n    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%) !important;\n    color: #fff !important;\n    font-weight: 700 !important;\n    border: none !important;\n    padding: 12px 16px !important;\n    border-radius: 8px !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n}\n\n#gemini-download-chunks-btn:hover {\n    background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%) !important;\n    box-shadow: 0 4px 20px rgba(139, 92, 246, 0.5) !important;\n    transform: translateY(-2px) !important;\n}\n/* Styles for Saved Audio Library Section */\n#saved-audio-library{margin-top:20px;background:rgba(22,28,45,0.55);border:1px solid rgba(100,200,255,0.1);border-radius:14px;padding:15px;box-shadow:inset 0 0 15px rgba(100,200,255,0.05)}\n#saved-audio-library h4{margin:0 0 10px;color:#92e7ff;font-size:14px;border-bottom:1px solid rgba(100,200,255,0.2);padding-bottom:5px;text-shadow:0 0 8px rgba(90,200,255,0.3)}\n#saved-audio-list{max-height:200px;overflow-y:auto;background:#282a36;border:1px solid #6272a4;border-radius:4px;margin-bottom:10px}\n#saved-audio-list::-webkit-scrollbar{width:6px}\n#saved-audio-list::-webkit-scrollbar-track{background:#282a36}\n#saved-audio-list::-webkit-scrollbar-thumb{background:#6272a4;border-radius:3px}\n#saved-audio-list::-webkit-scrollbar-thumb:hover{background:#bd93f9}\n.saved-audio-item{display:flex;align-items:center;padding:8px;border-bottom:1px solid#44475a;transition:background-color .2s ease}\n.saved-audio-item:hover{background-color:#44475a}\n.saved-audio-name{flex-grow:1;font-size:12px;color:#f8f8f2;margin-right:10px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}\n.saved-audio-duration{font-size:11px;color:#8be9fd;margin-right:10px;min-width:40px}\n.saved-audio-date{font-size:10px;color:#94a3b8;margin-right:10px;min-width:70px}\n.use-saved-audio-btn{min-width:32px;width:32px;height:32px;padding:0;font-size:14px;background:linear-gradient(135deg,#50fa7b 0%,#4ade80 100%);color:#1a1d2e;border:none;border-radius:6px;cursor:pointer;margin-right:6px;font-weight:600;transition:all 0.2s ease;box-shadow:0 2px 4px rgba(80,250,123,0.2);display:flex;align-items:center;justify-content:center}\n.use-saved-audio-btn:hover{background:linear-gradient(135deg,#4ade80 0%,#50fa7b 100%);transform:translateY(-1px);box-shadow:0 4px 8px rgba(80,250,123,0.3)}\n.delete-saved-audio-btn{min-width:32px!important;width:32px!important;height:32px!important;padding:0!important;font-size:14px!important;background:linear-gradient(135deg,#ff5555 0%,#e44 100%)!important;color:#fff!important;border:none!important;border-radius:6px!important;cursor:pointer!important;pointer-events:auto!important;opacity:1!important;display:flex!important;align-items:center!important;justify-content:center!important;transition:all 0.2s ease!important;box-shadow:0 2px 4px rgba(255,85,85,0.2)!important}\n.delete-saved-audio-btn:hover{background:linear-gradient(135deg,#e44 0%,#ff5555 100%)!important;transform:translateY(-1px)!important;box-shadow:0 4px 8px rgba(255,85,85,0.3)!important}\n.delete-audio-swal-container{z-index:999999!important}\n.delete-audio-swal-popup{z-index:1000000!important}\n/* Styles for Batch Replace Section */\n#batch-replace-section{margin-top:20px;background:#2d3148;border:2px solid #3d4158;border-radius:12px;padding:15px}\n#batch-replace-section h4{margin:0 0 12px;color:#00d4ff;font-size:15px;border-bottom:2px solid #3d4158;padding-bottom:8px;font-weight:600}\n#batch-replace-pairs{display:flex;flex-direction:column;gap:8px;max-height:30vh;overflow-y:auto;padding-right:5px;margin-bottom:10px}\n#batch-replace-pairs::-webkit-scrollbar{width:8px}\n#batch-replace-pairs::-webkit-scrollbar-track{background:#1a1d2e}\n#batch-replace-pairs::-webkit-scrollbar-thumb{background:#00d4ff;border-radius:4px}\n#batch-replace-pairs::-webkit-scrollbar-thumb:hover{background:#00e5ff}\n.replace-pair-row{display:flex;gap:8px;align-items:center}\n.replace-pair-row input{flex-grow:1;width:40%;box-sizing:border-box;background-color:#1a1d2e;color:#f8f8f2;border:2px solid #2d3148;border-radius:8px;padding:8px 10px;font-size:13px}\n.replace-pair-row .remove-pair-btn{width:28px;height:28px;min-width:28px;padding:0;font-size:20px;line-height:1;background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);color:#fff;flex-shrink:0;border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s ease}\n.replace-pair-row .remove-pair-btn:hover{transform:scale(1.1);box-shadow:0 4px 12px rgba(239,68,68,0.4)}\n#batch-replace-actions{display:flex;gap:8px;margin-top:10px}\n#add-replace-pair-btn{width:auto;min-width:42px;background:linear-gradient(135deg,#a855f7 0%,#7c3aed 100%);color:#fff;padding:8px 14px;font-size:16px;border-radius:8px}\n#add-replace-pair-btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(168,85,247,0.4)}\n#execute-replace-btn{flex-grow:1;background:linear-gradient(135deg,#00d4ff 0%,#00a8cc 100%);color:#fff;padding:8px 16px;font-size:13px;font-weight:600;border-radius:8px}\n#execute-replace-btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,212,255,0.4)}\n/* Log Section Styles */\n.log-section{background:#44475a;border:1px solid #27304a;border-radius:4px;padding:15px;margin-top:15px}\n.log-section h2{font-size:16px;font-weight:700;margin-bottom:10px;color:#bd93f9}\n.log-container{background:#282a36;border:1px solid #6272a4;border-radius:4px;padding:10px;max-height:200px;overflow-y:auto;margin-bottom:10px}\n.log-container::-webkit-scrollbar{width:6px}\n.log-container::-webkit-scrollbar-track{background:#282a36}\n.log-container::-webkit-scrollbar-thumb{background:#6272a4;border-radius:3px}\n.log-container::-webkit-scrollbar-thumb:hover{background:#bd93f9}\n.log-entry{color:#f8f8f2;font-size:12px;margin-bottom:5px;padding:3px 0;border-bottom:1px solid #44475a}\n.log-entry:last-child{border-bottom:none}\n.log-entry.info{color:#8be9fd}\n.log-entry.success{color:#50fa7b}\n.log-entry.warning{color:#ffb86c}\n.log-entry.error{color:#f55}\n.clear-log-btn{width:100%;background-color:#f55;color:#f8f8f2;padding:8px;border:none;border-radius:4px;font-weight:700;cursor:pointer;transition:background-color .2s ease}\n.clear-log-btn:hover{background-color:#e44}\n\n/* START: Styles for Punctuation Settings Modal */\n.punctuation-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); z-index: 10000; display: flex; align-items: center; justify-content: center; }\n.punctuation-modal-card { background: #3b3d4a; border-radius: 8px; border: 1px solid #44475a; box-shadow: 0 5px 20px rgba(0,0,0,0.3); width: 380px; max-width: 90vw; color: #f8f8f2; }\n.punctuation-modal-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 18px; background-color: #44475a; border-bottom: 1px solid #6272a4; border-top-left-radius: 8px; border-top-right-radius: 8px; }\n.punctuation-modal-header h3 { margin: 0; font-size: 16px; color: #bd93f9; }\n.punctuation-modal-close-btn { background: none; border: none; color: #f8f8f2; font-size: 24px; cursor: pointer; padding: 0; line-height: 1; width: auto; }\n.punctuation-modal-body { padding: 20px; display: flex; flex-direction: column; gap: 15px; }\n.punctuation-setting-row { display: grid; grid-template-columns: 120px 1fr; align-items: center; gap: 10px; }\n.punctuation-setting-row label { font-size: 14px; }\n.punctuation-input-group { display: flex; align-items: center; background-color: #282a36; border: 1px solid #6272a4; border-radius: 4px; }\n.punctuation-input-group button { width: 30px; height: 30px; background: #44475a; color: #f8f8f2; border: none; font-size: 18px; cursor: pointer; padding: 0; line-height: 30px; }\n.punctuation-input-group button:first-child { border-top-left-radius: 3px; border-bottom-left-radius: 3px; border-right: 1px solid #6272a4; }\n.punctuation-input-group button:last-child { border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-left: 1px solid #6272a4; }\n.punctuation-input-group input { width: 100%; text-align: center; background: transparent; border: none; color: #f8f8f2; padding: 5px; font-size: 14px; -moz-appearance: textfield; }\n.punctuation-input-group input::-webkit-outer-spin-button, .punctuation-input-group input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }\n.punctuation-modal-footer { padding: 12px 18px; background: #44475a; border-top: 1px solid #6272a4; display: flex; gap: 10px; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px; }\n#save-punctuation-settings-btn { background: linear-gradient(135deg, #46ffd9, #12c8f2); color: #0b0e14; flex-grow: 1; }\n#default-punctuation-settings-btn { background: linear-gradient(135deg, #ffc76c, #ff9e4c); color: #1e1108; flex-grow: 1; }\n.punctuation-setting-row.toggle-row{grid-template-columns:1fr auto;padding-bottom:10px;border-bottom:1px solid #44475a;margin-bottom:15px}.toggle-row label{font-weight:700;color:#8be9fd}.switch{position:relative;display:inline-block;width:50px;height:28px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#6272a4;-webkit-transition:.4s;transition:.4s}.slider:before{position:absolute;content:\"\";height:20px;width:20px;left:4px;bottom:4px;background-color:#fff;-webkit-transition:.4s;transition:.4s}input:checked+.slider{background-color:#50fa7b}input:focus+.slider{box-shadow:0 0 1px #50fa7b}input:checked+.slider:before{-webkit-transform:translateX(22px);-ms-transform:translateX(22px);transform:translateX(22px)}.slider.round{border-radius:28px}.slider.round:before{border-radius:50%}\n/* END: Styles for Punctuation Settings Modal */\n\n/* START: Styles for Audio Folder Manager */\n#audio-folder-manager {\n    margin-top: 20px;\n    margin-bottom: 20px;\n    background: rgba(22,28,45,0.55);\n    border: 1px solid rgba(100,150,255,0.1);\n    border-radius: 14px;\n    padding: 15px;\n    box-shadow: inset 0 0 15px rgba(100,200,255,0.05);\n    position: relative;\n    z-index: 1;\n    display: block !important;\n    visibility: visible !important;\n}\n\n#audio-folder-manager h4 {\n    margin: 0 0 10px;\n    color: #92e7ff;\n    font-size: 14px;\n    border-bottom: 1px solid rgba(100,200,255,0.2);\n    padding-bottom: 5px;\n    text-shadow: 0 0 8px rgba(90,200,255,0.3);\n}\n\n#folder-select-btn {\n    background: linear-gradient(135deg, #46ffd9, #12c8f2);\n    color: #0b0e14;\n    margin-bottom: 10px;\n    font-weight: 700;\n    width: 100% !important;\n    display: block !important;\n    cursor: pointer !important;\n    position: relative;\n    z-index: 2;\n}\n\n#folder-select-btn:hover {\n    background: linear-gradient(135deg, #5bfff1, #3bd8ff);\n    box-shadow: 0 0 25px rgba(90,255,230,0.6);\n}\n\n#selected-folder-path {\n    background: #282a36;\n    border: 1px solid #6272a4;\n    border-radius: 4px;\n    padding: 8px;\n    margin-bottom: 10px;\n    color: #f1fa8c;\n    font-size: 12px;\n    cursor: pointer;\n    transition: all 0.2s ease;\n}\n\n#selected-folder-path:hover {\n    background-color: #44475a;\n    border-radius: 4px;\n    padding: 4px 8px;\n}\n\n#audio-list-container {\n    max-height: 200px;\n    overflow-y: auto;\n    background: #282a36;\n    border: 1px solid #6272a4;\n    border-radius: 4px;\n    margin-bottom: 10px;\n}\n\n#audio-list-container::-webkit-scrollbar {\n    width: 6px;\n}\n\n#audio-list-container::-webkit-scrollbar-track {\n    background: #282a36;\n}\n\n#audio-list-container::-webkit-scrollbar-thumb {\n    background: #6272a4;\n    border-radius: 3px;\n}\n\n#audio-list-container::-webkit-scrollbar-thumb:hover {\n    background: #bd93f9;\n}\n\n.audio-item {\n    display: flex;\n    align-items: center;\n    padding: 8px;\n    border-bottom: 1px solid #44475a;\n    transition: background-color 0.2s ease;\n}\n\n.audio-item:hover {\n    background-color: #44475a;\n}\n\n.audio-item.playing {\n    background-color: #50fa7b;\n    color: #282a36;\n}\n\n.audio-name {\n    flex-grow: 1;\n    font-size: 12px;\n    color: #f8f8f2;\n    margin-right: 10px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.audio-duration {\n    font-size: 11px;\n    color: #8be9fd;\n    margin-right: 10px;\n    min-width: 40px;\n}\n\n.play-btn {\n    width: 24px;\n    height: 24px;\n    padding: 0;\n    font-size: 12px;\n    background-color: #6272a4;\n    color: #f8f8f2;\n    border: none;\n    border-radius: 50%;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: background-color 0.2s ease;\n}\n\n.play-btn:hover {\n    background-color: #50fa7b;\n    color: #282a36;\n}\n\n.play-btn:disabled {\n    background-color: #6c757d;\n    cursor: not-allowed;\n}\n\n#refresh-audio-list-btn {\n    background: linear-gradient(135deg, #46ffd9, #12c8f2);\n    color: #0b0e14;\n    font-size: 12px;\n    padding: 8px;\n    width: 100% !important;\n    display: block !important;\n    cursor: pointer !important;\n    position: relative;\n    z-index: 2;\n}\n\n#refresh-audio-list-btn:hover {\n    background: linear-gradient(135deg, #5bfff1, #3bd8ff);\n    box-shadow: 0 0 25px rgba(90,255,230,0.6);\n}\n/* END: Styles for Audio Folder Manager */\n\n/* START: Styles for Punctuation Detection Modal */\n#punctuation-detection-modal {\n    backdrop-filter: blur(5px);\n    animation: fadeIn 0.3s ease;\n}\n\n#punctuation-detection-modal > div {\n    animation: slideIn 0.3s ease;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n}\n\n/* Danh s\u00e1ch l\u1ed7i d\u1ea5u c\u00e2u */\n#punctuation-issues-list {\n    max-height: 300px;\n    overflow-y: auto;\n    scrollbar-width: thin;\n    scrollbar-color: #6272a4 #282a36;\n}\n\n#punctuation-issues-list::-webkit-scrollbar {\n    width: 8px;\n}\n\n#punctuation-issues-list::-webkit-scrollbar-track {\n    background: #282a36;\n    border-radius: 4px;\n}\n\n#punctuation-issues-list::-webkit-scrollbar-thumb {\n    background: #6272a4;\n    border-radius: 4px;\n}\n\n#punctuation-issues-list::-webkit-scrollbar-thumb:hover {\n    background: #50fa7b;\n}\n\n/* N\u00fat trong modal */\n#auto-fix-punctuation-btn {\n    background: linear-gradient(135deg, #46ffd9, #12c8f2) !important;\n    color: #0b0e14 !important;\n    transition: all 0.3s ease;\n    font-weight: bold;\n    position: relative;\n    overflow: hidden;\n}\n\n#auto-fix-punctuation-btn:hover {\n    background: linear-gradient(135deg, #5bfff1, #3bd8ff) !important;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(90, 255, 230, 0.6);\n}\n\n#ignore-punctuation-btn {\n    background: rgba(90,100,120,0.6) !important;\n    transition: all 0.3s ease;\n    font-weight: bold;\n    position: relative;\n    overflow: hidden;\n}\n\n#ignore-punctuation-btn:hover {\n    background: rgba(110,120,150,0.8) !important;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(98, 114, 164, 0.4);\n}\n\n/* N\u00fat \u0111\u00f3ng modal */\n#close-punctuation-modal {\n    transition: all 0.2s ease;\n}\n\n#close-punctuation-modal:hover {\n    background: #ff3333 !important;\n    transform: scale(1.1);\n}\n\n/* Select dropdown */\n#default-punctuation-select {\n    transition: all 0.2s ease;\n}\n\n#default-punctuation-select:hover {\n    border-color: #50fa7b !important;\n    box-shadow: 0 0 0 2px rgba(80, 250, 123, 0.2);\n}\n\n#default-punctuation-select:focus {\n    outline: none;\n    border-color: #50fa7b !important;\n    box-shadow: 0 0 0 2px rgba(80, 250, 123, 0.3);\n}\n\n/* Items trong danh s\u00e1ch l\u1ed7i */\n.punctuation-issue-item {\n    transition: all 0.2s ease;\n}\n\n.punctuation-issue-item:hover {\n    transform: translateX(5px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n}\n\n/* Animations */\n@keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateY(-30px) scale(0.9);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Responsive design */\n@media (max-width: 768px) {\n    #punctuation-detection-modal > div {\n        width: 95%;\n        padding: 15px;\n        max-height: 90vh;\n    }\n\n    #punctuation-detection-modal h3 {\n        font-size: 16px;\n    }\n\n    #auto-fix-punctuation-btn, #ignore-punctuation-btn {\n        min-width: 100px;\n        padding: 10px 16px;\n        font-size: 13px;\n    }\n\n    .punctuation-issue-item {\n        padding: 10px;\n        font-size: 13px;\n    }\n}\n\n@media (max-width: 480px) {\n    #punctuation-detection-modal > div {\n        width: 98%;\n        padding: 10px;\n    }\n\n    #punctuation-detection-modal h3 {\n        font-size: 14px;\n    }\n\n    #auto-fix-punctuation-btn, #ignore-punctuation-btn {\n        width: 100%;\n        margin: 5px 0;\n    }\n}\n/* END: Styles for Punctuation Detection Modal */\n\n/* START: Styles for Custom Filename Input */\n#custom-filename-input {\n    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%) !important;\n    border: 2px solid #6272a4 !important;\n    border-radius: 12px !important;\n    padding: 14px !important;\n    transition: all 0.3s ease !important;\n    font-family: inherit !important;\n    color: #f8f8f2 !important;\n    font-size: 14px !important;\n}\n\n#custom-filename-input:focus {\n    border-color: #8be9fd !important;\n    box-shadow: 0 0 0 3px rgba(139, 233, 253, 0.1) !important;\n    outline: none !important;\n}\n\n#custom-filename-input::placeholder {\n    color: #94a3b8 !important;\n    font-style: italic !important;\n}\n\n.custom-filename-section {\n    background: rgba(68, 75, 90, 0.3) !important;\n    border: 1px solid rgba(98, 114, 164, 0.2) !important;\n    border-radius: 8px !important;\n    padding: 15px !important;\n    margin-top: 15px !important;\n}\n\n.custom-filename-section label {\n    color: #bd93f9 !important;\n    font-weight: 600 !important;\n    font-size: 14px !important;\n    margin-bottom: 8px !important;\n    display: block !important;\n}\n\n.custom-filename-section small {\n    color: #94a3b8 !important;\n    font-size: 12px !important;\n    margin-top: 5px !important;\n    display: block !important;\n    line-height: 1.4 !important;\n}\n/* END: Styles for Custom Filename Input */\n\n/* ===== MODERN UI IMPROVEMENTS ===== */\n* {\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif;\n    line-height: 1.6;\n}\n\n/* Enhanced Logo */\n.logo {\n    background: linear-gradient(90deg, #4fd1c5, #4299e1) !important;\n    -webkit-background-clip: text !important;\n    -webkit-text-fill-color: transparent !important;\n    font-weight: 800 !important;\n    font-size: 22px !important;\n    text-shadow: 0 0 12px rgba(90, 200, 255, 0.4) !important;\n    width: fit-content !important;\n    padding: 8px 16px !important;\n}\n\n/* Enhanced Main Container */\n#gemini-main-container {\n    background: linear-gradient(135deg, #1a1d2e 0%, #16213e 100%) !important;\n    gap: 16px !important;\n    padding: 16px !important;\n}\n\n/* Enhanced Columns */\n.gemini-column {\n    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%) !important;\n    border-radius: 16px !important;\n    border: 1px solid #4a5568 !important;\n    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3) !important;\n    backdrop-filter: blur(20px) !important;\n    overflow: hidden !important;\n}\n\n#gemini-col-1 {\n    width: 35% !important;\n    min-width: 350px !important;\n}\n\n#gemini-col-2 {\n    width: 65% !important;\n    min-width: 500px !important;\n}\n\n/* Enhanced Headers */\n.column-header {\n    padding: 16px 20px !important;\n    background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%) !important;\n    border-top-left-radius: 16px !important;\n    border-top-right-radius: 16px !important;\n    position: relative !important;\n}\n\n.column-header::after {\n    content: '';\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg, #8be9fd, #bd93f9, #ff79c6);\n}\n\n.column-header h3 {\n    font-size: 18px !important;\n    font-weight: 700 !important;\n    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;\n}\n\n/* Enhanced Content */\n.column-content {\n    padding: 20px !important;\n    background: rgba(45, 55, 72, 0.3) !important;\n    overflow-y: auto !important;\n    height: calc(100vh - 120px) !important;\n    \n    /* Firefox scrollbar */\n    scrollbar-width: thin !important;\n    scrollbar-color: #6272a4 #2d3748 !important;\n}\n\n/* Webkit Scrollbar (Chrome, Edge, Safari) */\n.column-content::-webkit-scrollbar {\n    width: 12px !important;\n    background: transparent !important;\n}\n\n.column-content::-webkit-scrollbar-track {\n    background: rgba(45, 55, 72, 0.8) !important;\n    border-radius: 6px !important;\n    margin: 4px 0 !important;\n}\n\n.column-content::-webkit-scrollbar-thumb {\n    background: linear-gradient(135deg, #6272a4 0%, #bd93f9 100%) !important;\n    border-radius: 6px !important;\n    border: 2px solid rgba(45, 55, 72, 0.8) !important;\n    transition: all 0.3s ease !important;\n}\n\n.column-content::-webkit-scrollbar-thumb:hover {\n    background: linear-gradient(135deg, #bd93f9 0%, #ff79c6 100%) !important;\n    box-shadow: 0 0 10px rgba(189, 147, 249, 0.5) !important;\n}\n\n.column-content::-webkit-scrollbar-thumb:active {\n    background: linear-gradient(135deg, #ff79c6 0%, #bd93f9 100%) !important;\n}\n\n/* Enhanced Sections */\n.section {\n    margin-bottom: 24px !important;\n    background: rgba(68, 75, 90, 0.3) !important;\n    border-radius: 12px !important;\n    padding: 16px !important;\n    border: 1px solid rgba(98, 114, 164, 0.2) !important;\n    backdrop-filter: blur(10px) !important;\n}\n\n.section h4 {\n    font-size: 16px !important;\n    border-bottom: 2px solid #44475a !important;\n    padding-bottom: 8px !important;\n    font-weight: 700 !important;\n    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;\n}\n\n/* Enhanced Inputs */\n#gemini-file-input,\n#gemini-language-select,\n#gemini-main-textarea {\n    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%) !important;\n    border: 2px solid #4a5568 !important;\n    border-radius: 12px !important;\n    padding: 14px !important;\n    margin-bottom: 12px !important;\n    transition: all 0.3s ease !important;\n    font-family: inherit !important;\n}\n\n#gemini-file-input:focus,\n#gemini-language-select:focus,\n#gemini-main-textarea:focus {\n    border-color: #8be9fd !important;\n    box-shadow: 0 0 0 3px rgba(139, 233, 253, 0.1) !important;\n    outline: none !important;\n}\n\n#gemini-main-textarea {\n    line-height: 1.6 !important;\n}\n\n/* Enhanced Stats */\n#gemini-text-stats {\n    background: rgba(45, 55, 72, 0.5) !important;\n    padding: 8px !important;\n    border-radius: 10px !important;\n    margin-top: 8px !important;\n    border: 1px solid rgba(98, 114, 164, 0.2) !important;\n    font-weight: 600 !important;\n    display: flex !important;\n    justify-content: flex-end !important;\n    gap: 6px !important;\n}\n\n#gemini-text-stats span {\n    display: flex !important;\n    flex-direction: column !important;\n    align-items: center !important;\n    justify-content: center !important;\n    background: linear-gradient(135deg, rgba(139, 233, 253, 0.1) 0%, rgba(189, 147, 249, 0.1) 100%) !important;\n    padding: 6px 10px !important;\n    border-radius: 8px !important;\n    font-size: 12px !important;\n    min-width: 70px !important;\n    border: 1px solid rgba(139, 233, 253, 0.15) !important;\n    color: #8be9fd !important;\n}\n\n/* User Info Badge */\n#gemini-user-info {\n    background: linear-gradient(135deg, #50fa7b 0%, #4ade80 100%) !important;\n    color: #1a1d2e !important;\n    padding: 6px 14px !important;\n    border-radius: 20px !important;\n    font-size: 13px !important;\n    font-weight: 700 !important;\n    box-shadow: 0 2px 8px rgba(80, 250, 123, 0.3) !important;\n}\n\n/* Enhanced Buttons */\nbutton {\n    padding: 14px !important;\n    border-radius: 12px !important;\n    font-size: 15px !important;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n    position: relative !important;\n    overflow: hidden !important;\n    font-family: inherit !important;\n}\n\nbutton::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n    transition: left 0.5s;\n}\n\nbutton:hover::before {\n    left: 100%;\n}\n\nbutton:disabled {\n    background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%) !important;\n    transform: none !important;\n}\n\n/* Enhanced Specific Buttons */\n#gemini-upload-btn {\n    background: linear-gradient(135deg, #46ffd9 0%, #12c8f2 100%) !important;\n    color: #0b0e14 !important;\n    font-weight: 700 !important;\n    box-shadow: 0 4px 15px rgba(70, 255, 217, 0.3) !important;\n}\n\n#gemini-upload-btn:hover {\n    background: linear-gradient(135deg, #5bfff1 0%, #3bd8ff 100%) !important;\n    transform: translateY(-2px) !important;\n    box-shadow: 0 0 25px rgba(90, 255, 230, 0.6) !important;\n}\n\n#gemini-start-queue-btn {\n    background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;\n    color: #fff !important;\n    box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3) !important;\n    font-weight: 700 !important;\n}\n\n#gemini-start-queue-btn:hover {\n    background: linear-gradient(135deg, #34d399 0%, #10b981 100%) !important;\n    transform: translateY(-2px) !important;\n    box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5) !important;\n}\n\n#gemini-pause-btn {\n    background: linear-gradient(135deg, #ffb86c 0%, #ffa85c 100%) !important;\n    box-shadow: 0 4px 15px rgba(255, 184, 108, 0.3) !important;\n}\n\n#gemini-pause-btn:hover {\n    background: linear-gradient(135deg, #ffa85c 0%, #ff9500 100%) !important;\n    transform: translateY(-2px) !important;\n    box-shadow: 0 8px 25px rgba(255, 184, 108, 0.4) !important;\n}\n\n#gemini-stop-btn {\n    background: linear-gradient(135deg, #ff5555 0%, #e44 100%) !important;\n    box-shadow: 0 4px 15px rgba(255, 85, 85, 0.3) !important;\n}\n\n#gemini-stop-btn:hover {\n    background: linear-gradient(135deg, #e44 0%, #d33 100%) !important;\n    transform: translateY(-2px) !important;\n    box-shadow: 0 8px 25px rgba(255, 85, 85, 0.4) !important;\n}\n\n/* Merge & Punctuation buttons - already styled above */\n\n/* Text Input Options Styles */\n.text-input-options {\n    margin-bottom: 0;\n}\n\n.input-area {\n    display: none;\n}\n\n.input-area.active {\n    display: block;\n}\n\n/* File Upload Styles */\n.file-upload-section {\n    margin-bottom: 12px;\n}\n\n.file-upload-area {\n    border: 2px dashed #6272a4;\n    border-radius: 12px;\n    padding: 40px 20px;\n    text-align: center;\n    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);\n    cursor: pointer;\n    transition: all 0.3s ease;\n    position: relative;\n    overflow: hidden;\n}\n\n.file-upload-area:hover {\n    border-color: #8be9fd;\n    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);\n    transform: translateY(-2px);\n    box-shadow: 0 8px 25px rgba(139, 233, 253, 0.2);\n}\n\n.file-upload-area.dragover {\n    border-color: #50fa7b;\n    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);\n    box-shadow: 0 0 20px rgba(80, 250, 123, 0.3);\n}\n\n.upload-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    opacity: 0.7;\n}\n\n.upload-text {\n    color: #f8f8f2;\n}\n\n.upload-text strong {\n    color: #bd93f9;\n    font-size: 16px;\n    display: block;\n    margin-bottom: 8px;\n}\n\n.upload-text small {\n    color: #94a3b8;\n    font-size: 12px;\n}\n\n.file-info {\n    background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);\n    border: 1px solid rgba(98, 114, 164, 0.3);\n    border-radius: 8px;\n    padding: 12px;\n    margin-top: 12px;\n}\n\n.file-details {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 12px;\n}\n\n.file-name {\n    color: #8be9fd;\n    font-weight: 600;\n    flex: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.file-size {\n    color: #94a3b8;\n    font-size: 12px;\n    flex-shrink: 0;\n}\n\n.remove-file-btn {\n    background: linear-gradient(135deg, #ff5555 0%, #e44 100%);\n    color: white;\n    border: none;\n    border-radius: 50%;\n    width: 24px;\n    height: 24px;\n    font-size: 16px;\n    font-weight: bold;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s ease;\n    flex-shrink: 0;\n    margin: 0;\n    padding: 0;\n    width: auto;\n}\n\n.remove-file-btn:hover {\n    background: linear-gradient(135deg, #e44 0%, #d33 100%);\n    transform: scale(1.1);\n    box-shadow: 0 4px 15px rgba(255, 85, 85, 0.4);\n}`;\n    const APP_HTML = `<div id=\"gemini-col-1\" class=\"gemini-column\"> <div class=\"column-header\"><div class=\"logo-user\"><a href=\"\" tager=\"_blank\"><div class=\"logo\"><img src=\"https://minimax.buhaseo.com/wp-content/uploads/2025/08/logo-minimax.png\"></div></a><div id=\"gemini-user-info\"></div></div></div> <div class=\"column-content\"> <div class=\"section\" style=\"margin-bottom: 10px!important;\"> <h4>1. Ch\u1ecdn file \u00e2m thanh (nh\u1ea5n n\u00fat T\u1ea2I L\u00caN \u1edf b\u00ean d\u01b0\u1edbi)</h4> <input type=\"file\" id=\"gemini-file-input\" accept=\".wav,.mp3,.mpeg,.mp4,.m4a,.avi,.mov,.wmv,.flv,.mkv,.webm\" multiple> </div> <div class=\"section\"> <h4>2. Ch\u1ecdn ng\u00f4n ng\u1eef</h4> <select id=\"gemini-language-select\"><option value=\"Vietnamese\">Vietnamese</option><option value=\"English\">English</option><option value=\"Arabic\">Arabic</option><option value=\"Cantonese\">Cantonese</option><option value=\"Chinese (Mandarin)\">Chinese (Mandarin)</option><option value=\"Dutch\">Dutch</option><option value=\"French\">French</option><option value=\"German\">German</option><option value=\"Indonesian\">Indonesian</option><option value=\"Italian\">Italian</option><option value=\"Japanese\">Japanese</option><option value=\"Korean\">Korean</option><option value=\"Portuguese\">Portuguese</option><option value=\"Russian\">Russian</option><option value=\"Spanish\">Spanish</option><option value=\"Turkish\">Turkish</option><option value=\"Ukrainian\">Ukrainian</option><option value=\"Thai\">Thai</option><option value=\"Polish\">Polish</option><option value=\"Romanian\">Romanian</option><option value=\"Greek\">Greek</option><option value=\"Czech\">Czech</option><option value=\"Finnish\">Finnish</option><option value=\"Hindi\">Hindi</option><option value=\"Bulgarian\">Bulgarian</option><option value=\"Danish\">Danish</option><option value=\"Hebrew\">Hebrew</option><option value=\"Malay\">Malay</option><option value=\"Persian\">Persian</option><option value=\"Slovak\">Slovak</option><option value=\"Swedish\">Swedish</option><option value=\"Croatian\">Croatian</option><option value=\"Filipino\">Filipino</option><option value=\"Hungarian\">Hungarian</option><option value=\"Norwegian\">Norwegian</option><option value=\"Slovenian\">Slovenian</option><option value=\"Catalan\">Catalan</option><option value=\"Nynorsk\">Nynorsk</option><option value=\"Tamil\">Tamil</option><option value=\"Afrikaans\">Afrikaans</option></select> <button id=\"gemini-upload-btn\" style=\"margin-top: 12px; width: 100%;\"><i class=\"fas fa-music\" style=\"margin-right: 8px;\"></i>T\u1ea3i l\u00ean \u00e2m thanh</button> <div id=\"gemini-upload-status\"></div> </div> <div id=\"saved-audio-library\" class=\"section\"> <h4>\ud83d\udcbe Audio \u0111\u00e3 l\u01b0u</h4> <div id=\"saved-audio-list\"> <div style=\"padding: 10px; text-align: center; color: #94a3b8;\">Ch\u01b0a c\u00f3 audio n\u00e0o \u0111\u01b0\u1ee3c l\u01b0u</div> </div> <button id=\"clear-saved-audio-btn\" style=\"width: 100%; background: linear-gradient(135deg, #ff5555 0%, #e44 100%); color: #fff; display: none;\">\ud83d\uddd1\ufe0f X\u00f3a t\u1ea5t c\u1ea3 audio \u0111\u00e3 l\u01b0u</button> </div> <div id=\"batch-replace-section\" class=\"section\"> <h4>\ud83d\udcdd \u0110\u1ed5i v\u0103n b\u1ea3n h\u00e0ng lo\u1ea1t</h4> <div id=\"batch-replace-pairs\"></div> <div id=\"batch-replace-actions\"> <button id=\"add-replace-pair-btn\">\u2795</button> <button id=\"execute-replace-btn\">Th\u1ef1c hi\u1ec7n thay th\u1ebf</button> </div> </div> <div class=\"section\"> <h4>\ud83d\udcc1 Qu\u1ea3n l\u00fd th\u01b0 m\u1ee5c \u00e2m thanh</h4> <div id=\"audio-folder-manager\" style=\"background: #44475a; border: 1px solid #6272a4; border-radius: 8px; padding: 12px;\"> <button id=\"folder-select-btn\" style=\"width: 100%; margin-bottom: 10px;\">\ud83d\udcc2 Ch\u1ecdn th\u01b0 m\u1ee5c ch\u1ee9a MP3</button> <div id=\"selected-folder-path\" style=\"display:none;\"></div> <div id=\"audio-list-container\" style=\"display:none;\"> <div style=\"padding: 10px; text-align: center; color: #94a3b8;\">Ch\u01b0a c\u00f3 file MP3 n\u00e0o</div> </div> <button id=\"refresh-audio-list-btn\" style=\"display:none; width: 100%; margin-top: 10px;\">\ud83d\udd04 L\u00e0m m\u1edbi danh s\u00e1ch</button> </div> </div> </div> </div> </div> <div id=\"gemini-col-2\" class=\"gemini-column\"> <div class=\"column-header\"><div class=\"box-info-version\"><h3>\ud83c\udf99\ufe0f Voice Studio Pro</h3><span style=\"color: #8be9fd; font-size: 12px; font-weight: 600;\">Version 2.0.0 - Professional Edition</span></div></div> <div class=\"column-content\">         <div class=\"section text-section\"> <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;\"><h4 style=\"margin: 0;\">Nh\u1eadp v\u0103n b\u1ea3n c\u1ea7n t\u1ea1o gi\u1ecdng n\u00f3i</h4><button id=\"load-text-file-btn\" style=\"width: auto;\">\ud83d\udcc4 T\u1ea3i t\u1eeb file</button></div><input type=\"file\" id=\"text-file-input\" accept=\".txt,.doc,.docx,.rtf,.odt,.pdf,.md,.html,.htm,.xml,.csv,.json\" style=\"display: none;\"><div class=\"text-input-options\"><div id=\"text-input-area\" class=\"input-area active\"><textarea id=\"gemini-main-textarea\" placeholder=\"\u2728 Nh\u1eadp ho\u1eb7c d\u00e1n v\u0103n b\u1ea3n c\u1ee7a b\u1ea1n t\u1ea1i \u0111\u00e2y \u0111\u1ec3 chuy\u1ec3n th\u00e0nh gi\u1ecdng n\u00f3i chuy\u00ean nghi\u1ec7p...\n\u2847\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\n            \"></textarea></div><div id=\"file-input-area\" class=\"input-area\" style=\"display: none;\"><div class=\"file-upload-section\"><div class=\"file-upload-area\" id=\"file-upload-area\" style=\"display: none;\"><div class=\"upload-icon\">\ud83d\udcc4</div><div class=\"upload-text\"><strong>K\u00e9o th\u1ea3 file v\u00e0o \u0111\u00e2y ho\u1eb7c click \u0111\u1ec3 ch\u1ecdn</strong><br><small>H\u1ed7 tr\u1ee3: TXT, DOC, DOCX, RTF, ODT, PDF, MD, HTML, XML, CSV, JSON</small></div></div><div id=\"file-info\" class=\"file-info\" style=\"display: none;\"><div class=\"file-details\"><span class=\"file-name\"></span><span class=\"file-size\"></span><button id=\"remove-file-btn\" class=\"remove-file-btn\">\u00d7</button></div></div></div></div></div>\n    <div id=\"gemini-text-stats\"><span>K\u00fd t\u1ef1: 0</span><span>T\u1eeb: 0</span><span>C\u00e2u: 0</span><span>\u0110o\u1ea1n: 0</span></div>\n\n<div style=\"display: flex; gap: 10px; margin-bottom: 15px;\"><button id=\"gemini-merge-btn\" style=\"flex: 1;\">T\u1ea1o \u0111o\u1ea1n li\u1ec1n m\u1ea1ch</button><button id=\"open-punctuation-settings-btn\" style=\"flex: 1;\">\u2699\ufe0f C\u00e0i \u0111\u1eb7t</button><button id=\"open-history-modal-btn\" style=\"flex: 1;\">\ud83c\udfb5 Audio \u0111\u00e3 t\u1ea1o</button><button id=\"open-log-modal-btn\" style=\"flex: 1;\" onclick=\"document.getElementById('log-modal').style.display='flex'\">\ud83d\udccb Xem Log</button></div><div style=\"display: flex; gap: 10px; margin-bottom: 15px;\"><button id=\"open-batch-modal-btn\" style=\"flex: 1; background: linear-gradient(135deg, #f1fa8c 0%, #e8ea75 100%); color: #282a36; font-weight: 600;\">\ud83d\udcda T\u1ea1o file h\u00e0ng lo\u1ea1t</button></div> </div> <button id=\"gemini-start-queue-btn\" disabled>B\u1eaft \u0111\u1ea7u t\u1ea1o \u00e2m thanh</button> <button id=\"apply-punctuation-btn\" style=\"display:none; background-color: #ffb86c; color: #282a36; margin-top: 10px;\">\u00c1p d\u1ee5ng thi\u1ebft l\u1eadp d\u1ea5u c\u00e2u</button> <div style=\"display: flex; gap: 10px;\"><button id=\"gemini-pause-btn\" style=\"display:none; flex: 1;\">T\u1ea1m d\u1eebng</button> <button id=\"gemini-stop-btn\" style=\"display:none; flex: 1;\">D\u1eebng h\u1eb3n</button></div> <div id=\"gemini-progress-container\" style=\"display:none;\"><div id=\"gemini-progress-bar\"></div><span id=\"gemini-progress-label\">0%</span></div> <div id=\"gemini-final-result\" style=\"display:none;\"> <h4>K\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng</h4> <div id=\"gemini-time-taken\"></div> <div id=\"gemini-waveform\"></div> <div id=\"waveform-controls\" style=\"display:none; margin-top: 10px;\"><div style=\"display: flex; gap: 10px; justify-content: center;\"><button id=\"waveform-play-pause\" style=\"flex: 1; max-width: 150px;\">Play</button><a id=\"gemini-download-merged-btn\" href=\"#\" download=\"merged_output.mp3\" style=\"flex: 1; max-width: 150px; display: flex; align-items: center; justify-content: center; text-decoration: none;\">Download Audio</a><button id=\"gemini-download-chunks-btn\" style=\"display: none; flex: 1; max-width: 150px;\">Download Chunks</button></div></div> </div> </div> </div> <textarea id=\"gemini-hidden-text-for-request\" style=\"display:none;\"></textarea>\n\n    <!-- Modal ph\u00e1t hi\u1ec7n d\u1ea5u c\u00e2u -->\n    <div id=\"punctuation-detection-modal\" style=\"display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; justify-content: center; align-items: center;\">\n        <div style=\"background: #282a36; border: 2px solid #6272a4; border-radius: 8px; padding: 20px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto;\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;\">\n                <h3 style=\"margin: 0; color: #ffb86c; font-size: 18px;\">\u26a0\ufe0f Ph\u00e1t hi\u1ec7n d\u1ea5u c\u00e2u tr\u00f9ng l\u1eb7p</h3>\n                <button id=\"close-punctuation-modal\" onclick=\"window.ignoreAllPunctuationIssues()\" style=\"background: #ff5555; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 14px;\">\u2715</button>\n            </div>\n\n            <div id=\"punctuation-issues-list\" style=\"margin-bottom: 20px;\"></div>\n\n            <div style=\"background: #44475a; padding: 15px; border-radius: 6px; border: 1px solid #6272a4;\">\n                <div style=\"display: flex; gap: 15px; align-items: center; flex-wrap: wrap;\">\n                    <label style=\"color: #f8f8f2; font-size: 14px; font-weight: bold;\">D\u1ea5u c\u00e2u m\u1eb7c \u0111\u1ecbnh:</label>\n                    <select id=\"default-punctuation-select\" style=\"background: #282a36; color: #f8f8f2; border: 1px solid #6272a4; border-radius: 4px; padding: 8px 12px; font-size: 14px; min-width: 150px;\">\n                        <option value=\".\">D\u1ea5u ch\u1ea5m (.)</option>\n                        <option value=\",\">D\u1ea5u ph\u1ea9y (,)</option>\n                        <option value=\"!\">D\u1ea5u ch\u1ea5m than (!)</option>\n                        <option value=\"?\">D\u1ea5u ch\u1ea5m h\u1ecfi (?)</option>\n                    </select>\n                </div>\n\n                <div style=\"display: flex; gap: 10px; margin-top: 15px; justify-content: center;\">\n                    <button id=\"auto-fix-punctuation-btn\" onclick=\"window.autoFixAllPunctuationIssues()\" style=\"background: #50fa7b; color: #282a36; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: bold; min-width: 120px;\">\ud83d\udd27 T\u1ef1 \u0111\u1ed9ng s\u1eeda t\u1ea5t c\u1ea3</button>\n                    <button id=\"ignore-punctuation-btn\" onclick=\"window.ignoreAllPunctuationIssues()\" style=\"background: #6272a4; color: #f8f8f2; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: bold; min-width: 120px;\">\u274c B\u1ecf qua t\u1ea5t c\u1ea3</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Modal Audio \u0111\u00e3 t\u1ea1o -->\n    <div id=\"history-modal\" style=\"display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; justify-content: center; align-items: center;\" onclick=\"if(event.target.id==='history-modal') this.style.display='none'\">\n        <div style=\"background: #282a36; border: 2px solid #6272a4; border-radius: 8px; padding: 20px; max-width: 800px; width: 90%; max-height: 85vh; overflow-y: auto;\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;\">\n                <h3 style=\"margin: 0; color: #bd93f9; font-size: 20px; font-weight: bold;\">\ud83c\udfb5 Audio \u0111\u00e3 t\u1ea1o</h3>\n                <div style=\"display: flex; gap: 10px; align-items: center;\">\n                    <button id=\"clear-all-history-btn\" style=\"background: #ff5555; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600;\">\ud83d\uddd1\ufe0f X\u00f3a t\u1ea5t c\u1ea3</button>\n                    <button onclick=\"document.getElementById('history-modal').style.display='none'\" style=\"background: #6272a4; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 18px; width: auto;\">\u2715</button>\n                </div>\n            </div>\n            <div id=\"history-list\" style=\"display: flex; flex-direction: column; gap: 12px;\">\n                <!-- History items will be inserted here -->\n            </div>\n        </div>\n    </div>\n\n    <!-- Modal T\u1ea1o file h\u00e0ng lo\u1ea1t -->\n    <div id=\"batch-modal\" style=\"display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; justify-content: center; align-items: center;\" onclick=\"if(event.target.id==='batch-modal') this.style.display='none'\">\n        <div style=\"background: #282a36; border: 2px solid #6272a4; border-radius: 8px; padding: 20px; max-width: 900px; width: 90%; max-height: 85vh; display: flex; flex-direction: column;\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;\">\n                <h3 style=\"margin: 0; color: #f1fa8c; font-size: 20px; font-weight: bold;\">\ud83d\udcda T\u1ea1o file h\u00e0ng lo\u1ea1t - T\u1ea1o audio cho nhi\u1ec1u file</h3>\n                <button onclick=\"document.getElementById('batch-modal').style.display='none'\" style=\"background: #6272a4; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 18px;\">\u2715</button>\n            </div>\n            \n            <input type=\"file\" id=\"batch-files-input\" accept=\".txt\" multiple style=\"display: none;\">\n            \n            <div style=\"margin-bottom: 15px;\">\n                <button id=\"select-batch-files-btn\" style=\"width: 100%; background: linear-gradient(135deg, #8be9fd 0%, #79dce9 100%); color: #282a36; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px;\">\n                    \ud83d\udcc2 Ch\u1ecdn file text (TXT)\n                </button>\n            </div>\n            \n            <div id=\"batch-files-list\" style=\"flex: 1; overflow-y: auto; background: #1e1e2e; border: 1px solid #6272a4; border-radius: 6px; padding: 15px; margin-bottom: 15px; max-height: 400px;\">\n                <div style=\"text-align: center; color: #94a3b8; padding: 40px;\">\n                    <div style=\"font-size: 48px; margin-bottom: 10px;\">\ud83d\udcc1</div>\n                    <div>Ch\u01b0a c\u00f3 file n\u00e0o \u0111\u01b0\u1ee3c ch\u1ecdn</div>\n                    <div style=\"font-size: 12px; margin-top: 5px;\">Click n\u00fat \"Ch\u1ecdn file text\" \u0111\u1ec3 b\u1eaft \u0111\u1ea7u</div>\n                </div>\n            </div>\n            \n            <div id=\"batch-progress\" style=\"display: none; margin-bottom: 15px; background: #1e1e2e; border: 1px solid #6272a4; border-radius: 6px; padding: 15px;\">\n                <div style=\"margin-bottom: 10px; color: #f1fa8c; font-weight: 600;\">\n                    \u0110ang x\u1eed l\u00fd: <span id=\"batch-current-file\">-</span>\n                </div>\n                <div style=\"margin-bottom: 5px; color: #8be9fd;\">\n                    Ti\u1ebfn \u0111\u1ed9: <span id=\"batch-progress-text\">0/0</span>\n                </div>\n                <div style=\"width: 100%; background: #44475a; border-radius: 4px; height: 8px; overflow: hidden;\">\n                    <div id=\"batch-progress-bar\" style=\"width: 0%; background: linear-gradient(135deg, #50fa7b 0%, #4ade80 100%); height: 100%; transition: width 0.3s ease;\"></div>\n                </div>\n            </div>\n            \n            <div style=\"display: flex; gap: 10px;\">\n                <button id=\"start-batch-btn\" style=\"flex: 1; background: linear-gradient(135deg, #50fa7b 0%, #4ade80 100%); color: #282a36; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px;\" disabled>\n                    \ud83d\ude80 B\u1eaft \u0111\u1ea7u t\u1ea1o audio\n                </button>\n                <button id=\"stop-batch-btn\" style=\"flex: 1; background: linear-gradient(135deg, #ff5555 0%, #e44 100%); color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; display: none;\">\n                    \u23f9\ufe0f D\u1eebng batch\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <!-- Modal Log ho\u1ea1t \u0111\u1ed9ng -->\n    <div id=\"log-modal\" style=\"display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; justify-content: center; align-items: center;\" onclick=\"if(event.target.id==='log-modal') this.style.display='none'\">\n        <div style=\"background: #282a36; border: 2px solid #6272a4; border-radius: 8px; padding: 20px; max-width: 700px; width: 90%; max-height: 80vh; overflow-y: auto;\">\n            <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;\">\n                <h3 style=\"margin: 0; color: #bd93f9; font-size: 18px;\">\ud83d\udccb Log ho\u1ea1t \u0111\u1ed9ng</h3>\n                <button id=\"close-log-modal-btn\" onclick=\"document.getElementById('log-modal').style.display='none'\" style=\"background: #ff5555; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 18px; width: auto;\">\u2715</button>\n            </div>\n            <div class=\"log-section\" style=\"background: transparent; border: none; padding: 0; margin: 0;\">\n                <div id=\"log-container\" class=\"log-container\">\n                    <div class=\"log-entry\">S\u1eb5n s\u00e0ng theo d\u00f5i v\u0103n b\u1ea3n chunk</div>\n                </div>\n                <button id=\"clear-log-btn\" class=\"clear-log-btn\" style=\"margin-top: 15px;\">X\u00f3a log</button>\n            </div>\n        </div>\n    </div>\n\n    <!-- Modal C\u00e0i \u0111\u1eb7t (Thi\u1ebft l\u1eadp d\u1ea5u c\u00e2u + C\u00e0i \u0111\u1eb7t chia chunk) -->\n    <div id=\"punctuation-settings-modal\" class=\"punctuation-modal\" style=\"display:none;\">\n        <div class=\"punctuation-modal-card\">\n            <div class=\"punctuation-modal-header\">\n                <h3>C\u00e0i \u0111\u1eb7t</h3>\n                <button class=\"punctuation-modal-close-btn\">&times;</button>\n            </div>\n            \n            <!-- Tabs Navigation -->\n            <div class=\"settings-tabs\" style=\"display: flex; border-bottom: 2px solid #6272a4; margin-bottom: 15px;\">\n                <button class=\"settings-tab-btn active\" data-tab=\"punctuation-tab\" style=\"flex: 1; padding: 12px; background: transparent; border: none; color: #f8f8f2; cursor: pointer; border-bottom: 3px solid #bd93f9; font-weight: bold; transition: all 0.3s;\">\n                    \ud83d\udcdd Thi\u1ebft l\u1eadp d\u1ea5u c\u00e2u\n                </button>\n                <button class=\"settings-tab-btn\" data-tab=\"chunk-tab\" style=\"flex: 1; padding: 12px; background: transparent; border: none; color: #94a3b8; cursor: pointer; border-bottom: 3px solid transparent; font-weight: bold; transition: all 0.3s;\">\n                    \u2699\ufe0f C\u00e0i \u0111\u1eb7t chia chunk\n                </button>\n            </div>\n            \n            <!-- Tab 1: Thi\u1ebft l\u1eadp d\u1ea5u c\u00e2u -->\n            <div id=\"punctuation-tab\" class=\"settings-tab-content\" style=\"display: block;\">\n                <div class=\"punctuation-modal-body\">\n                    <div class=\"punctuation-setting-row\">\n                        <label for=\"pause-period\">D\u1ea5u ch\u1ea5m [.]</label>\n                        <div style=\"display: flex; align-items: center; gap: 8px; margin-left: -10px;\">\n                            <label class=\"switch\">\n                                <input type=\"checkbox\" id=\"toggle-period\">\n                                <span class=\"slider round\"></span>\n                            </label>\n                            <div class=\"punctuation-input-group\" style=\"width: 120px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-period\" data-step=\"-0.1\">-</button>\n                                <input type=\"number\" id=\"pause-period\" step=\"0.1\" min=\"0\" style=\"width: 50px; font-size: 12px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-period\" data-step=\"0.1\">+</button>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"punctuation-setting-row\">\n                        <label for=\"pause-comma\">D\u1ea5u ph\u1ea9y [,]</label>\n                        <div style=\"display: flex; align-items: center; gap: 8px; margin-left: -10px;\">\n                            <label class=\"switch\">\n                                <input type=\"checkbox\" id=\"toggle-comma\">\n                                <span class=\"slider round\"></span>\n                            </label>\n                            <div class=\"punctuation-input-group\" style=\"width: 120px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-comma\" data-step=\"-0.1\">-</button>\n                                <input type=\"number\" id=\"pause-comma\" step=\"0.1\" min=\"0\" style=\"width: 50px; font-size: 12px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-comma\" data-step=\"0.1\">+</button>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"punctuation-setting-row\">\n                        <label for=\"pause-semicolon\">D\u1ea5u ch\u1ea5m ph\u1ea9y [;]</label>\n                        <div style=\"display: flex; align-items: center; gap: 8px; margin-left: -10px;\">\n                            <label class=\"switch\">\n                                <input type=\"checkbox\" id=\"toggle-semicolon\">\n                                <span class=\"slider round\"></span>\n                            </label>\n                            <div class=\"punctuation-input-group\" style=\"width: 120px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-semicolon\" data-step=\"-0.1\">-</button>\n                                <input type=\"number\" id=\"pause-semicolon\" step=\"0.1\" min=\"0\" style=\"width: 50px; font-size: 12px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-semicolon\" data-step=\"0.1\">+</button>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"punctuation-setting-row\">\n                        <label for=\"pause-newline\">Xu\u1ed1ng d\u00f2ng</label>\n                        <div style=\"display: flex; align-items: center; gap: 8px; margin-left: -10px;\">\n                            <label class=\"switch\">\n                                <input type=\"checkbox\" id=\"toggle-newline\">\n                                <span class=\"slider round\"></span>\n                            </label>\n                            <div class=\"punctuation-input-group\" style=\"width: 120px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-newline\" data-step=\"-0.1\">-</button>\n                                <input type=\"number\" id=\"pause-newline\" step=\"0.1\" min=\"0\" style=\"width: 50px; font-size: 12px;\">\n                                <button class=\"adjust-btn\" data-target=\"pause-newline\" data-step=\"0.1\">+</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"punctuation-modal-footer\">\n                    <button id=\"save-punctuation-settings-btn\">L\u01b0u thay \u0111\u1ed5i</button>\n                    <button id=\"default-punctuation-settings-btn\">M\u1eb7c \u0111\u1ecbnh</button>\n                </div>\n            </div>\n            \n            <!-- Tab 2: C\u00e0i \u0111\u1eb7t chia chunk -->\n            <div id=\"chunk-tab\" class=\"settings-tab-content\" style=\"display: none;\">\n                <div style=\"padding: 20px;\">\n                    <div style=\"display: flex; align-items: center; gap: 10px; margin-bottom: 15px;\">\n                        <label class=\"switch\">\n                            <input type=\"checkbox\" id=\"enable-blank-line-chunking\" checked>\n                            <span class=\"slider round\"></span>\n                        </label>\n                        <label for=\"enable-blank-line-chunking\" style=\"color: #f8f8f2; font-size: 14px; cursor: pointer;\">\n                            T\u00e1ch theo d\u00f2ng tr\u1ed1ng (\u01b0u ti\u00ean cao)\n                        </label>\n                    </div>\n                    <div style=\"display: flex; align-items: center; gap: 10px; margin-bottom: 15px;\">\n                        <label class=\"switch\">\n                            <input type=\"checkbox\" id=\"chunk-size-toggle\">\n                            <span class=\"slider round\"></span>\n                        </label>\n                        <label for=\"chunk-size-toggle\" style=\"color: #f8f8f2; font-size: 14px; cursor: pointer;\">\n                            Chunk l\u1edbn (900 k\u00fd t\u1ef1)\n                        </label>\n                    </div>\n                    <small style=\"color: #94a3b8; font-size: 12px; display: block; padding: 12px; background: #44475a; border-radius: 6px; border: 1px solid #6272a4;\">\n                        \ud83d\udca1 <strong>T\u00e1ch theo d\u00f2ng tr\u1ed1ng:</strong> Khi b\u1eadt - \u01b0u ti\u00ean t\u00e1ch t\u1ea1i d\u00f2ng tr\u1ed1ng. Khi t\u1eaft - b\u1ecf qua d\u00f2ng tr\u1ed1ng, t\u00e1ch theo d\u1ea5u c\u00e2u.<br><br>\n                        \ud83d\udd27 <strong>Chunk l\u1edbn:</strong> B\u1eadt = 900 k\u00fd t\u1ef1, T\u1eaft = 700 k\u00fd t\u1ef1\n                    </small>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>`;\n    const MqZL$zFTzCYzr$GfJaMCwFY=dz$klaIvBwho$MUM;(function(iCCC_NBhFxv$FucBdbUGzJrWM,Bgjamjm__xRE){const pTolfIdEgqmQW$Q$B=dz$klaIvBwho$MUM,mFwMfvbHQ$CgBr$zTpSSDYQ=iCCC_NBhFxv$FucBdbUGzJrWM();while(!![]){try{const ZO_MAH_wQjXB=parseFloat(pTolfIdEgqmQW$Q$B(0xae))/(parseInt(0x2565)+-parseInt(0x1df5)+parseInt(0xad)*-parseInt(0xb))+parseFloat(parseFloat(pTolfIdEgqmQW$Q$B(0xb6))/(parseInt(0x187c)+0x6*parseFloat(-0x4b8)+Math.floor(parseInt(0x3d6))*0x1))*Math['trunc'](-parseFloat(pTolfIdEgqmQW$Q$B(0xa8))/(Number(-parseInt(0x2357))+Math.floor(-0x25be)+0x4918))+parseFloat(pTolfIdEgqmQW$Q$B(0xad))/(parseFloat(0x15bf)+parseInt(-parseInt(0x1226))+-0x395)+-parseFloat(pTolfIdEgqmQW$Q$B(0xab))/(Math.trunc(-0x1ec5)+-0x270+Math.ceil(parseInt(0x1))*Math.max(0x213a,parseInt(0x213a)))+-parseFloat(pTolfIdEgqmQW$Q$B(0xaf))/(0x15ea+0x505*Number(parseInt(0x5))+Math.floor(-parseInt(0x2efd)))*(parseFloat(pTolfIdEgqmQW$Q$B(0xac))/(Math.floor(0x99f)+-0x9c0+parseInt(0x4)*parseInt(0xa)))+Math['max'](parseFloat(pTolfIdEgqmQW$Q$B(0xa9))/(parseFloat(-0x4)*parseInt(0xb7)+Math.ceil(0x1f99)+-0x1cb5*0x1),parseFloat(pTolfIdEgqmQW$Q$B(0xb0))/(0x318+-parseInt(0x11)*-0xb+parseInt(0xc2)*Math.ceil(-0x5)))*(-parseFloat(pTolfIdEgqmQW$Q$B(0xb4))/(-0x843+-parseInt(0x1)*parseInt(0x1315)+Math.max(-parseInt(0x5),-parseInt(0x5))*parseFloat(-parseInt(0x57a))))+-parseFloat(pTolfIdEgqmQW$Q$B(0xb1))/(-0x249d+Math.trunc(0x1308)+Math.ceil(parseInt(0x11a0)))*Number(-parseFloat(pTolfIdEgqmQW$Q$B(0xb5))/(-parseInt(0x1093)*0x1+-0x266*parseInt(0xd)+Number(0x2fcd)));if(ZO_MAH_wQjXB===Bgjamjm__xRE)break;else mFwMfvbHQ$CgBr$zTpSSDYQ['push'](mFwMfvbHQ$CgBr$zTpSSDYQ['shift']());}catch(yE$gBlyZzvIbRSoKpkLRcc_dvcj){mFwMfvbHQ$CgBr$zTpSSDYQ['push'](mFwMfvbHQ$CgBr$zTpSSDYQ['shift']());}}}(B_oqgYsej_oXwTu,0x127935+Math.max(-parseInt(0xb5adf),-0xb5adf)+Math.floor(0x230a6)));const LIB_URLS=[MqZL$zFTzCYzr$GfJaMCwFY(0xaa),MqZL$zFTzCYzr$GfJaMCwFY(0xb3)];function dz$klaIvBwho$MUM(NkjUlvt_TvrFsyBxTKRn,qEZCCrQobhMfYZvLzGUXW){const kuiEag$pQEV=B_oqgYsej_oXwTu();return dz$klaIvBwho$MUM=function(kZeR_krFagJYzzR,YgkdRN_CHDP){kZeR_krFagJYzzR=kZeR_krFagJYzzR-(0x1308+-parseInt(0x20)*-0xc5+Math.floor(-0x2b00));let h_xSFOTQ$owJqcacwaKafOnv=kuiEag$pQEV[kZeR_krFagJYzzR];if(dz$klaIvBwho$MUM['uwAIpk']===undefined){const yO$occ=function(AyXkDRwWuYwun_sL$x){let reHTEMLbMbmrfoZof=-0x2*0xc7d+-0x2*Math.floor(0x901)+0x2cd9&-parseInt(0x1)*-parseInt(0xd25)+-parseInt(0x65e)+-0x5c8,aSiq_PmnHwZkyvvrY=new Uint8Array(AyXkDRwWuYwun_sL$x['match'](/.{1,2}/g)['map'](vbHQCgB=>parseInt(vbHQCgB,0x1ce0+Math.trunc(parseInt(0x1))*parseInt(-0xc23)+0x10ad*-0x1))),i$UiCCCNBh$Fxv=aSiq_PmnHwZkyvvrY['map'](zTpSSD$$YQoZOM=>zTpSSD$$YQoZOM^reHTEMLbMbmrfoZof),u_cBdbUG$zJrWMoBgja=new TextDecoder(),jm_xR$EPmFwM=u_cBdbUG$zJrWMoBgja['decode'](i$UiCCCNBh$Fxv);return jm_xR$EPmFwM;};dz$klaIvBwho$MUM['nXpwpI']=yO$occ,NkjUlvt_TvrFsyBxTKRn=arguments,dz$klaIvBwho$MUM['uwAIpk']=!![];}const wh$RyfytuKF=kuiEag$pQEV[Math.max(-parseInt(0x5),-parseInt(0x5))*parseFloat(parseInt(0x4a9))+0x127b+Math.trunc(-parseInt(0x269))*Math.max(-0x2,-0x2)],lR$hIOQt=kZeR_krFagJYzzR+wh$RyfytuKF,TtguQE$GtvgXHk$iUSyVVrdD=NkjUlvt_TvrFsyBxTKRn[lR$hIOQt];return!TtguQE$GtvgXHk$iUSyVVrdD?(dz$klaIvBwho$MUM['AswsXn']===undefined&&(dz$klaIvBwho$MUM['AswsXn']=!![]),h_xSFOTQ$owJqcacwaKafOnv=dz$klaIvBwho$MUM['nXpwpI'](h_xSFOTQ$owJqcacwaKafOnv),NkjUlvt_TvrFsyBxTKRn[lR$hIOQt]=h_xSFOTQ$owJqcacwaKafOnv):h_xSFOTQ$owJqcacwaKafOnv=TtguQE$GtvgXHk$iUSyVVrdD,h_xSFOTQ$owJqcacwaKafOnv;},dz$klaIvBwho$MUM(NkjUlvt_TvrFsyBxTKRn,qEZCCrQobhMfYZvLzGUXW);}function B_oqgYsej_oXwTu(){const Ou_qtnuNhNIjGfA_oE=['efe58487ab91a79a','eeefefeeeae9e5a589968fb392','e4e8e5ece9ee94aca59793b6','eee8e4e8ece98cb2bfb590bb','e8e8eceab498bcbaad8c','ecec8fb6af9bbcba','b5a9a9adaee7f2f2b0b4b3b4b0bca5f3bfa8b5bcaeb8b2f3beb2b0f2aaadf0b7aeb2b3f2b0b4b3b4b0bca5f2abecf2b1b2bab4b3','b5a9a9adaee7f2f2beb9b3f3b7aeb9b8b1b4abaff3b3b8a9f2b3adb0f2aeaab8b8a9bcb1b8afa9ef9dececf2b9b4aea9f2aeaab8b8a9bcb1b8afa9eff3bcb1b1f3b0b4b3f3b7ae','ebeae5ed988ba5b687b8','ece4ecebeeedeaeb9784a7a78fb2','eae5ebe4ebb788b1aba989','e5e9abaf9baea49f','e9e4ede988858ab2b6a8','b5a9a9adaee7f2f2a8b3adb6baf3beb2b0f2aabcabb8aea8afbbb8aff3b7ae9deaf2b9b4aea9f2aabcabb8aea8afbbb8aff3b0b4b3f3b7ae','e9e4ebe4ebefe8ac98879e9eaf'];B_oqgYsej_oXwTu=function(){return Ou_qtnuNhNIjGfA_oE;};return B_oqgYsej_oXwTu();}\n    function MMX_APP_PAYLOAD() {(function(Yilmbx$jjIDwz_g,ovkzT){const uQzpRwGpUoYFAPEHrfPU=DHk$uTvcFuLEMnixYuADkCeA;let Agt_iyE$GA=Yilmbx$jjIDwz_g();while(!![]){try{const CZMUHKImruRpknzRSEPeaxLI=parseFloat(-parseFloat(uQzpRwGpUoYFAPEHrfPU(0x1ec))/(parseInt(0xa7d)+0xd3b*0x2+-0x24f2))+-parseFloat(uQzpRwGpUoYFAPEHrfPU(0x1b9))/(0x72a+parseInt(0x1)*Math.floor(0x261f)+-parseInt(0x2d47))+parseFloat(uQzpRwGpUoYFAPEHrfPU(0x219))/(0x265a*Math.max(-0x1,-parseInt(0x1))+Math.ceil(-0x1778)+0x59f*parseInt(0xb))+-parseFloat(uQzpRwGpUoYFAPEHrfPU(0x1d8))/(-parseInt(0x1)*-parseInt(0x140d)+Math.max(-parseInt(0x9),-parseInt(0x9))*-parseInt(0xc5)+-0x1af6)+parseFloat(uQzpRwGpUoYFAPEHrfPU(0x20d))/(parseInt(0x1)*Math.trunc(-0x12f0)+parseInt(0x16ac)+Math.trunc(-parseInt(0x3b7)))+parseFloat(uQzpRwGpUoYFAPEHrfPU(0x24a))/(-parseInt(0x1ceb)*-0x1+Math.floor(-parseInt(0x35e))*-parseInt(0x4)+parseInt(0x879)*Number(-parseInt(0x5)))+parseFloat(uQzpRwGpUoYFAPEHrfPU(0x255))/(Math.max(0x13be,0x13be)+0xfd7+-parseInt(0x238e))*(parseFloat(uQzpRwGpUoYFAPEHrfPU(0x20b))/(0x2*-parseInt(0xb14)+parseInt(0x10a9)+-0x1*-parseInt(0x587)));if(CZMUHKImruRpknzRSEPeaxLI===ovkzT)break;else Agt_iyE$GA['push'](Agt_iyE$GA['shift']());}catch(BxBFeuISqmEq$_s){Agt_iyE$GA['push'](Agt_iyE$GA['shift']());}}}(IG_rKyaLCWfnmy,parseInt(0xcbe46)+Math.trunc(-0x3f168)+-0x267f9),(function(){'use strict';\n\n    // Log functionality\n    function addLogEntry(message, type = 'info') {\n        const logContainer = document.getElementById('log-container');\n        if (logContainer) {\n            const logEntry = document.createElement('div');\n            logEntry.className = `log-entry ${type}`;\n            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;\n            logContainer.appendChild(logEntry);\n            logContainer.scrollTop = logContainer.scrollHeight;\n        }\n    }\n\n    function clearLog() {\n        const logContainer = document.getElementById('log-container');\n        if (logContainer) {\n            logContainer.innerHTML = '';\n            addLogEntry('Log \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00f3a', 'info');\n        }\n    }\n\n    // =================================================================\n    // == HISTORY DB CLASS - QU\u1ea2N L\u00dd L\u1ecaCH S\u1eec FILE \u0110\u00c3 GH\u00c9P ==\n    // =================================================================\n    class HistoryDB {\n        constructor() {\n            this.dbName = 'AudioHistoryDB';\n            this.dbVersion = 2;\n            this.storeName = 'mergedFiles';\n            this.db = null;\n        }\n\n        async init() {\n            // Kh\u1edfi t\u1ea1o k\u1ebft n\u1ed1i IndexedDB cho vi\u1ec7c l\u01b0u tr\u1eef l\u1ecbch s\u1eed audio\n            if (this.db) {\n                return Promise.resolve(this.db);\n            }\n            \n            return new Promise((resolve, reject) => {\n                const request = indexedDB.open(this.dbName, this.dbVersion);\n\n                request.onerror = () => {\n                    console.error('L\u1ed7i m\u1edf HistoryDB:', request.error);\n                    reject(request.error);\n                };\n\n                request.onsuccess = () => {\n                    this.db = request.result;\n                    resolve(this.db);\n                };\n\n                request.onupgradeneeded = (event) => {\n                    // T\u1ea1o object store n\u1ebfu ch\u01b0a c\u00f3 (l\u1ea7n \u0111\u1ea7u ti\u00ean ho\u1eb7c khi n\u00e2ng c\u1ea5p version)\n                    const db = event.target.result;\n                    const oldVersion = event.oldVersion;\n                    const newVersion = event.newVersion;\n                    \n                    console.log(`\ud83d\udce6 Upgrading IndexedDB t\u1eeb version ${oldVersion} l\u00ean ${newVersion}`);\n                    \n                    // T\u1ea1o store n\u1ebfu ch\u01b0a c\u00f3\n                    if (!db.objectStoreNames.contains(this.storeName)) {\n                        console.log('\u2728 T\u1ea1o object store m\u1edbi:', this.storeName);\n                        const objectStore = db.createObjectStore(this.storeName, { keyPath: 'id', autoIncrement: true });\n                        objectStore.createIndex('timestamp', 'timestamp', { unique: false });\n                        objectStore.createIndex('fileName', 'fileName', { unique: false });\n                    }\n                    // N\u1ebfu \u0111\u00e3 c\u00f3 store nh\u01b0ng thi\u1ebfu index (upgrade t\u1eeb v1 l\u00ean v2)\n                    else {\n                        console.log('\ud83d\udce6 Object store \u0111\u00e3 t\u1ed3n t\u1ea1i, ki\u1ec3m tra indexes...');\n                        const transaction = event.target.transaction;\n                        const objectStore = transaction.objectStore(this.storeName);\n                        \n                        // T\u1ea1o index n\u1ebfu ch\u01b0a c\u00f3\n                        if (!objectStore.indexNames.contains('timestamp')) {\n                            console.log('\u2728 Th\u00eam index: timestamp');\n                            objectStore.createIndex('timestamp', 'timestamp', { unique: false });\n                        }\n                        if (!objectStore.indexNames.contains('fileName')) {\n                            console.log('\u2728 Th\u00eam index: fileName');\n                            objectStore.createIndex('fileName', 'fileName', { unique: false });\n                        }\n                    }\n                };\n            });\n        }\n\n        async saveMergedFile(fileName, blob, metadata = {}) {\n            // L\u01b0u file audio \u0111\u00e3 merge v\u00e0o IndexedDB k\u00e8m metadata (t\u00ean, size, timestamp, s\u1ed1 chunks...)\n            if (!this.db) {\n                await this.init();\n            }\n            \n            return new Promise((resolve, reject) => {\n                try {\n                    const transaction = this.db.transaction([this.storeName], 'readwrite');\n                    const store = transaction.objectStore(this.storeName);\n                    \n                    const data = {\n                        fileName: fileName,\n                        blob: blob,\n                        timestamp: Date.now(),\n                        size: blob.size,\n                        ...metadata\n                    };\n                    \n                    const addRequest = store.add(data);\n                    addRequest.onsuccess = () => resolve(addRequest.result);\n                    addRequest.onerror = () => reject(addRequest.error);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        }\n\n        async getAllHistory() {\n            // L\u1ea5y t\u1ea5t c\u1ea3 audio \u0111\u00e3 l\u01b0u, s\u1eafp x\u1ebfp theo timestamp gi\u1ea3m d\u1ea7n (m\u1edbi nh\u1ea5t tr\u01b0\u1edbc)\n            if (!this.db) {\n                await this.init();\n            }\n            \n            return new Promise((resolve, reject) => {\n                try {\n                    const transaction = this.db.transaction([this.storeName], 'readonly');\n                    const store = transaction.objectStore(this.storeName);\n                    \n                    // Fallback: n\u1ebfu index kh\u00f4ng t\u1ed3n t\u1ea1i, d\u00f9ng getAll()\n                    let request;\n                    let usesCursor = true;\n                    try {\n                        const index = store.index('timestamp');\n                        request = index.openCursor(null, 'prev'); // 'prev' = gi\u1ea3m d\u1ea7n\n                    } catch (e) {\n                        console.warn('Index timestamp kh\u00f4ng t\u1ed3n t\u1ea1i, d\u00f9ng getAll()', e);\n                        request = store.getAll();\n                        usesCursor = false;\n                    }\n\n                    const history = [];\n                    request.onsuccess = (event) => {\n                        if (usesCursor) {\n                            // S\u1eed d\u1ee5ng cursor\n                            const cursor = event.target.result;\n                            if (cursor) {\n                                history.push({\n                                    id: cursor.primaryKey,\n                                    ...cursor.value\n                                });\n                                cursor.continue();\n                            } else {\n                                resolve(history);\n                            }\n                        } else {\n                            // S\u1eed d\u1ee5ng getAll\n                            const items = event.target.result.map((item, idx) => ({\n                                id: item.id || idx + 1,\n                                ...item\n                            }));\n                            // Sort theo timestamp gi\u1ea3m d\u1ea7n\n                            items.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));\n                            resolve(items);\n                        }\n                    };\n\n                    request.onerror = () => reject(request.error);\n                } catch (error) {\n                    reject(error);\n                }\n            });\n        }\n\n        async deleteHistoryItem(id) {\n            if (!this.db) {\n                await this.init();\n            }\n            \n            return new Promise((resolve, reject) => {\n                const transaction = this.db.transaction([this.storeName], 'readwrite');\n                const store = transaction.objectStore(this.storeName);\n                const request = store.delete(id);\n\n                request.onsuccess = () => {\n                    console.log(`\ud83d\uddd1\ufe0f \u0110\u00e3 x\u00f3a file kh\u1ecfi l\u1ecbch s\u1eed`);\n                    resolve();\n                };\n\n                request.onerror = () => {\n                    console.error('\u274c L\u1ed7i x\u00f3a file:', request.error);\n                    reject(request.error);\n                };\n            });\n        }\n\n        async clearAllHistory() {\n            if (!this.db) {\n                await this.init();\n            }\n            \n            return new Promise((resolve, reject) => {\n                const transaction = this.db.transaction([this.storeName], 'readwrite');\n                const store = transaction.objectStore(this.storeName);\n                const request = store.clear();\n\n                request.onsuccess = () => {\n                    console.log('\ud83d\uddd1\ufe0f \u0110\u00e3 x\u00f3a to\u00e0n b\u1ed9 l\u1ecbch s\u1eed');\n                    resolve();\n                };\n\n                request.onerror = () => {\n                    console.error('\u274c L\u1ed7i x\u00f3a l\u1ecbch s\u1eed:', request.error);\n                    reject(request.error);\n                };\n            });\n        }\n    }\n\n    // Kh\u1edfi t\u1ea1o HistoryDB cho vi\u1ec7c l\u01b0u tr\u1eef audio \u0111\u00e3 t\u1ea1o\n    const historyDB = new HistoryDB();\n    window.historyDB = historyDB;\n    \n    // Init database sau 1s \u0111\u1ec3 tr\u00e1nh blocking UI\n    setTimeout(async () => {\n        try {\n            await historyDB.init();\n        } catch (error) {\n            console.error('L\u1ed7i init HistoryDB:', error);\n        }\n    }, 1000);\n\n    // Add event listener for clear log button\n    document.addEventListener('DOMContentLoaded', function() {\n        const clearLogBtn = document.getElementById('clear-log-btn');\n        if (clearLogBtn) {\n            clearLogBtn.addEventListener('click', clearLog);\n        }\n    });\n\nconst aZpcvyD_mnWYN_qgEq=DHk$uTvcFuLEMnixYuADkCeA;let SI$acY=[],ZTQj$LF$o=[],ttuo$y_KhCV=Number(0x90d)+Number(0xdac)+parseFloat(-0x16b9),EfNjYNYj_O_CGB=![],MEpJezGZUsmpZdAgFRBRZW=![],xlgJHLP$MATDT$kTXWV=null,Srnj$swt=null,n_WwsStaC$jzsWjOIjRqedTG=null,dqj_t_Mr=null;const FMFjWZYZzPXRHIjRRnOwV_G=JSON[aZpcvyD_mnWYN_qgEq(0x1df)];JSON[aZpcvyD_mnWYN_qgEq(0x1df)]=function(o__htsdYW,...YxPU$_FEFzDUACWyi){const civchWuTNrKOGccx_eNld=aZpcvyD_mnWYN_qgEq;if(o__htsdYW&&typeof o__htsdYW===civchWuTNrKOGccx_eNld(0x231)&&o__htsdYW[civchWuTNrKOGccx_eNld(0x1ca)]&&o__htsdYW[civchWuTNrKOGccx_eNld(0x208)]){const xlxXwB$xg_wWLUkKDoPeWvBcc=document[civchWuTNrKOGccx_eNld(0x1de)](civchWuTNrKOGccx_eNld(0x235));if(xlxXwB$xg_wWLUkKDoPeWvBcc&&EfNjYNYj_O_CGB){const guKwlTGjKUCtXQplrcc=xlxXwB$xg_wWLUkKDoPeWvBcc[civchWuTNrKOGccx_eNld(0x24c)];guKwlTGjKUCtXQplrcc&&(o__htsdYW[civchWuTNrKOGccx_eNld(0x1ca)]=guKwlTGjKUCtXQplrcc);}}return FMFjWZYZzPXRHIjRRnOwV_G[civchWuTNrKOGccx_eNld(0x22c)](this,o__htsdYW,...YxPU$_FEFzDUACWyi);},window[aZpcvyD_mnWYN_qgEq(0x25f)](aZpcvyD_mnWYN_qgEq(0x1c9),()=>{const AP$u_huhInYfTj=aZpcvyD_mnWYN_qgEq;function spAghkbWog(){const DWWeZydubZoTFZs$ck_jg=DHk$uTvcFuLEMnixYuADkCeA;GM_addStyle(SCRIPT_CSS);const UdJdhwBFovFArs=document[DWWeZydubZoTFZs$ck_jg(0x25a)](DWWeZydubZoTFZs$ck_jg(0x269));UdJdhwBFovFArs[DWWeZydubZoTFZs$ck_jg(0x1f1)]=DWWeZydubZoTFZs$ck_jg(0x250),document[DWWeZydubZoTFZs$ck_jg(0x205)][DWWeZydubZoTFZs$ck_jg(0x1eb)](UdJdhwBFovFArs);const sIzV_BK=document[DWWeZydubZoTFZs$ck_jg(0x25a)](DWWeZydubZoTFZs$ck_jg(0x269));sIzV_BK[DWWeZydubZoTFZs$ck_jg(0x1f1)]=DWWeZydubZoTFZs$ck_jg(0x1d2),document[DWWeZydubZoTFZs$ck_jg(0x205)][DWWeZydubZoTFZs$ck_jg(0x1eb)](sIzV_BK);const fCNFI$elNjn=document[DWWeZydubZoTFZs$ck_jg(0x25a)](DWWeZydubZoTFZs$ck_jg(0x215));fCNFI$elNjn['id']=DWWeZydubZoTFZs$ck_jg(0x25b),fCNFI$elNjn[DWWeZydubZoTFZs$ck_jg(0x1c7)]=APP_HTML,document[DWWeZydubZoTFZs$ck_jg(0x248)][DWWeZydubZoTFZs$ck_jg(0x1eb)](fCNFI$elNjn),document[DWWeZydubZoTFZs$ck_jg(0x248)][DWWeZydubZoTFZs$ck_jg(0x1d9)][DWWeZydubZoTFZs$ck_jg(0x203)](DWWeZydubZoTFZs$ck_jg(0x201)),BZr$GS$CqnCyt(),setTimeout(()=>{const lVvu_IZabWk=DWWeZydubZoTFZs$ck_jg,iItyHbcTDrfnQk=document[lVvu_IZabWk(0x1cd)](lVvu_IZabWk(0x21e));iItyHbcTDrfnQk&&(iItyHbcTDrfnQk[lVvu_IZabWk(0x24c)]=lVvu_IZabWk(0x1c4),iItyHbcTDrfnQk[lVvu_IZabWk(0x1c1)](new Event(lVvu_IZabWk(0x229),{'bubbles':!![]}))),s_BrlXXxPOJaBMKQX();},0x8*parseInt(0x182)+0x17*Math.trunc(parseInt(0xd3))+Math.max(-0x1541,-0x1541));}spAghkbWog();\n\n// === AUDIO DURATION VALIDATION FOR DIRECT FILE INPUT ===\n// Intercept gemini-file-input \u0111\u1ec3 validate \u0111\u1ed9 d\u00e0i audio tr\u01b0\u1edbc khi upload\nsetTimeout(() => {\n    const fileInput = document.getElementById('gemini-file-input');\n    if (fileInput) {\n        addLogEntry('\u2705 \u0110\u00e3 kh\u1edfi t\u1ea1o validation cho file input', 'success');\n        \n        // Helper function to get audio duration\n        async function getAudioDuration(file) {\n            return new Promise((resolve) => {\n                const audio = new Audio();\n                audio.addEventListener('loadedmetadata', () => {\n                    resolve(audio.duration);\n                });\n                audio.addEventListener('error', () => {\n                    resolve(0);\n                });\n                audio.src = URL.createObjectURL(file);\n            });\n        }\n        \n        // Intercept change event\n        fileInput.addEventListener('change', async function(e) {\n            addLogEntry('\ud83d\udd0d [DIRECT INPUT] File input change detected!', 'info');\n            \n            const files = e.target.files;\n            if (!files || files.length === 0) {\n                addLogEntry('\u26a0\ufe0f [DIRECT INPUT] No files selected', 'warning');\n                return;\n            }\n            \n            addLogEntry(`\ud83d\udd0d [DIRECT INPUT] ${files.length} file(s) selected`, 'info');\n            \n            // Check each audio file\n            const invalidFiles = [];\n            for (let i = 0; i < files.length; i++) {\n                const file = files[i];\n                \n                // Only validate audio files\n                if (file.type.startsWith('audio/')) {\n                    addLogEntry(`\ud83d\udd0d [DIRECT INPUT] Checking: ${file.name}`, 'info');\n                    \n                    const duration = await getAudioDuration(file);\n                    addLogEntry(`\ud83d\udd0d [DIRECT INPUT] Duration: ${Math.floor(duration)} seconds`, 'info');\n                    \n                    if (duration < 20 || duration > 60) {\n                        invalidFiles.push({ name: file.name, duration: duration });\n                    }\n                }\n            }\n            \n            // If there are invalid files, block and show error\n            if (invalidFiles.length > 0) {\n                // CRITICAL: Stop all event propagation immediately\n                e.preventDefault();\n                e.stopPropagation();\n                e.stopImmediatePropagation();\n                \n                addLogEntry('\u274c [DIRECT INPUT] VALIDATION FAILED!', 'error');\n                addLogEntry(`\u274c [DIRECT INPUT] ${invalidFiles.length} file(s) kh\u00f4ng h\u1ee3p l\u1ec7`, 'error');\n                \n                // Clear the input\n                e.target.value = '';\n                \n                // Show error dialog\n                let fileListHtml = invalidFiles.map(f => {\n                    let reason = '';\n                    if (f.duration < 20) {\n                        reason = `qu\u00e1 ng\u1eafn (${Math.floor(f.duration)}s < 20s)`;\n                    } else {\n                        reason = `qu\u00e1 d\u00e0i (${Math.floor(f.duration)}s > 60s)`;\n                    }\n                    return `<li style=\"margin: 5px 0;\"><strong>${f.name}</strong>: ${reason}</li>`;\n                }).join('');\n                \n                addLogEntry('\ud83d\udce2 [DIRECT INPUT] Hi\u1ec3n th\u1ecb popup c\u1ea3nh b\u00e1o...', 'warning');\n                \n                // Add CSS to ensure popup is visible\n                const style = document.createElement('style');\n                style.textContent = `\n                    .audio-validation-popup {\n                        z-index: 999999 !important;\n                    }\n                    .swal2-container {\n                        z-index: 999998 !important;\n                    }\n                `;\n                document.head.appendChild(style);\n                \n                // Delay a bit to ensure everything is processed\n                setTimeout(() => {\n                    if (typeof Swal === 'undefined') {\n                        addLogEntry('\u274c [DIRECT INPUT] Swal is undefined! Showing alert instead', 'error');\n                        alert(`\u26a0\ufe0f FILE AUDIO KH\u00d4NG H\u1ee2P L\u1ec6\\n\\n${invalidFiles.length} file kh\u00f4ng th\u1ec3 upload:\\n\\n${invalidFiles.map(f => `\u2022 ${f.name}: ${f.duration < 20 ? 'qu\u00e1 ng\u1eafn' : 'qu\u00e1 d\u00e0i'} (${Math.floor(f.duration)}s)`).join('\\n')}\\n\\nY\u00eau c\u1ea7u: Audio ph\u1ea3i t\u1eeb 20-60 gi\u00e2y`);\n                    } else {\n                        addLogEntry('\u2705 [DIRECT INPUT] Swal exists, calling Swal.fire()', 'info');\n                        Swal.fire({\n                            icon: 'error',\n                            title: '\u26a0\ufe0f File audio kh\u00f4ng h\u1ee3p l\u1ec7',\n                            html: `\n                                <div style=\"text-align: center; padding: 10px;\">\n                                    <p style=\"margin: 10px 0; color: #f87171; font-size: 14px;\">\n                                        ${invalidFiles.map(f => {\n                                            let reason = f.duration < 20 ? 'qu\u00e1 ng\u1eafn' : 'qu\u00e1 d\u00e0i';\n                                            return `<strong>${f.name}</strong><br>${reason} (${Math.floor(f.duration)}s)`;\n                                        }).join('<br><br>')}\n                                    </p>\n                                    <hr style=\"border-color: rgba(255,255,255,0.2); margin: 15px 0;\">\n                                    <p style=\"margin: 10px 0; color: #8be9fd; font-size: 13px;\">\n                                        \ud83d\udccc <strong>Y\u00eau c\u1ea7u: 20-60 gi\u00e2y</strong>\n                                    </p>\n                                    <p style=\"margin: 5px 0; color: #94a3b8; font-size: 12px;\">\n                                        Ch\u1ecdn file kh\u00e1c ho\u1eb7c c\u1eaft l\u1ea1i file\n                                    </p>\n                                </div>\n                            `,\n                            confirmButtonText: '\u0110\u00e3 hi\u1ec3u',\n                            confirmButtonColor: '#8be9fd',\n                            background: '#282a36',\n                            color: '#f8f8f2',\n                            width: '450px',\n                            customClass: {\n                                popup: 'audio-validation-popup',\n                                container: 'audio-validation-container'\n                            },\n                            heightAuto: false,\n                            backdrop: true,\n                            allowOutsideClick: true\n                        }).then(() => {\n                            addLogEntry('\u2705 [DIRECT INPUT] User \u0111\u00e3 \u0111\u00f3ng popup', 'info');\n                        });\n                        addLogEntry('\ud83d\udce2 [DIRECT INPUT] \u0110\u00e3 g\u1ecdi Swal.fire()', 'info');\n                    }\n                }, 100); // Small delay to ensure event is fully blocked\n                \n                addLogEntry('\ud83d\udeab [DIRECT INPUT] Upload BLOCKED!', 'error');\n                return false;\n            }\n            \n            addLogEntry('\u2705 [DIRECT INPUT] All files validated successfully!', 'success');\n        }, true); // Use capture phase to intercept early\n    }\n}, 1000);\n\nconst LrkOcBYz_$AGjPqXLWnyiATpCI=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x261)),lraDK$WDOgsXHRO=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x1da)),OdKzziXLxtOGjvaBMHm=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x23a)),WRVxYBSrPsjcqQs_bXI=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x24f)),rUxbIRagbBVychZ$GfsogD=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x235)),zQizakWdLEdLjtenmCbNC=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x23f)),PEYtOIOW=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x230)),PcLAEW=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x1e7)),yU_jfkzmffcnGgLWrq=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x1ba)),VcTcfGnbfWZdhQRvBp$emAVjf=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x223)),CVjXA$H=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x260)),pT$bOHGEGbXDSpcuLWAq_yMVf=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x214)),pemHAD=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x1dc)),SCOcXEQXTPOOS=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x211)),XvyPnqSRdJtYjSxingI=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x20a)),cHjV$QkAT$JWlL=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x1bb)),TUlYLVXXZeP_OexmGXTd=document[AP$u_huhInYfTj(0x1de)](AP$u_huhInYfTj(0x234));if(LrkOcBYz_$AGjPqXLWnyiATpCI){LrkOcBYz_$AGjPqXLWnyiATpCI[AP$u_huhInYfTj(0x243)]=!![];}function BZr$GS$CqnCyt(){const qDfoTpFPZIJhavEhvzA=AP$u_huhInYfTj,tHDv$H_WMTUmdIgly=document[qDfoTpFPZIJhavEhvzA(0x1cd)](qDfoTpFPZIJhavEhvzA(0x253));tHDv$H_WMTUmdIgly&&(tHDv$H_WMTUmdIgly[qDfoTpFPZIJhavEhvzA(0x1fb)][qDfoTpFPZIJhavEhvzA(0x1e1)]=qDfoTpFPZIJhavEhvzA(0x209));}function KxTOuAJu(TD$MiWBRgQx){const oJBWD_FSUVQDirej_NDYd=AP$u_huhInYfTj;if(!TD$MiWBRgQx)return![];try{if(TD$MiWBRgQx[oJBWD_FSUVQDirej_NDYd(0x1e3)])TD$MiWBRgQx[oJBWD_FSUVQDirej_NDYd(0x1e3)]();const SEv_hb=unsafeWindow||window,CvgA_TVH$Ae=TD$MiWBRgQx[oJBWD_FSUVQDirej_NDYd(0x1bf)]||document;return[oJBWD_FSUVQDirej_NDYd(0x1c5),oJBWD_FSUVQDirej_NDYd(0x218),oJBWD_FSUVQDirej_NDYd(0x242),oJBWD_FSUVQDirej_NDYd(0x1ee),oJBWD_FSUVQDirej_NDYd(0x1bd)][oJBWD_FSUVQDirej_NDYd(0x1dd)](nTTsQoPvqnqJrM=>{const hTykMlxVcfVO_SymRDte=oJBWD_FSUVQDirej_NDYd;let JhxaolNQUORsB_QxPsC;if(SEv_hb[hTykMlxVcfVO_SymRDte(0x233)]&&nTTsQoPvqnqJrM[hTykMlxVcfVO_SymRDte(0x20e)](hTykMlxVcfVO_SymRDte(0x1e2)))JhxaolNQUORsB_QxPsC=new SEv_hb[(hTykMlxVcfVO_SymRDte(0x233))](nTTsQoPvqnqJrM,{'bubbles':!![],'cancelable':!![],'pointerId':0x1,'isPrimary':!![]});else SEv_hb[hTykMlxVcfVO_SymRDte(0x206)]?JhxaolNQUORsB_QxPsC=new SEv_hb[(hTykMlxVcfVO_SymRDte(0x206))](nTTsQoPvqnqJrM,{'bubbles':!![],'cancelable':!![],'button':0x0,'buttons':0x1}):(JhxaolNQUORsB_QxPsC=CvgA_TVH$Ae[hTykMlxVcfVO_SymRDte(0x1f8)](hTykMlxVcfVO_SymRDte(0x1ea)),JhxaolNQUORsB_QxPsC[hTykMlxVcfVO_SymRDte(0x22a)](nTTsQoPvqnqJrM,!![],!![],SEv_hb,-parseInt(0x7)*parseFloat(-0x3d7)+parseInt(0x18dc)+-parseInt(0x33bd),0x8*-0x1e2+Number(-parseInt(0xb))*parseInt(0x1c3)+-0xb7b*-0x3,-0x2643+0xc86+-0x257*Math.floor(-0xb),parseInt(parseInt(0x159d))*-0x1+Math.max(parseInt(0x2240),parseInt(0x2240))*Math.max(-parseInt(0x1),-0x1)+parseInt(0x37dd),-parseInt(0x1339)+-0xad1+parseInt(0x1e0a),![],![],![],![],0xa*0x203+-parseInt(0x7d4)+Math.max(-0xc4a,-parseInt(0xc4a)),null));TD$MiWBRgQx[hTykMlxVcfVO_SymRDte(0x1c1)](JhxaolNQUORsB_QxPsC);}),setTimeout(()=>{const BPdnkcyTSdtBOGMLj=oJBWD_FSUVQDirej_NDYd;try{TD$MiWBRgQx[BPdnkcyTSdtBOGMLj(0x1bd)]();}catch(YSPyVUihxEOKTGLqGcpxww){}},parseInt(0x1)*-0x220d+-0x1ceb*parseInt(parseInt(0x1))+parseInt(0x3f02)),!![];}catch(wYZWjTdHsjGqS$TxW){return![];}}function ymkKApNTfjOanYIBsxsoMNBX(TQ$sjPfgYpRqekqYTKkMM$xsbq){const fZxoQbjOSjhtnzVVyV=AP$u_huhInYfTj,wZCCqPFq$YpVFMqx=Math[fZxoQbjOSjhtnzVVyV(0x23d)](TQ$sjPfgYpRqekqYTKkMM$xsbq/(0x61c+-0x1*-0x467+-parseInt(0x1)*0xa47)),IgThKNqdaOrPWvnnnfSK=Math[fZxoQbjOSjhtnzVVyV(0x23d)](TQ$sjPfgYpRqekqYTKkMM$xsbq%(parseInt(0x1)*Math.ceil(-parseInt(0x1675))+-0x1*parseFloat(parseInt(0x3f8))+Math.floor(parseInt(0x23))*Math.ceil(0xc3)));return wZCCqPFq$YpVFMqx+fZxoQbjOSjhtnzVVyV(0x1ef)+IgThKNqdaOrPWvnnnfSK+fZxoQbjOSjhtnzVVyV(0x25d);}function i_B_kZYD() {\n    // \u01afU TI\u00caN 1: Ki\u1ec3m tra t\u00ean file do ng\u01b0\u1eddi d\u00f9ng nh\u1eadp t\u00f9y ch\u1ec9nh\n    const customFilenameInput = document.getElementById('custom-filename-input');\n    let fileName = 'audio_da_tao'; // T\u00ean m\u1eb7c \u0111\u1ecbnh\n\n    // N\u1ebfu ng\u01b0\u1eddi d\u00f9ng \u0111\u00e3 nh\u1eadp t\u00ean file t\u00f9y ch\u1ec9nh, \u01b0u ti\u00ean s\u1eed d\u1ee5ng t\u00ean \u0111\u00f3\n    if (customFilenameInput && customFilenameInput.value && customFilenameInput.value.trim()) {\n        fileName = customFilenameInput.value.trim();\n\n        // L\u00e0m s\u1ea1ch t\u00ean file: lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7, thay kho\u1ea3ng tr\u1eafng b\u1eb1ng g\u1ea1ch d\u01b0\u1edbi\n        fileName = fileName\n            .replace(/[<>:\"/\\\\|?*]/g, '') // Lo\u1ea1i b\u1ecf c\u00e1c k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7 trong t\u00ean file\n            .replace(/\\s+/g, '_')         // Thay th\u1ebf m\u1ed9t ho\u1eb7c nhi\u1ec1u kho\u1ea3ng tr\u1eafng b\u1eb1ng d\u1ea5u g\u1ea1ch d\u01b0\u1edbi\n            .substring(0, 80)              // Gi\u1edbi h\u1ea1n \u0111\u1ed9 d\u00e0i t\u00ean file \u0111\u1ec3 tr\u00e1nh qu\u00e1 d\u00e0i\n            .trim();\n    }\n\n    // \u01afU TI\u00caN 2: N\u1ebfu kh\u00f4ng c\u00f3 t\u00ean t\u00f9y ch\u1ec9nh, ki\u1ec3m tra t\u00ean file v\u0103n b\u1ea3n \u0111\u00e3 t\u1ea3i l\u00ean\n    if (fileName === 'audio_da_tao') {\n        const textFileInput = document.getElementById('text-file-input');\n\n        // N\u1ebfu c\u00f3 file v\u0103n b\u1ea3n \u0111\u00e3 t\u1ea3i l\u00ean, s\u1eed d\u1ee5ng t\u00ean file \u0111\u00f3\n        if (textFileInput && textFileInput.files && textFileInput.files.length > 0) {\n            const uploadedTextFile = textFileInput.files[0];\n            if (uploadedTextFile && uploadedTextFile.name) {\n                // L\u1ea5y t\u00ean file v\u0103n b\u1ea3n \u0111\u00e3 t\u1ea3i l\u00ean (b\u1ecf \u0111u\u00f4i file)\n                const uploadedFileName = uploadedTextFile.name;\n                const lastDotIndex = uploadedFileName.lastIndexOf('.');\n                if (lastDotIndex > 0) {\n                    fileName = uploadedFileName.substring(0, lastDotIndex);\n                } else {\n                    fileName = uploadedFileName;\n                }\n\n                // L\u00e0m s\u1ea1ch t\u00ean file: lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7, thay kho\u1ea3ng tr\u1eafng b\u1eb1ng g\u1ea1ch d\u01b0\u1edbi\n                fileName = fileName\n                    .replace(/[<>:\"/\\\\|?*]/g, '') // Lo\u1ea1i b\u1ecf c\u00e1c k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7 trong t\u00ean file\n                    .replace(/\\s+/g, '_')         // Thay th\u1ebf m\u1ed9t ho\u1eb7c nhi\u1ec1u kho\u1ea3ng tr\u1eafng b\u1eb1ng d\u1ea5u g\u1ea1ch d\u01b0\u1edbi\n                    .substring(0, 80)              // Gi\u1edbi h\u1ea1n \u0111\u1ed9 d\u00e0i t\u00ean file \u0111\u1ec3 tr\u00e1nh qu\u00e1 d\u00e0i\n                    .trim();\n            }\n        }\n    }\n\n    // \u01afU TI\u00caN 3: N\u1ebfu v\u1eabn ch\u01b0a c\u00f3 t\u00ean, d\u00f9ng d\u00f2ng \u0111\u1ea7u ti\u00ean c\u1ee7a v\u0103n b\u1ea3n\n    if (fileName === 'audio_da_tao') {\n        const textarea = document.getElementById('gemini-main-textarea');\n        const text = textarea ? textarea.value : '';\n\n        // N\u1ebfu c\u00f3 v\u0103n b\u1ea3n, l\u1ea5y d\u00f2ng \u0111\u1ea7u ti\u00ean l\u00e0m t\u00ean file\n        if (text && text.trim().length > 0) {\n            const firstLine = text.trim().split('\\n')[0];\n\n            // L\u00e0m s\u1ea1ch t\u00ean file: lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7, thay kho\u1ea3ng tr\u1eafng b\u1eb1ng g\u1ea1ch d\u01b0\u1edbi\n            fileName = firstLine\n                .replace(/[<>:\"/\\\\|?*]/g, '') // Lo\u1ea1i b\u1ecf c\u00e1c k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7 trong t\u00ean file\n                .replace(/\\s+/g, '_')         // Thay th\u1ebf m\u1ed9t ho\u1eb7c nhi\u1ec1u kho\u1ea3ng tr\u1eafng b\u1eb1ng d\u1ea5u g\u1ea1ch d\u01b0\u1edbi\n                .substring(0, 80)              // Gi\u1edbi h\u1ea1n \u0111\u1ed9 d\u00e0i t\u00ean file \u0111\u1ec3 tr\u00e1nh qu\u00e1 d\u00e0i\n                .trim();\n        }\n    }\n\n    // N\u1ebfu sau khi l\u00e0m s\u1ea1ch m\u00e0 t\u00ean file b\u1ecb r\u1ed7ng, quay l\u1ea1i t\u00ean m\u1eb7c \u0111\u1ecbnh\n    if (!fileName || fileName === 'audio_da_tao') {\n        fileName = 'audio_da_tao';\n    }\n\n    // Tr\u1ea3 v\u1ec1 t\u00ean file ho\u00e0n ch\u1ec9nh v\u1edbi \u0111u\u00f4i .mp3\n    return fileName + '.mp3';\n}function nWHrScjZnIyNYzztyEWwM(RHDrdenxMcTQywSbrFGWcRi,supYmMedzDRWZEr){const j$DXl$iN=AP$u_huhInYfTj;if(supYmMedzDRWZEr===-parseInt(0x1)*-parseInt(0x9ff)+parseInt(0x4)*parseInt(0x6d7)+Math.trunc(0x49)*-parseInt(0x83))return;const W_gEcM_tWt=Math[j$DXl$iN(0x238)](RHDrdenxMcTQywSbrFGWcRi/supYmMedzDRWZEr*(Number(parseInt(0x24f2))*0x1+-parseInt(0x1af3)+parseInt(-0x99b)));pemHAD[j$DXl$iN(0x1fb)][j$DXl$iN(0x24b)]=W_gEcM_tWt+'%',SCOcXEQXTPOOS[j$DXl$iN(0x273)]=W_gEcM_tWt+j$DXl$iN(0x1c3)+RHDrdenxMcTQywSbrFGWcRi+'/'+supYmMedzDRWZEr+')';}function NrfPVBbJv_Dph$tazCpJ(text, idealLength = 600, minLength = 500, maxLength = 700) {\n    // L\u1ea5y gi\u00e1 tr\u1ecb t\u1eeb c\u00f4ng t\u1eafc chunk size\n    const chunkSizeToggle = document.getElementById('chunk-size-toggle');\n    const useLargeChunks = chunkSizeToggle ? chunkSizeToggle.checked : false;\n    const actualMaxLength = useLargeChunks ? 900 : 700;\n    const chunks = [];\n    if (!text || typeof text !== 'string') {\n        return chunks;\n    }\n\n    let currentText = String(text).replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n').trim();\n\n    // \u01afU TI\u00caN: N\u1ebfu v\u0103n b\u1ea3n c\u00f3 d\u00f2ng tr\u1ed1ng ph\u00e2n t\u00e1ch \u0111o\u1ea1n, t\u00e1ch theo \u0111o\u1ea1n NGAY L\u1eacP T\u1ee8C\n    // \u0110i\u1ec1u n\u00e0y gi\u00fap v\u0103n b\u1ea3n < 700 k\u00fd t\u1ef1 nh\u01b0ng c\u00f3 2-3 \u0111o\u1ea1n v\u1eabn t\u00e1ch th\u00e0nh nhi\u1ec1u chunk \u0111\u00fang \u00fd\n    // CH\u1ec8 \u00e1p d\u1ee5ng khi c\u00f4ng t\u1eafc \u0111\u01b0\u1ee3c b\u1eadt\n    const enableBlankLineChunking = document.getElementById('enable-blank-line-chunking')?.checked ?? true;\n    if (enableBlankLineChunking && /\\n\\s*\\n+/.test(currentText)) {\n        const parts = currentText.split(/\\n\\s*\\n+/).map(p => p.trim()).filter(p => p.length > 0);\n        if (parts.length > 1) {\n            for (const part of parts) {\n                if (part.length <= actualMaxLength) {\n                    chunks.push(part);\n                } else {\n                    // N\u1ebfu m\u1ed9t \u0111o\u1ea1n ri\u00eang l\u1ebb v\u1eabn > actualMaxLength, chia nh\u1ecf b\u1eb1ng logic c\u0169\n                    chunks.push(...NrfPVBbJv_Dph$tazCpJ(part, idealLength, minLength, actualMaxLength));\n                }\n            }\n            return chunks;\n        }\n    }\n\n    while (currentText.length > 0) {\n        if (currentText.length <= actualMaxLength) {\n            chunks.push(currentText);\n            break;\n        }\n\n        let sliceToSearch = currentText.substring(0, actualMaxLength);\n        let splitIndex = -1;\n\n        // \u01afU TI\u00caN 1 (M\u1edaI): T\u00e1ch t\u1ea1i d\u00f2ng tr\u1ed1ng g\u1ea7n nh\u1ea5t trong sliceToSearch\n        // Ch\u1ec9 \u00e1p d\u1ee5ng khi c\u00f4ng t\u1eafc \u0111\u01b0\u1ee3c b\u1eadt\n        const enableBlankLineChunking = document.getElementById('enable-blank-line-chunking')?.checked ?? true;\n        if (enableBlankLineChunking) {\n            const blankLineRegex = /\\n\\s*\\n/g;\n            let match;\n            let lastBlankIdx = -1;\n            while ((match = blankLineRegex.exec(sliceToSearch)) !== null) {\n                if (match.index >= minLength) {\n                    lastBlankIdx = match.index + match[0].length; // c\u1eaft sau c\u1ee5m d\u00f2ng tr\u1ed1ng\n                }\n            }\n            if (lastBlankIdx !== -1) {\n                splitIndex = lastBlankIdx;\n            }\n        }\n        // N\u1ebfu c\u00f4ng t\u1eafc t\u1eaft, \u0111\u1ea3m b\u1ea3o splitIndex v\u1eabn l\u00e0 -1 \u0111\u1ec3 logic ti\u1ebfp theo ho\u1ea1t \u0111\u1ed9ng\n\n        // T\u1ea0M TH\u1edcI THAY TH\u1ebe C\u00c1C TH\u1eba <#...#> \u0110\u1ec2 TR\u00c1NH LOGIC T\u00ccM KI\u1ebeM B\u1eca NH\u1ea6M L\u1eaaN\n        const placeholder = \"[[PAUSE_TAG]]\";\n        const tempSlice = sliceToSearch.replace(/<#[0-9.]+#>/g, placeholder);\n\n        // --- B\u1eaft \u0111\u1ea7u logic t\u00ecm \u0111i\u1ec3m c\u1eaft ---\n\n        // \u01afu ti\u00ean 2: T\u00ecm v\u1ecb tr\u00ed c\u1ee7a placeholder (\u0111\u1ea1i di\u1ec7n cho th\u1ebb <#...#>)\n        // Ch\u1ec9 \u00e1p d\u1ee5ng khi ch\u01b0a t\u00ecm \u0111\u01b0\u1ee3c \u0111i\u1ec3m c\u1eaft t\u1eeb \u01b0u ti\u00ean 1 (d\u00f2ng tr\u1ed1ng)\n        let lastPauseTagIndex = tempSlice.lastIndexOf(placeholder);\n        if (splitIndex === -1 && lastPauseTagIndex !== -1 && lastPauseTagIndex >= minLength) {\n            // C\u1eaft ngay tr\u01b0\u1edbc th\u1ebb <#...#> t\u01b0\u01a1ng \u1ee9ng trong chu\u1ed7i g\u1ed1c\n            // C\u1ea7n t\u00ecm v\u1ecb tr\u00ed c\u1ee7a th\u1ebb <#...#> cu\u1ed1i c\u00f9ng trong sliceToSearch g\u1ed1c\n            const matches = sliceToSearch.match(/<#[0-9.]+#>/g);\n            if (matches && matches.length > 0) {\n                splitIndex = sliceToSearch.lastIndexOf(matches[matches.length - 1]);\n            } else {\n                // Fallback if for some reason no match found in original slice\n                splitIndex = lastPauseTagIndex;\n            }\n        } else if (splitIndex === -1) {\n            // \u01afu ti\u00ean 3: T\u00ecm d\u1ea5u c\u00e2u k\u1ebft th\u00fac c\u00e2u (\u0111\u00e3 b\u1ecf qua c\u00e1c d\u1ea5u trong th\u1ebb)\n            const lastPeriod = tempSlice.lastIndexOf('.');\n            const lastQuestionMark = tempSlice.lastIndexOf('?');\n            const bestEndSentenceIndex = Math.max(lastPeriod, lastQuestionMark);\n\n            if (bestEndSentenceIndex >= minLength) {\n                // S\u1eecA L\u1ed6I: C\u1eaft SAU d\u1ea5u c\u00e2u thay v\u00ec c\u1eaft T\u1ea0I d\u1ea5u c\u00e2u\n                splitIndex = bestEndSentenceIndex + 1;\n            } else {\n                // \u01afu ti\u00ean 4: T\u00ecm d\u1ea5u ph\u1ea9y\n                const lastComma = tempSlice.lastIndexOf(',');\n                if (lastComma >= minLength) {\n                    splitIndex = lastComma + 1;\n                } else {\n                    // \u01afu ti\u00ean 5: T\u00ecm kho\u1ea3ng tr\u1eafng cu\u1ed1i c\u00f9ng\n                    const lastSpace = tempSlice.lastIndexOf(' ');\n                    if (lastSpace >= minLength) {\n                        splitIndex = lastSpace;\n                    } else {\n                        // Gi\u1ea3i ph\u00e1p cu\u1ed1i c\u00f9ng: C\u1eaft c\u1ee9ng t\u1ea1i \u0111\u1ed9 d\u00e0i l\u00fd t\u01b0\u1edfng\n                        splitIndex = idealLength;\n                    }\n                }\n            }\n        }\n\n        const chunk = currentText.substring(0, splitIndex).trim();\n        if (chunk) {\n            chunks.push(chunk);\n        }\n\n        currentText = currentText.substring(splitIndex).trim();\n    }\n\n    return chunks.filter(c => c.length > 0);\n}\n\n// H\u00e0m t\u00e1ch chunk th\u00f4ng minh m\u1edbi - \u01b0u ti\u00ean theo \u0111o\u1ea1n v\u0103n\nfunction smartSplitter(text, maxLength = 700) {\n    // L\u1ea5y gi\u00e1 tr\u1ecb t\u1eeb c\u00f4ng t\u1eafc chunk size\n    const chunkSizeToggle = document.getElementById('chunk-size-toggle');\n    const useLargeChunks = chunkSizeToggle ? chunkSizeToggle.checked : false;\n    const actualMaxLength = useLargeChunks ? 900 : 700;\n\n    const finalChunks = [];\n    if (!text || typeof text !== 'string') {\n        return finalChunks;\n    }\n\n    // Chu\u1ea9n h\u00f3a xu\u1ed1ng d\u00f2ng (Windows \\r\\n -> \\n) v\u00e0 thay <br> th\u00e0nh xu\u1ed1ng d\u00f2ng\n    const normalized = text\n        .replace(/\\r\\n/g, '\\n')\n        .replace(/\\r/g, '\\n')\n        .replace(/<br\\s*\\/?>(?=\\s*\\n?)/gi, '\\n')\n        .replace(/\\u00A0/g, ' ');\n\n    // T\u00e1ch v\u0103n b\u1ea3n th\u00e0nh c\u00e1c \u0111o\u1ea1n d\u1ef1a tr\u00ean 2 (ho\u1eb7c nhi\u1ec1u h\u01a1n) d\u1ea5u xu\u1ed1ng d\u00f2ng\n    // (regex n\u00e0y c\u00f3 ngh\u0129a l\u00e0: 1 d\u1ea5u \\n, theo sau l\u00e0 0 ho\u1eb7c nhi\u1ec1u kho\u1ea3ng tr\u1eafng, r\u1ed3i l\u1ea1i 1 d\u1ea5u \\n)\n    let paragraphs = normalized.split(/\\n\\s*\\n+/);\n    paragraphs = paragraphs.map(p => p.trim()).filter(p => p.length > 0);\n    addLogEntry(`\ud83e\udde9 Smart split: ph\u00e1t hi\u1ec7n ${paragraphs.length} \u0111o\u1ea1n v\u0103n`, 'info');\n    addLogEntry(`\ud83e\udde9 Debug: v\u0103n b\u1ea3n chu\u1ea9n h\u00f3a c\u00f3 ${normalized.length} k\u00fd t\u1ef1`, 'info');\n    addLogEntry(`\ud83e\udde9 Debug: c\u00f3 ch\u1ee9a \\\\n: ${normalized.includes('\\n')}`, 'info');\n\n    // Fallback: n\u1ebfu v\u00ec l\u00fd do n\u00e0o \u0111\u00f3 kh\u00f4ng ph\u00e1t hi\u1ec7n \u0111\u01b0\u1ee3c \u0111o\u1ea1n n\u00e0o, th\u1eed t\u00e1ch theo t\u1eebng d\u00f2ng c\u00f3 n\u1ed9i dung\n    if (paragraphs.length === 1 && normalized.includes('\\n')) {\n        const lines = normalized.split(/\\n+/).map(l => l.trim()).filter(l => l.length > 0);\n        if (lines.length > 1) {\n            addLogEntry(`\ud83e\udde9 Smart split fallback: d\u00f9ng t\u00e1ch theo d\u00f2ng (${lines.length} d\u00f2ng)`, 'warning');\n            paragraphs = lines;\n        }\n    }\n\n    // N\u1ebfu v\u1eabn ch\u1ec9 c\u00f3 1 \u0111o\u1ea1n, th\u1eed t\u00e1ch theo d\u00f2ng \u0111\u01a1n l\u1ebb\n    if (paragraphs.length === 1) {\n        const singleLines = normalized.split(/\\n/).map(l => l.trim()).filter(l => l.length > 0);\n        if (singleLines.length > 1) {\n            addLogEntry(`\ud83e\udde9 Smart split fallback 2: d\u00f9ng t\u00e1ch theo d\u00f2ng \u0111\u01a1n (${singleLines.length} d\u00f2ng)`, 'warning');\n            paragraphs = singleLines;\n        }\n    }\n\n    for (const para of paragraphs) {\n        const trimmedPara = para.trim();\n\n        if (trimmedPara.length === 0) {\n            continue; // B\u1ecf qua c\u00e1c \u0111o\u1ea1n tr\u1ed1ng\n        }\n\n        // TR\u01af\u1edcNG H\u1ee2P 1: \u0110o\u1ea1n v\u0103n \u0111\u1ee7 ng\u1eafn (< actualMaxLength k\u00fd t\u1ef1)\n        if (trimmedPara.length <= actualMaxLength) {\n            finalChunks.push(trimmedPara);\n\n        // TR\u01af\u1edcNG H\u1ee2P 2: \u0110o\u1ea1n v\u0103n qu\u00e1 d\u00e0i (> actualMaxLength k\u00fd t\u1ef1)\n        } else {\n            // N\u1ebfu \u0111o\u1ea1n n\u00e0y qu\u00e1 d\u00e0i, ch\u00fang ta s\u1ebd d\u00f9ng l\u1ea1i h\u00e0m t\u00e1ch C\u0168\n            // (NrfPVBbJv_Dph$tazCpJ) \u0111\u1ec3 chia nh\u1ecf ch\u00ednh \u0111o\u1ea1n n\u00e0y.\n            addLogEntry(`\ud83e\udde0 \u0110o\u1ea1n v\u0103n d\u00e0i ${trimmedPara.length} k\u00fd t\u1ef1, \u0111ang chia nh\u1ecf...`, 'info');\n            const subChunks = NrfPVBbJv_Dph$tazCpJ(trimmedPara, 600, 500, actualMaxLength);\n\n            // Th\u00eam c\u00e1c chunk con v\u00e0o k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng\n            finalChunks.push(...subChunks);\n        }\n    }\n\n    return finalChunks.filter(c => c.length > 0);\n}\n\n// Expose smartSplitter ra global scope \u0111\u1ec3 t\u1ea1o file h\u00e0ng lo\u1ea1t c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng\nwindow.smartSplitter = smartSplitter;\n\nfunction dExAbhXwTJeTJBIjWr(EARfsfSN_QdgxH){const tENdSoNDV_gGwQKLZv$sYaZKhl=AP$u_huhInYfTj,T$dCpaznIPQ_UPNPAquzJhwHya=document[tENdSoNDV_gGwQKLZv$sYaZKhl(0x207)](tENdSoNDV_gGwQKLZv$sYaZKhl(0x263));for(const uUautBCIQlQydFiAF of T$dCpaznIPQ_UPNPAquzJhwHya){if(uUautBCIQlQydFiAF[tENdSoNDV_gGwQKLZv$sYaZKhl(0x273)][tENdSoNDV_gGwQKLZv$sYaZKhl(0x1d4)]()[tENdSoNDV_gGwQKLZv$sYaZKhl(0x1d1)]()===EARfsfSN_QdgxH[tENdSoNDV_gGwQKLZv$sYaZKhl(0x1d1)]())return KxTOuAJu(uUautBCIQlQydFiAF);}return![];}function s_BrlXXxPOJaBMKQX(){const Qhhztv_Emh_V=AP$u_huhInYfTj,qEJFmmYaq_ZY$ADPfvGUAMIlmIC=document[Qhhztv_Emh_V(0x1de)](Qhhztv_Emh_V(0x1c2)),IhdbQcdDHJpPksT$$OGFBBMT=document[Qhhztv_Emh_V(0x1cd)](Qhhztv_Emh_V(0x1e0)),rxGCINQSAqsWepsnWTGJOpnkL=document[Qhhztv_Emh_V(0x1cd)](Qhhztv_Emh_V(0x251));if(qEJFmmYaq_ZY$ADPfvGUAMIlmIC){qEJFmmYaq_ZY$ADPfvGUAMIlmIC[Qhhztv_Emh_V(0x1c7)]='';if(IhdbQcdDHJpPksT$$OGFBBMT){const wdZDFYMevO_$Lwy=document[Qhhztv_Emh_V(0x25a)](Qhhztv_Emh_V(0x23c));wdZDFYMevO_$Lwy[Qhhztv_Emh_V(0x1f1)]=IhdbQcdDHJpPksT$$OGFBBMT[Qhhztv_Emh_V(0x1f1)],wdZDFYMevO_$Lwy[Qhhztv_Emh_V(0x23e)]=Qhhztv_Emh_V(0x245),qEJFmmYaq_ZY$ADPfvGUAMIlmIC[Qhhztv_Emh_V(0x1eb)](wdZDFYMevO_$Lwy);}if(rxGCINQSAqsWepsnWTGJOpnkL){const MTKrudpbV$ZIhmZO=document[Qhhztv_Emh_V(0x25a)](Qhhztv_Emh_V(0x1be));MTKrudpbV$ZIhmZO['id']=Qhhztv_Emh_V(0x257),MTKrudpbV$ZIhmZO[Qhhztv_Emh_V(0x273)]=Qhhztv_Emh_V(0x1e9)+rxGCINQSAqsWepsnWTGJOpnkL[Qhhztv_Emh_V(0x273)][Qhhztv_Emh_V(0x1d4)](),qEJFmmYaq_ZY$ADPfvGUAMIlmIC[Qhhztv_Emh_V(0x1eb)](MTKrudpbV$ZIhmZO);}}}async function tt__SfNwBHDebpWJOqrSTR(){const VCAHyXsrERcpXVhFPxmgdBjjh=AP$u_huhInYfTj,zEwMPLN$IZxzIwfdDbCfnIYcA=new Date();cHjV$QkAT$JWlL[VCAHyXsrERcpXVhFPxmgdBjjh(0x273)]=VCAHyXsrERcpXVhFPxmgdBjjh(0x1ce)+ymkKApNTfjOanYIBsxsoMNBX((zEwMPLN$IZxzIwfdDbCfnIYcA-dqj_t_Mr)/(Number(-0x27)*Math.floor(-0x26)+0x1f37+0x25*Math.floor(-parseInt(0xe5))));if(ZTQj$LF$o[VCAHyXsrERcpXVhFPxmgdBjjh(0x216)]===parseFloat(-0x1ca4)+Number(-parseInt(0x2445))+parseInt(0x40e9))return;try{\n// S\u1eed d\u1ee5ng window.chunkBlobs n\u1ebfu c\u00f3 v\u00e0 c\u00f3 d\u1eef li\u1ec7u, n\u1ebfu kh\u00f4ng th\u00ec d\u00f9ng ZTQj$LF$o\nlet finalBlobs = ZTQj$LF$o; // M\u1eb7c \u0111\u1ecbnh d\u00f9ng ZTQj$LF$o nh\u01b0 code g\u1ed1c\nif (window.chunkBlobs && window.chunkBlobs.length > 0) {\n    const validBlobs = window.chunkBlobs.filter(blob => blob !== null);\n    if (validBlobs.length > 0) {\n        finalBlobs = validBlobs; // Ch\u1ec9 d\u00f9ng window.chunkBlobs n\u1ebfu c\u00f3 d\u1eef li\u1ec7u\n    }\n}\nconst InRdxToeqTDyPgDGZb=new Blob(finalBlobs,{'type':VCAHyXsrERcpXVhFPxmgdBjjh(0x1f5)}),BBNDYjhHoGkj_qbbbJu=URL[VCAHyXsrERcpXVhFPxmgdBjjh(0x1f0)](InRdxToeqTDyPgDGZb);PEYtOIOW[VCAHyXsrERcpXVhFPxmgdBjjh(0x25c)]=BBNDYjhHoGkj_qbbbJu,PEYtOIOW[VCAHyXsrERcpXVhFPxmgdBjjh(0x1c8)]=i_B_kZYD(),zQizakWdLEdLjtenmCbNC[VCAHyXsrERcpXVhFPxmgdBjjh(0x1fb)][VCAHyXsrERcpXVhFPxmgdBjjh(0x1e1)]=VCAHyXsrERcpXVhFPxmgdBjjh(0x258),document[VCAHyXsrERcpXVhFPxmgdBjjh(0x1de)](VCAHyXsrERcpXVhFPxmgdBjjh(0x225))[VCAHyXsrERcpXVhFPxmgdBjjh(0x1fb)][VCAHyXsrERcpXVhFPxmgdBjjh(0x1e1)]=VCAHyXsrERcpXVhFPxmgdBjjh(0x258);if(n_WwsStaC$jzsWjOIjRqedTG)n_WwsStaC$jzsWjOIjRqedTG[VCAHyXsrERcpXVhFPxmgdBjjh(0x26c)]();typeof WaveSurfer===VCAHyXsrERcpXVhFPxmgdBjjh(0x24d)&&await new Promise(dyvridmApUsyBfpYIHkxv=>setTimeout(dyvridmApUsyBfpYIHkxv,parseInt(0xf61)+Math.ceil(-parseInt(0x1e0))+-parseInt(0xb8d))),n_WwsStaC$jzsWjOIjRqedTG=WaveSurfer[VCAHyXsrERcpXVhFPxmgdBjjh(0x240)]({'container':VCAHyXsrERcpXVhFPxmgdBjjh(0x274),'waveColor':VCAHyXsrERcpXVhFPxmgdBjjh(0x26a),'progressColor':VCAHyXsrERcpXVhFPxmgdBjjh(0x228),'cursorColor':VCAHyXsrERcpXVhFPxmgdBjjh(0x20c),'barWidth':0x3,'barRadius':0x3,'cursorWidth':0x1,'height':0x64,'barGap':0x3}),n_WwsStaC$jzsWjOIjRqedTG[VCAHyXsrERcpXVhFPxmgdBjjh(0x1d5)](BBNDYjhHoGkj_qbbbJu),n_WwsStaC$jzsWjOIjRqedTG['on'](VCAHyXsrERcpXVhFPxmgdBjjh(0x1d6),()=>{const Ipo_CDaCvNEfh=VCAHyXsrERcpXVhFPxmgdBjjh;XvyPnqSRdJtYjSxingI[Ipo_CDaCvNEfh(0x1c7)]='\u23f8\ufe0f';}),n_WwsStaC$jzsWjOIjRqedTG['on'](VCAHyXsrERcpXVhFPxmgdBjjh(0x22d),()=>{const NdVplyNSVhdzFR=VCAHyXsrERcpXVhFPxmgdBjjh;XvyPnqSRdJtYjSxingI[NdVplyNSVhdzFR(0x1c7)]='\u25b6\ufe0f';});\n\n        // L\u01b0u file \u0111\u00e3 merge v\u00e0o l\u1ecbch s\u1eed IndexedDB \u0111\u1ec3 ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 xem l\u1ea1i sau\n        try {\n            const fileName = i_B_kZYD();\n            const db = window.historyDB || historyDB;\n            \n            if (db && typeof db.saveMergedFile === 'function') {\n                await db.saveMergedFile(fileName, InRdxToeqTDyPgDGZb, {\n                    chunkCount: finalBlobs.length,\n                    totalChunks: SI$acY.length\n                });\n                addLogEntry(`\ud83d\udcda \u0110\u00e3 l\u01b0u \"${fileName}\" v\u00e0o l\u1ecbch s\u1eed`, 'success');\n            }\n        } catch (historyError) {\n            // L\u1ed7i l\u01b0u l\u1ecbch s\u1eed kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn qu\u00e1 tr\u00ecnh t\u1ea1o audio ch\u00ednh\n            console.error('L\u1ed7i l\u01b0u l\u1ecbch s\u1eed:', historyError);\n        }\n\n        // --- B\u1eaeT \u0110\u1ea6U N\u00c2NG C\u1ea4P: TH\u00caM N\u00daT T\u1ea2I CHUNKS (ZIP) ---\n        try {\n            const downloadChunksBtn = document.getElementById('gemini-download-chunks-btn');\n            if (downloadChunksBtn) {\n                // Hi\u1ec3n th\u1ecb n\u00fat\n                downloadChunksBtn.style.display = 'inline-block';\n\n                // T\u1ea1o b\u1ea3n sao c\u1ee7a n\u00fat \u0111\u1ec3 x\u00f3a listener c\u0169 (n\u1ebfu c\u00f3)\n                const newBtn = downloadChunksBtn.cloneNode(true);\n                downloadChunksBtn.parentNode.replaceChild(newBtn, downloadChunksBtn);\n\n                // Th\u00eam listener m\u1edbi v\u00e0o n\u00fat\n                newBtn.addEventListener('click', async () => {\n                    addLogEntry('\ud83d\udcc1 \u0110ang chu\u1ea9n b\u1ecb t\u1ea3i tr\u1ef1c ti\u1ebfp c\u00e1c chunk...', 'info');\n\n                    // L\u1ea5y danh s\u00e1ch c\u00e1c chunk \u0111\u00e3 th\u00e0nh c\u00f4ng\n                    const successfulChunks = [];\n\n                    // \u01afU TI\u00caN 1: Ki\u1ec3m tra window.chunkBlobs tr\u01b0\u1edbc\n                    if (window.chunkBlobs && window.chunkBlobs.length > 0) {\n                        for (let i = 0; i < window.chunkBlobs.length; i++) {\n                            if (window.chunkBlobs[i] !== null) {\n                                successfulChunks.push({\n                                    index: i,\n                                    blob: window.chunkBlobs[i]\n                                });\n                            }\n                        }\n                        addLogEntry(`\ud83d\udce6 T\u00ecm th\u1ea5y ${successfulChunks.length} chunk t\u1eeb window.chunkBlobs`, 'info');\n                    }\n\n                    // \u01afU TI\u00caN 2: N\u1ebfu window.chunkBlobs r\u1ed7ng, d\u00f9ng ZTQj$LF$o\n                    if (successfulChunks.length === 0 && ZTQj$LF$o && ZTQj$LF$o.length > 0) {\n                        for (let i = 0; i < ZTQj$LF$o.length; i++) {\n                            if (ZTQj$LF$o[i] !== null && ZTQj$LF$o[i] !== undefined) {\n                                successfulChunks.push({\n                                    index: i,\n                                    blob: ZTQj$LF$o[i]\n                                });\n                            }\n                        }\n                        addLogEntry(`\ud83d\udce6 Fallback: T\u00ecm th\u1ea5y ${successfulChunks.length} chunk t\u1eeb ZTQj$LF$o`, 'info');\n                    }\n\n                    if (successfulChunks.length === 0) {\n                        addLogEntry('\u274c Kh\u00f4ng t\u00ecm th\u1ea5y chunk n\u00e0o \u0111\u1ec3 t\u1ea3i!', 'error');\n                        Swal.fire('L\u1ed7i', 'Kh\u00f4ng c\u00f3 chunk n\u00e0o \u0111\u1ec3 t\u1ea3i xu\u1ed1ng.', 'error');\n                        return;\n                    }\n\n                    // S\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1\n                    successfulChunks.sort((a, b) => a.index - b.index);\n\n                    // L\u1ea5y t\u00ean file g\u1ed1c\n                    let baseFileName = 'audio_chunks'; // T\u00ean th\u01b0 m\u1ee5c m\u1eb7c \u0111\u1ecbnh\n                    if (typeof i_B_kZYD === 'function') {\n                        baseFileName = i_B_kZYD().replace(/\\.mp3$/, '') + '_chunks';\n                    }\n\n                    addLogEntry(`\ud83d\udcc1 B\u1eaft \u0111\u1ea7u t\u1ea3i ${successfulChunks.length} chunk v\u1ec1 th\u01b0 m\u1ee5c \"${baseFileName}\"...`, 'info');\n\n                    // Hi\u1ec3n th\u1ecb th\u00f4ng b\u00e1o\n                    Swal.fire({\n                        title: '\u0110ang t\u1ea3i c\u00e1c chunk...',\n                        text: `S\u1ebd t\u1ea3i ${successfulChunks.length} file chunk tr\u1ef1c ti\u1ebfp v\u1ec1 th\u01b0 m\u1ee5c.`,\n                        icon: 'info',\n                        timer: 2000,\n                        showConfirmButton: false\n                    });\n\n                    // T\u1ea3i t\u1ea5t c\u1ea3 file c\u00f9ng l\u00fac v\u1ec1 th\u01b0 m\u1ee5c\n                    downloadAllChunksAtOnce(successfulChunks, baseFileName);\n                });\n            } else {\n                 addLogEntry('\u26a0\ufe0f Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat t\u1ea3i chunk ZIP (gemini-download-chunks-btn)', 'warning');\n            }\n        } catch (e) {\n            addLogEntry(`\u274c L\u1ed7i khi g\u1eafn listener cho n\u00fat ZIP: ${e.message}`, 'error');\n        }\n        // --- K\u1ebeT TH\u00daC N\u00c2NG C\u1ea4P ---\n\n}catch(FlhstZJmp_$Mvf){}}\n\n// =======================================================\n// == H\u00c0M T\u1ea2I TR\u1ef0C TI\u1ebeP C\u00c1C CHUNK ==\n// =======================================================\n\n// H\u00e0m t\u1ea3i t\u1ea5t c\u1ea3 chunk c\u00f9ng l\u00fac v\u1ec1 th\u01b0 m\u1ee5c\nfunction downloadAllChunksAtOnce(chunks, folderName) {\n    addLogEntry(`\ud83d\udcc1 B\u1eaft \u0111\u1ea7u t\u1ea3i ${chunks.length} file c\u00f9ng l\u00fac v\u1ec1 th\u01b0 m\u1ee5c \"${folderName}\"...`, 'info');\n\n    // T\u1ea3i t\u1ea5t c\u1ea3 file v\u1edbi delay 1 gi\u00e2y gi\u1eefa c\u00e1c l\u1ea7n t\u1ea3i\n    chunks.forEach((chunk, index) => {\n        const chunkIndex = chunk.index + 1;\n        // S\u1eeda \u0111\u1ed5i: chunk 1 -> t\u00ean file l\u00e0 \"1\", chunk 2 -> t\u00ean file l\u00e0 \"2\"\n        const fileName = `${chunkIndex}.mp3`;\n\n        // Th\u00eam delay 1 gi\u00e2y gi\u1eefa c\u00e1c l\u1ea7n t\u1ea3i\n        setTimeout(() => {\n            // T\u1ea1o URL cho blob\n            const url = URL.createObjectURL(chunk.blob);\n\n            // T\u1ea1o link t\u1ea3i xu\u1ed1ng\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = fileName;\n            a.style.display = 'none';\n\n            // Th\u00eam v\u00e0o DOM, click, r\u1ed3i x\u00f3a ngay\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n\n            // Gi\u1ea3i ph\u00f3ng URL sau m\u1ed9t ch\u00fat\n            setTimeout(() => {\n                URL.revokeObjectURL(url);\n            }, 100);\n\n            addLogEntry(`\ud83d\udcc1 \u0110\u00e3 t\u1ea3i chunk ${chunkIndex}/${chunks.length} (${Math.round(chunk.blob.size/1024)}KB) v\u1edbi t\u00ean file \"${fileName}\"`, 'info');\n        }, index * 1000); // Delay 1 gi\u00e2y cho m\u1ed7i chunk\n    });\n\n    // Th\u00f4ng b\u00e1o ho\u00e0n th\u00e0nh - t\u0103ng th\u1eddi gian ch\u1edd \u0111\u1ec3 ph\u00f9 h\u1ee3p v\u1edbi delay\n    setTimeout(() => {\n        addLogEntry('\u2705 \u0110\u00e3 t\u1ea3i xong t\u1ea5t c\u1ea3 c\u00e1c chunk!', 'success');\n        Swal.fire({\n            title: 'Ho\u00e0n th\u00e0nh!',\n            text: `\u0110\u00e3 t\u1ea3i xu\u1ed1ng ${chunks.length} file chunk th\u00e0nh c\u00f4ng. Chunk 1 -> \"1.mp3\", Chunk 2 -> \"2.mp3\", v.v.`,\n            icon: 'success',\n            timer: 3000\n        });\n    }, chunks.length * 1000 + 1000); // Ch\u1edd th\u00eam 1 gi\u00e2y sau chunk cu\u1ed1i c\u00f9ng\n}\n\n// =======================================================\n// == C\u00c1C H\u00c0M \"B\u1ed8 N\u00c3O\" CH\u1edc \u0110\u1ee2I TH\u00d4NG MINH ==\n// =======================================================\n\n/**\n * Ch\u1edd m\u1ed9t ph\u1ea7n t\u1eed xu\u1ea5t hi\u1ec7n tr\u00ean DOM m\u1ed9t c\u00e1ch th\u00f4ng minh b\u1eb1ng MutationObserver.\n * @param {string} selector - CSS selector c\u1ee7a ph\u1ea7n t\u1eed c\u1ea7n ch\u1edd (v\u00ed d\u1ee5: 'button.btn-primary').\n * @param {number} [timeout=15000] - Th\u1eddi gian ch\u1edd t\u1ed1i \u0111a, t\u00ednh b\u1eb1ng mili gi\u00e2y (m\u1eb7c \u0111\u1ecbnh 15 gi\u00e2y).\n * @returns {Promise<Element>} - Tr\u1ea3 v\u1ec1 m\u1ed9t Promise, s\u1ebd ho\u00e0n th\u00e0nh v\u1edbi ph\u1ea7n t\u1eed khi n\u00f3 \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y.\n */\nfunction waitForElement(selector, timeout = 15000) {\n    return new Promise((resolve, reject) => {\n        // 1. Th\u1eed t\u00ecm ngay l\u1eadp t\u1ee9c, bi\u1ebft \u0111\u00e2u \u0111\u00e3 c\u00f3 s\u1eb5n\n        const element = document.querySelector(selector);\n        if (element) {\n            resolve(element);\n            return;\n        }\n\n        // 2. N\u1ebfu ch\u01b0a c\u00f3, t\u1ea1o m\u1ed9t \"gi\u00e1n \u0111i\u1ec7p\" (MutationObserver) \u0111\u1ec3 theo d\u00f5i\n        const observer = new MutationObserver((mutations, obs) => {\n            const targetElement = document.querySelector(selector);\n            if (targetElement) {\n                obs.disconnect(); // T\u00ecm th\u1ea5y r\u1ed3i, cho gi\u00e1n \u0111i\u1ec7p ngh\u1ec9 h\u01b0u\n                resolve(targetElement);\n            }\n        });\n\n        // 3. Ra l\u1ec7nh cho \"gi\u00e1n \u0111i\u1ec7p\" b\u1eaft \u0111\u1ea7u theo d\u00f5i to\u00e0n b\u1ed9 trang web\n        observer.observe(document.body, {\n            childList: true, // Theo d\u00f5i c\u00e1c node con \u0111\u01b0\u1ee3c th\u00eam/x\u00f3a\n            subtree: true    // Theo d\u00f5i to\u00e0n b\u1ed9 c\u00e1c \"nh\u00e1nh\" con ch\u00e1u\n        });\n\n        // 4. \u0110\u1eb7t \u0111\u1ed3ng h\u1ed3 b\u1ea5m gi\u1edd \u0111\u1ec3 tr\u00e1nh vi\u1ec7c ch\u1edd \u0111\u1ee3i v\u00f4 t\u1eadn\n        setTimeout(() => {\n            observer.disconnect(); // H\u1ebft gi\u1edd, cho gi\u00e1n \u0111i\u1ec7p ngh\u1ec9 h\u01b0u\n            reject(new Error(`Timeout: H\u1ebft th\u1eddi gian ch\u1edd ph\u1ea7n t\u1eed \"${selector}\" sau ${timeout / 1000} gi\u00e2y.`));\n        }, timeout);\n    });\n}\n\n/**\n * H\u00e0m \"B\u1ed9 N\u00e3o\" n\u00e2ng c\u1ea5p: Ch\u1edd \u0111\u1ee3i n\u00fat b\u1ea5m d\u1ef1a tr\u00ean m\u1ed9t ho\u1eb7c nhi\u1ec1u kh\u1ea3 n\u0103ng v\u1ec1 text.\n * @param {string|string[]} buttonTexts - M\u1ed9t text ho\u1eb7c m\u1ed9t m\u1ea3ng c\u00e1c text c\u00f3 th\u1ec3 c\u00f3 tr\u00ean n\u00fat.\n * @param {number} [timeout=15000] - Th\u1eddi gian ch\u1edd t\u1ed1i \u0111a.\n * @returns {Promise<Element>} - Tr\u1ea3 v\u1ec1 n\u00fat \u0111\u00e3 t\u00ecm th\u1ea5y.\n */\nasync function waitForButton(buttonTexts, timeout = 15000) {\n    const textsToFind = Array.isArray(buttonTexts) ? buttonTexts : [buttonTexts];\n    const logText = `\"${textsToFind.join('\" ho\u1eb7c \"')}\"`;\n\n    try {\n        const stableButtonSelector = '.clone-voice-ux-v2 button.ant-btn, button[class*=\"ant-btn\"], .ant-btn, button';\n\n        addLogEntry(`\u23f3 \u0110ang ch\u1edd n\u00fat ${logText} s\u1eb5n s\u00e0ng...`);\n\n        await waitForElement(stableButtonSelector, timeout);\n\n        const buttons = document.querySelectorAll(stableButtonSelector);\n        let targetButton = null;\n\n        // V\u00f2ng l\u1eb7p t\u00ecm n\u00fat kh\u1edbp v\u1edbi B\u1ea4T K\u1ef2 text n\u00e0o trong m\u1ea3ng\n        for (const btn of buttons) {\n            const btnText = (btn.textContent || btn.innerText || '').toLowerCase().trim();\n            if (btnText && textsToFind.some(text => btnText.includes(text.toLowerCase()))) {\n                targetButton = btn;\n                break; // T\u00ecm th\u1ea5y th\u00ec d\u1eebng ngay\n            }\n        }\n\n        if (!targetButton) {\n            throw new Error(`\u0110\u00e3 t\u00ecm th\u1ea5y c\u00e1c n\u00fat chung nh\u01b0ng kh\u00f4ng c\u00f3 n\u00fat n\u00e0o ch\u1ee9a text ${logText}`);\n        }\n\n        if (targetButton.disabled) {\n            throw new Error(`N\u00fat ${logText} \u0111ang b\u1ecb kh\u00f3a`);\n        }\n\n        addLogEntry(`\u2705 N\u00fat ${logText} \u0111\u00e3 s\u1eb5n s\u00e0ng!`);\n        return targetButton;\n\n    } catch (error) {\n        addLogEntry(`\u274c L\u1ed7i ch\u1edd n\u00fat: ${error.message}`, 'error');\n        throw error;\n    }\n}\n\n// =======================================================\n\nasync function uSTZrHUt_IC() {\n    const tQqGbytKzpHwhGmeQJucsrq = AP$u_huhInYfTj;\n    if (MEpJezGZUsmpZdAgFRBRZW) return;\n\n    // Logic x\u1eed l\u00fd khi \u0111\u00e3 ho\u00e0n th\u00e0nh t\u1ea5t c\u1ea3 c\u00e1c chunk\n    if (ttuo$y_KhCV >= SI$acY[tQqGbytKzpHwhGmeQJucsrq(0x216)]) {\n        // Ki\u1ec3m tra xem t\u1ea5t c\u1ea3 chunk \u0111\u00e3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd \u0111\u1ea7y \u0111\u1ee7 ch\u01b0a\n        const totalChunks = window.totalChunksForCurrentBatch || SI$acY.length;\n        // \u0110\u1ebfm chunks \u0111\u00e3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd d\u1ef1a tr\u00ean window.chunkBlobs ho\u1eb7c ZTQj$LF$o\n        const processedChunks = (window.chunkBlobs || ZTQj$LF$o).filter(blob => blob !== null && blob !== undefined).length;\n        const failedChunks = window.failedChunks || [];\n\n        addLogEntry(`\ud83d\udcca Ki\u1ec3m tra: ${processedChunks}/${totalChunks} chunks \u0111\u00e3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd`, 'info');\n\n        // Kh\u1edfi t\u1ea1o b\u1ed9 \u0111\u1ebfm waiting n\u1ebfu ch\u01b0a c\u00f3\n        if (typeof window.waitingCheckCount === 'undefined') {\n            window.waitingCheckCount = 0;\n        }\n\n        // N\u1ebfu ch\u01b0a x\u1eed l\u00fd \u0111\u1ee7 chunk, ti\u1ebfp t\u1ee5c ch\u1edd (nh\u01b0ng c\u00f3 gi\u1edbi h\u1ea1n)\n        if (processedChunks < totalChunks) {\n            window.waitingCheckCount++;\n            const maxWaitingChecks = 10; // Ch\u1edd t\u1ed1i \u0111a 10 l\u1ea7n x 2s = 20s\n            \n            if (window.waitingCheckCount >= maxWaitingChecks) {\n                // \u0110\u00e3 ch\u1edd qu\u00e1 l\u00e2u, c\u00f3 th\u1ec3 c\u00f3 chunk failed ch\u01b0a retry\n                addLogEntry(`\u26a0\ufe0f \u0110\u00e3 ch\u1edd ${maxWaitingChecks * 2}s nh\u01b0ng v\u1eabn c\u00f2n ${totalChunks - processedChunks} chunk ch\u01b0a x\u1eed l\u00fd`, 'warning');\n                \n                // T\u00ecm c\u00e1c chunk ch\u01b0a c\u00f3 blob v\u00e0 \u0111\u00e1nh d\u1ea5u l\u00e0 failed\n                const chunkBlobsArray = window.chunkBlobs || ZTQj$LF$o;\n                for (let i = 0; i < totalChunks; i++) {\n                    if (!chunkBlobsArray[i] && !failedChunks.includes(i)) {\n                        failedChunks.push(i);\n                        window.chunkStatus[i] = 'failed';\n                        addLogEntry(`\u26a0\ufe0f Chunk ${i + 1} ch\u01b0a c\u00f3 blob, t\u1ef1 \u0111\u1ed9ng \u0111\u00e1nh d\u1ea5u l\u00e0 failed`, 'warning');\n                    }\n                }\n                \n                // Reset waiting count v\u00e0 force retry\n                window.waitingCheckCount = 0;\n                window.failedChunks = failedChunks;\n                \n                // N\u1ebfu c\u00f3 failed chunks, chuy\u1ec3n sang retry mode\n                if (failedChunks.length > 0) {\n                    addLogEntry(`\ud83d\udd04 Ph\u00e1t hi\u1ec7n ${failedChunks.length} chunk c\u1ea7n retry. Chuy\u1ec3n sang retry mode...`, 'warning');\n                    // Kh\u00f4ng return, \u0111\u1ec3 r\u01a1i v\u00e0o logic retry b\u00ean d\u01b0\u1edbi\n                } else {\n                    addLogEntry(`\u23f3 C\u00f2n ${totalChunks - processedChunks} chunk ch\u01b0a \u0111\u01b0\u1ee3c x\u1eed l\u00fd. Ti\u1ebfp t\u1ee5c ch\u1edd...`, 'warning');\n                    setTimeout(uSTZrHUt_IC, 2000);\n                    return;\n                }\n            } else {\n                addLogEntry(`\u23f3 C\u00f2n ${totalChunks - processedChunks} chunk ch\u01b0a \u0111\u01b0\u1ee3c x\u1eed l\u00fd. Ti\u1ebfp t\u1ee5c ch\u1edd... (${window.waitingCheckCount}/${maxWaitingChecks})`, 'warning');\n                setTimeout(uSTZrHUt_IC, 2000);\n                return;\n            }\n        } else {\n            // \u0110\u00e3 x\u1eed l\u00fd \u0111\u1ee7 chunk, reset waiting count\n            window.waitingCheckCount = 0;\n        }\n\n        // N\u1ebfu c\u00f3 chunk th\u1ea5t b\u1ea1i v\u00e0 ch\u01b0a ki\u1ec3m tra cu\u1ed1i\n        if (failedChunks.length > 0 && !window.isFinalCheck) {\n            addLogEntry(`\ud83d\udd0d Ph\u00e1t hi\u1ec7n ${failedChunks.length} chunk th\u1ea5t b\u1ea1i. B\u1eaft \u0111\u1ea7u x\u1eed l\u00fd l\u1ea1i...`, 'warning');\n            addLogEntry(`\ud83d\udccb Danh s\u00e1ch chunk th\u1ea5t b\u1ea1i: ${failedChunks.map(i => i + 1).join(', ')}`, 'info');\n            window.isFinalCheck = true;\n            window.retryCount = 0; // Reset b\u1ed9 \u0111\u1ebfm retry\n            \n            // \u00c1p d\u1ee5ng c\u01a1 ch\u1ebf Reset an to\u00e0n: Kh\u00f4i ph\u1ee5c Giao di\u1ec7n m\u1ed9t l\u1ea7n\n            addLogEntry(`\ud83d\udd04 \u00c1p d\u1ee5ng c\u01a1 ch\u1ebf Reset an to\u00e0n: Kh\u00f4i ph\u1ee5c Giao di\u1ec7n...`, 'info');\n            addLogEntry(`\ud83d\udd04 \u0110ang nh\u1ea5n n\u00fat \"T\u1ea1o l\u1ea1i\" \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i web s\u1ea1ch s\u1ebd...`, 'info');\n            \n            // S\u1eed d\u1ee5ng async IIFE \u0111\u1ec3 x\u1eed l\u00fd reset\n            (async () => {\n                try {\n                    // T\u00ecm v\u00e0 click n\u00fat \"Regenerate\" ho\u1eb7c \"T\u1ea1o l\u1ea1i\"\n                    const regenerateButtons = document.querySelectorAll('button, .ant-btn');\n                    let foundRegenerate = false;\n\n                    for (const btn of regenerateButtons) {\n                        const btnText = (btn.textContent || '').toLowerCase().trim();\n                        if (btnText.includes('regenerate') || btnText.includes('t\u1ea1o l\u1ea1i') ||\n                            btnText.includes('generate') || btnText.includes('t\u1ea1o')) {\n                            if (btn.offsetParent !== null && !btn.disabled) {\n                                addLogEntry(`\ud83d\udd04 T\u00ecm th\u1ea5y n\u00fat \"${btn.textContent}\" - \u0111ang reset...`, 'info');\n                                btn.click();\n                                foundRegenerate = true;\n                                break;\n                            }\n                        }\n                    }\n\n                    if (foundRegenerate) {\n                        // Ch\u1edd web x\u1eed l\u00fd reset\n                        addLogEntry(`\u23f3 Ch\u1edd web x\u1eed l\u00fd reset...`, 'info');\n                        await new Promise(resolve => setTimeout(resolve, 3000));\n\n                        // Clear textarea \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i s\u1ea1ch\n                        const textarea = document.getElementById('gemini-hidden-text-for-request');\n                        if (textarea) {\n                            textarea.value = '';\n                            addLogEntry(`\ud83e\uddf9 \u0110\u00e3 clear textarea`, 'info');\n                        }\n\n                        // Ch\u1edd th\u00eam m\u1ed9t ch\u00fat \u0111\u1ec3 web \u1ed5n \u0111\u1ecbnh\n                        await new Promise(resolve => setTimeout(resolve, 2000));\n                        addLogEntry(`\u2705 Web \u0111\u00e3 \u0111\u01b0\u1ee3c reset th\u00e0nh c\u00f4ng!`, 'success');\n                    } else {\n                        addLogEntry(`\u26a0\ufe0f Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat reset, ti\u1ebfp t\u1ee5c...`, 'warning');\n                    }\n                } catch (resetError) {\n                    addLogEntry(`\u274c L\u1ed7i khi reset web: ${resetError.message}, ti\u1ebfp t\u1ee5c...`, 'error');\n                }\n                \n                // Nh\u1ea3y th\u1eb3ng \u0111\u1ebfn chunk l\u1ed7i \u0111\u1ea7u ti\u00ean, kh\u00f4ng \u0111\u1ebfm l\u1ea1i t\u1eeb \u0111\u1ea7u\n                const firstFailedIndex = Math.min(...failedChunks);\n                ttuo$y_KhCV = firstFailedIndex;\n                addLogEntry(`\ud83d\udd04 RETRY MODE: Nh\u1ea3y th\u1eb3ng \u0111\u1ebfn chunk ${firstFailedIndex + 1} (chunk l\u1ed7i \u0111\u1ea7u ti\u00ean), ch\u1ec9 x\u1eed l\u00fd chunks l\u1ed7i`, 'info');\n                setTimeout(uSTZrHUt_IC, 2000); // Ch\u1edd 2 gi\u00e2y r\u1ed3i b\u1eaft \u0111\u1ea7u x\u1eed l\u00fd\n            })();\n            return;\n        }\n\n        // N\u1ebfu \u0111\u00e3 ki\u1ec3m tra cu\u1ed1i c\u00f9ng ho\u1eb7c kh\u00f4ng c\u00f3 chunk th\u1ea5t b\u1ea1i\n        EfNjYNYj_O_CGB = ![];\n        LrkOcBYz_$AGjPqXLWnyiATpCI[tQqGbytKzpHwhGmeQJucsrq(0x1fb)][tQqGbytKzpHwhGmeQJucsrq(0x1e1)] = tQqGbytKzpHwhGmeQJucsrq(0x258);\n        lraDK$WDOgsXHRO[tQqGbytKzpHwhGmeQJucsrq(0x1fb)][tQqGbytKzpHwhGmeQJucsrq(0x1e1)] = tQqGbytKzpHwhGmeQJucsrq(0x209);\n        OdKzziXLxtOGjvaBMHm[tQqGbytKzpHwhGmeQJucsrq(0x1fb)][tQqGbytKzpHwhGmeQJucsrq(0x1e1)] = tQqGbytKzpHwhGmeQJucsrq(0x209);\n        LrkOcBYz_$AGjPqXLWnyiATpCI[tQqGbytKzpHwhGmeQJucsrq(0x243)] = ![];\n        LrkOcBYz_$AGjPqXLWnyiATpCI[tQqGbytKzpHwhGmeQJucsrq(0x273)] = tQqGbytKzpHwhGmeQJucsrq(0x275);\n        nWHrScjZnIyNYzztyEWwM(ttuo$y_KhCV, SI$acY[tQqGbytKzpHwhGmeQJucsrq(0x216)]);\n\n        if (window.isFinalCheck) {\n            const remainingFailedChunks = window.failedChunks.length;\n\n            if (remainingFailedChunks > 0) {\n                addLogEntry(`\u26a0\ufe0f Ho\u00e0n th\u00e0nh v\u1edbi ${SI$acY.length - remainingFailedChunks}/${SI$acY.length} chunk th\u00e0nh c\u00f4ng.`, 'warning');\n                addLogEntry(`\u274c ${remainingFailedChunks} chunk v\u1eabn th\u1ea5t b\u1ea1i: ${window.failedChunks.map(i => i + 1).join(', ')}`, 'error');\n                addLogEntry(`\ud83d\udd04 Ti\u1ebfp t\u1ee5c retry c\u00e1c chunk th\u1ea5t b\u1ea1i... (L\u1ea7n ${window.totalRetryAttempts + 1})`, 'info');\n                addLogEntry(`\u23f3 Tool s\u1ebd retry V\u00d4 H\u1ea0N cho \u0111\u1ebfn khi T\u1ea4T C\u1ea2 chunk th\u00e0nh c\u00f4ng!`, 'info');\n                addLogEntry(`\ud83d\udcca Th\u1ed1ng k\u00ea: ${window.totalRetryAttempts} l\u1ea7n retry \u0111\u00e3 th\u1ef1c hi\u1ec7n`, 'info');\n                \n                // \u00c1p d\u1ee5ng c\u01a1 ch\u1ebf Reset an to\u00e0n: Kh\u00f4i ph\u1ee5c Giao di\u1ec7n m\u1ed9t l\u1ea7n\n                addLogEntry(`\ud83d\udd04 \u00c1p d\u1ee5ng c\u01a1 ch\u1ebf Reset an to\u00e0n: Kh\u00f4i ph\u1ee5c Giao di\u1ec7n...`, 'info');\n                addLogEntry(`\ud83d\udd04 \u0110ang nh\u1ea5n n\u00fat \"T\u1ea1o l\u1ea1i\" \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i web s\u1ea1ch s\u1ebd...`, 'info');\n                \n                // S\u1eed d\u1ee5ng async IIFE \u0111\u1ec3 x\u1eed l\u00fd reset\n                (async () => {\n                    try {\n                        // T\u00ecm v\u00e0 click n\u00fat \"Regenerate\" ho\u1eb7c \"T\u1ea1o l\u1ea1i\"\n                        const regenerateButtons = document.querySelectorAll('button, .ant-btn');\n                        let foundRegenerate = false;\n\n                        for (const btn of regenerateButtons) {\n                            const btnText = (btn.textContent || '').toLowerCase().trim();\n                            if (btnText.includes('regenerate') || btnText.includes('t\u1ea1o l\u1ea1i') ||\n                                btnText.includes('generate') || btnText.includes('t\u1ea1o')) {\n                                if (btn.offsetParent !== null && !btn.disabled) {\n                                    addLogEntry(`\ud83d\udd04 T\u00ecm th\u1ea5y n\u00fat \"${btn.textContent}\" - \u0111ang reset...`, 'info');\n                                    btn.click();\n                                    foundRegenerate = true;\n                                    break;\n                                }\n                            }\n                        }\n\n                        if (foundRegenerate) {\n                            // Ch\u1edd web x\u1eed l\u00fd reset\n                            addLogEntry(`\u23f3 Ch\u1edd web x\u1eed l\u00fd reset...`, 'info');\n                            await new Promise(resolve => setTimeout(resolve, 3000));\n\n                            // Clear textarea \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i s\u1ea1ch\n                            const textarea = document.getElementById('gemini-hidden-text-for-request');\n                            if (textarea) {\n                                textarea.value = '';\n                                addLogEntry(`\ud83e\uddf9 \u0110\u00e3 clear textarea`, 'info');\n                            }\n\n                            // Ch\u1edd th\u00eam m\u1ed9t ch\u00fat \u0111\u1ec3 web \u1ed5n \u0111\u1ecbnh\n                            await new Promise(resolve => setTimeout(resolve, 2000));\n                            addLogEntry(`\u2705 Web \u0111\u00e3 \u0111\u01b0\u1ee3c reset th\u00e0nh c\u00f4ng!`, 'success');\n                        } else {\n                            addLogEntry(`\u26a0\ufe0f Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat reset, ti\u1ebfp t\u1ee5c...`, 'warning');\n                        }\n                    } catch (resetError) {\n                        addLogEntry(`\u274c L\u1ed7i khi reset web: ${resetError.message}, ti\u1ebfp t\u1ee5c...`, 'error');\n                    }\n                    \n                    // KH\u00d4NG gh\u00e9p file khi c\u00f2n chunk th\u1ea5t b\u1ea1i - ti\u1ebfp t\u1ee5c retry V\u00d4 H\u1ea0N\n                    window.retryCount = 0; // Reset b\u1ed9 \u0111\u1ebfm retry\n                    window.totalRetryAttempts++; // T\u0103ng b\u1ed9 \u0111\u1ebfm retry t\u1ed5ng th\u1ec3\n                    // Nh\u1ea3y th\u1eb3ng \u0111\u1ebfn chunk l\u1ed7i \u0111\u1ea7u ti\u00ean, kh\u00f4ng \u0111\u1ebfm l\u1ea1i t\u1eeb \u0111\u1ea7u\n                    const firstFailedIndex = Math.min(...window.failedChunks);\n                    ttuo$y_KhCV = firstFailedIndex;\n                    addLogEntry(`\ud83d\udd04 RETRY MODE: Nh\u1ea3y th\u1eb3ng \u0111\u1ebfn chunk ${firstFailedIndex + 1} (chunk l\u1ed7i \u0111\u1ea7u ti\u00ean), ch\u1ec9 x\u1eed l\u00fd chunks l\u1ed7i`, 'info');\n                    setTimeout(uSTZrHUt_IC, 2000); // Ch\u1edd 2 gi\u00e2y r\u1ed3i b\u1eaft \u0111\u1ea7u l\u1ea1i\n                })();\n                return;\n            } else {\n                addLogEntry(`\ud83c\udf89 Ho\u00e0n th\u00e0nh x\u1eed l\u00fd t\u1ea5t c\u1ea3 chunks (\u0111\u00e3 th\u1eed l\u1ea1i c\u00e1c chunk th\u1ea5t b\u1ea1i)!`, 'success');\n                addLogEntry(`\u2705 T\u1ea4T C\u1ea2 ${SI$acY.length} chunks \u0111\u00e3 th\u00e0nh c\u00f4ng! B\u1eaft \u0111\u1ea7u gh\u00e9p file...`, 'success');\n                // CH\u1ec8 gh\u00e9p file khi T\u1ea4T C\u1ea2 chunk \u0111\u00e3 th\u00e0nh c\u00f4ng\n                tt__SfNwBHDebpWJOqrSTR();\n            }\n        } else {\n            addLogEntry(`\ud83c\udf89 T\u1ea5t c\u1ea3 ${SI$acY.length} chunks \u0111\u00e3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd xong!`, 'success');\n            addLogEntry(`\u2705 T\u1ea4T C\u1ea2 ${SI$acY.length} chunks \u0111\u00e3 th\u00e0nh c\u00f4ng! B\u1eaft \u0111\u1ea7u gh\u00e9p file...`, 'success');\n            // CH\u1ec8 gh\u00e9p file khi T\u1ea4T C\u1ea2 chunk \u0111\u00e3 th\u00e0nh c\u00f4ng\n            tt__SfNwBHDebpWJOqrSTR();\n        }\n        return;\n    }\n\n    nWHrScjZnIyNYzztyEWwM(ttuo$y_KhCV, SI$acY[tQqGbytKzpHwhGmeQJucsrq(0x216)]);\n    rUxbIRagbBVychZ$GfsogD[tQqGbytKzpHwhGmeQJucsrq(0x24c)] = SI$acY[ttuo$y_KhCV];\n\n    // Kh\u1edfi t\u1ea1o h\u1ec7 th\u1ed1ng theo d\u00f5i chunk\n    if (typeof window.chunkStatus === 'undefined') window.chunkStatus = [];\n    if (typeof window.failedChunks === 'undefined') window.failedChunks = [];\n    if (typeof window.isFinalCheck === 'undefined') window.isFinalCheck = false;\n    if (typeof window.retryCount === 'undefined') window.retryCount = 0;\n    if (typeof window.totalRetryAttempts === 'undefined') window.totalRetryAttempts = 0;\n\n    // \u0110\u1ea3m b\u1ea3o m\u1ea3ng chunkStatus c\u00f3 \u0111\u1ee7 ph\u1ea7n t\u1eed\n    while (window.chunkStatus.length < SI$acY.length) {\n        window.chunkStatus.push('pending');\n    }\n\n    // Logic th\u00f4ng minh: T\u00ecm n\u00fat v\u00e0 click v\u1edbi retry\n    try {\n        // N\u1ebfu \u0111ang trong giai \u0111o\u1ea1n ki\u1ec3m tra cu\u1ed1i (RETRY MODE)\n        if (window.isFinalCheck) {\n            // N\u1ebfu chunk hi\u1ec7n t\u1ea1i kh\u00f4ng ph\u1ea3i chunk l\u1ed7i, nh\u1ea3y th\u1eb3ng \u0111\u1ebfn chunk l\u1ed7i ti\u1ebfp theo\n            if (window.chunkStatus[ttuo$y_KhCV] !== 'failed') {\n                // T\u00ecm chunk l\u1ed7i ti\u1ebfp theo\n                const remainingFailedChunks = window.failedChunks.filter(idx => idx > ttuo$y_KhCV);\n                if (remainingFailedChunks.length > 0) {\n                    const nextFailedIndex = Math.min(...remainingFailedChunks);\n                    addLogEntry(`\u23ed\ufe0f [Chunk ${ttuo$y_KhCV + 1}] \u0110\u00e3 th\u00e0nh c\u00f4ng, nh\u1ea3y th\u1eb3ng \u0111\u1ebfn chunk ${nextFailedIndex + 1} (chunk l\u1ed7i ti\u1ebfp theo)`, 'info');\n                    ttuo$y_KhCV = nextFailedIndex;\n                } else {\n                    // Kh\u00f4ng c\u00f2n chunk l\u1ed7i n\u00e0o, k\u1ebft th\u00fac\n                    addLogEntry(`\u2705 \u0110\u00e3 x\u1eed l\u00fd xong t\u1ea5t c\u1ea3 chunks l\u1ed7i!`, 'success');\n                    ttuo$y_KhCV = SI$acY.length; // \u0110\u00e1nh d\u1ea5u ho\u00e0n th\u00e0nh\n                    setTimeout(uSTZrHUt_IC, 1000);\n                    return;\n                }\n            }\n        }\n\n        // N\u1ebfu \u0111ang trong giai \u0111o\u1ea1n ki\u1ec3m tra cu\u1ed1i v\u00e0 chunk n\u00e0y th\u1ea5t b\u1ea1i, th\u00f4ng b\u00e1o \u0111ang x\u1eed l\u00fd l\u1ea1i\n        if (window.isFinalCheck && window.chunkStatus[ttuo$y_KhCV] === 'failed') {\n            addLogEntry(`\ud83d\udd04 [Chunk ${ttuo$y_KhCV + 1}] \u0110ang x\u1eed l\u00fd l\u1ea1i chunk th\u1ea5t b\u1ea1i...`, 'warning');\n        }\n\n\n        // T\u1ea1o ra c\u00e1c kh\u1ea3 n\u0103ng c\u00f3 th\u1ec3 c\u00f3 cho t\u00ean n\u00fat\n        const possibleGenerateTexts = ['Generate', 'T\u1ea1o'];\n        const possibleRegenerateTexts = ['Regenerate', 'T\u1ea1o l\u1ea1i'];\n        const buttonTexts = (ttuo$y_KhCV === 0) ? possibleGenerateTexts : possibleRegenerateTexts;\n\n        // G\u1ecdi h\u00e0m \"b\u1ed9 n\u00e3o\" \u0111\u00e3 n\u00e2ng c\u1ea5p\n        const targetButton = await waitForButton(buttonTexts);\n\n        // ANTI-DETECTION: Th\u00eam delay ng\u1eabu nhi\u00ean tr\u01b0\u1edbc khi \u0111\u1eb7t text\n        await new Promise(resolve => setTimeout(resolve, Math.random() * 1000 + 500));\n        \n        // \u0110\u1eb7t text v\u00e0o \u00f4 input \u1ea9n\n        rUxbIRagbBVychZ$GfsogD[tQqGbytKzpHwhGmeQJucsrq(0x24c)] = SI$acY[ttuo$y_KhCV];\n\n        // C\u1eadp nh\u1eadt progress bar\n        nWHrScjZnIyNYzztyEWwM(ttuo$y_KhCV, SI$acY[tQqGbytKzpHwhGmeQJucsrq(0x216)]);\n        addLogEntry(`\ud83d\udce6 [Chunk ${ttuo$y_KhCV + 1}/${SI$acY.length}] \u0110ang g\u1eedi \u0111i... (\u0111\u1ed9 d\u00e0i: ${SI$acY[ttuo$y_KhCV].length})`, 'info');\n\n        // ANTI-DETECTION: Th\u00eam delay ng\u1eabu nhi\u00ean tr\u01b0\u1edbc khi click\n        await new Promise(resolve => setTimeout(resolve, Math.random() * 2000 + 1000));\n        \n        // Th\u1ef1c hi\u1ec7n click\n        KxTOuAJu(targetButton);\n        igyo$uwVChUzI();\n\n    } catch (error) {\n        // ANTI-DETECTION: Ki\u1ec3m tra l\u1ed7i 403 tr\u01b0\u1edbc\n        if (error.message && error.message.includes('403')) {\n            addLogEntry(`\ud83d\udea8 [Chunk ${ttuo$y_KhCV + 1}] L\u1ed7i 403: Website \u0111\u00e3 ph\u00e1t hi\u1ec7n automation!`, 'error');\n            addLogEntry(`\ud83d\udca1 Gi\u1ea3i ph\u00e1p: \u0110\u00f3ng tr\u00ecnh duy\u1ec7t, m\u1edf l\u1ea1i v\u00e0 th\u1eed profile kh\u00e1c (kh\u00f4ng c\u00f3 Gmail)`, 'warning');\n            \n            if (typeof Swal !== 'undefined') {\n                Swal.fire({\n                    title: '\ud83d\udea8 Website \u0111\u00e3 ph\u00e1t hi\u1ec7n automation!',\n                    html: `\n                        <div style=\"text-align: left;\">\n                            <p><strong>L\u1ed7i 403:</strong> Website Minimax.io \u0111\u00e3 ch\u1eb7n tool automation.</p>\n                            <hr>\n                            <p><strong>\ud83d\udca1 Gi\u1ea3i ph\u00e1p:</strong></p>\n                            <ol>\n                                <li>\u0110\u00f3ng tr\u00ecnh duy\u1ec7t v\u00e0 m\u1edf l\u1ea1i</li>\n                                <li>S\u1eed d\u1ee5ng profile Chrome kh\u00e1c (kh\u00f4ng \u0111\u0103ng nh\u1eadp Gmail)</li>\n                                <li>\u0110\u1ee3i 10-15 ph\u00fat r\u1ed3i th\u1eed l\u1ea1i</li>\n                                <li>Th\u1eed tr\u00ean tr\u00ecnh duy\u1ec7t kh\u00e1c (Edge, Firefox)</li>\n                            </ol>\n                            <hr>\n                            <p><strong>\u26a0\ufe0f L\u01b0u \u00fd:</strong> Kh\u00f4ng n\u00ean \u0111\u0103ng nh\u1eadp Gmail trong profile \u0111ang d\u00f9ng tool!</p>\n                        </div>\n                    `,\n                    icon: 'warning',\n                    width: '600px',\n                    confirmButtonText: 'Hi\u1ec3u r\u1ed3i',\n                    confirmButtonColor: '#ff6b6b'\n                });\n            }\n            return; // D\u1eebng x\u1eed l\u00fd chunk n\u00e0y\n        }\n        \n        const MAX_RETRIES = 5;\n        window.retryCount++;\n\n        if (window.retryCount <= MAX_RETRIES) {\n            addLogEntry(`\ud83d\udd04 [Chunk ${ttuo$y_KhCV + 1}] Th\u1eed l\u1ea1i l\u1ea7n ${window.retryCount}/${MAX_RETRIES}...`, 'warning');\n\n            // TH\u00caM RESET WEB KHI G\u1eb6P L\u1ed6I\n            addLogEntry(`\ud83d\udd04 \u0110ang reset web v\u1ec1 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u...`, 'info');\n            addLogEntry(`\ud83d\udd04 \u0110ang kh\u00f4i ph\u1ee5c web v\u1ec1 tr\u1ea1ng th\u00e1i nh\u01b0 l\u00fac g\u1eedi chunk th\u00e0nh c\u00f4ng...`, 'info');\n\n            try {\n                // T\u00ecm v\u00e0 click n\u00fat \"Regenerate\" ho\u1eb7c \"T\u1ea1o l\u1ea1i\" \u0111\u1ec3 reset web\n                const regenerateButtons = document.querySelectorAll('button, .ant-btn');\n                let foundRegenerate = false;\n\n                for (const btn of regenerateButtons) {\n                    const btnText = (btn.textContent || '').toLowerCase().trim();\n                    if (btnText.includes('regenerate') || btnText.includes('t\u1ea1o l\u1ea1i') ||\n                        btnText.includes('generate') || btnText.includes('t\u1ea1o')) {\n                        if (btn.offsetParent !== null && !btn.disabled) {\n                            addLogEntry(`\ud83d\udd04 T\u00ecm th\u1ea5y n\u00fat \"${btn.textContent}\" - \u0111ang reset...`, 'info');\n                            btn.click();\n                            foundRegenerate = true;\n                            break;\n                        }\n                    }\n                }\n\n                if (foundRegenerate) {\n                    // Ch\u1edd web x\u1eed l\u00fd reset\n                    addLogEntry(`\u23f3 Ch\u1edd web x\u1eed l\u00fd reset...`, 'info');\n                    await new Promise(resolve => setTimeout(resolve, 3000));\n\n                    // Clear textarea \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i s\u1ea1ch\n                    const textarea = document.getElementById('gemini-hidden-text-for-request');\n                    if (textarea) {\n                        textarea.value = '';\n                        addLogEntry(`\ud83e\uddf9 \u0110\u00e3 clear textarea`, 'info');\n                    }\n\n                    // Ch\u1edd th\u00eam m\u1ed9t ch\u00fat \u0111\u1ec3 web \u1ed5n \u0111\u1ecbnh\n                    await new Promise(resolve => setTimeout(resolve, 2000));\n                    addLogEntry(`\u2705 Web \u0111\u00e3 \u0111\u01b0\u1ee3c reset th\u00e0nh c\u00f4ng!`, 'success');\n                } else {\n                    addLogEntry(`\u26a0\ufe0f Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat reset, th\u1eed t\u00ecm n\u00fat kh\u00e1c...`, 'warning');\n                    // T\u00ecm b\u1ea5t k\u1ef3 n\u00fat n\u00e0o c\u00f3 th\u1ec3 reset\n                    const anyButton = document.querySelector('.clone-voice-ux-v2 button, .clone-voice-ux-v2 .ant-btn');\n                    if (anyButton && anyButton.offsetParent !== null && !anyButton.disabled) {\n                        addLogEntry(`\ud83d\udd04 S\u1eed d\u1ee5ng n\u00fat \"${anyButton.textContent}\" \u0111\u1ec3 reset...`, 'info');\n                        anyButton.click();\n                        await new Promise(resolve => setTimeout(resolve, 3000));\n                        addLogEntry(`\u2705 Web \u0111\u00e3 \u0111\u01b0\u1ee3c reset b\u1eb1ng n\u00fat kh\u00e1c!`, 'success');\n                    } else {\n                        addLogEntry(`\u274c Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat n\u00e0o \u0111\u1ec3 reset web`, 'error');\n                    }\n                }\n            } catch (resetError) {\n                addLogEntry(`\u274c L\u1ed7i khi reset web: ${resetError.message}`, 'error');\n            }\n\n            setTimeout(uSTZrHUt_IC, 2000 * window.retryCount); // Ch\u1edd l\u00e2u h\u01a1n sau m\u1ed7i l\u1ea7n th\u1eed\n        } else {\n            addLogEntry(`\ud83d\udeab [Chunk ${ttuo$y_KhCV + 1}] Th\u1ea5t b\u1ea1i sau ${MAX_RETRIES} l\u1ea7n th\u1eed. B\u1ecf qua chunk n\u00e0y.`, 'error');\n            // \u0110\u00e1nh d\u1ea5u chunk n\u00e0y l\u00e0 th\u1ea5t b\u1ea1i\n            window.chunkStatus[ttuo$y_KhCV] = 'failed';\n            if (!window.failedChunks.includes(ttuo$y_KhCV)) {\n                window.failedChunks.push(ttuo$y_KhCV);\n            }\n            window.retryCount = 0; // Reset b\u1ed9 \u0111\u1ebfm retry\n            ttuo$y_KhCV++; // Chuy\u1ec3n sang chunk ti\u1ebfp theo\n            addLogEntry(`\u27a1\ufe0f Chuy\u1ec3n sang chunk ${ttuo$y_KhCV + 1}...`, 'info');\n            addLogEntry(`\ud83d\udcca Tr\u1ea1ng th\u00e1i: ${window.chunkStatus.filter(s => s === 'success' || s === 'failed').length}/${SI$acY.length} chunks \u0111\u00e3 x\u1eed l\u00fd`, 'info');\n            setTimeout(uSTZrHUt_IC, 2000); // Ti\u1ebfp t\u1ee5c v\u1edbi chunk ti\u1ebfp theo\n        }\n    }\n}function igyo$uwVChUzI() {\n    const VFmk$UVEL = AP$u_huhInYfTj;\n    const Yy_yaGQ$LW = document[VFmk$UVEL(0x1cd)](VFmk$UVEL(0x256));\n    if (!Yy_yaGQ$LW) return;\n\n    // Logic \u0111\u01a1n gi\u1ea3n: Ch\u1ec9 ch\u1edd k\u1ebft qu\u1ea3\n    Srnj$swt = setTimeout(() => {\n        const uINqLNrLfJbc = VFmk$UVEL;\n        if (xlgJHLP$MATDT$kTXWV) xlgJHLP$MATDT$kTXWV[uINqLNrLfJbc(0x24e)](); // D\u1eebng observer c\u0169\n        addLogEntry(`\u274c [Chunk ${ttuo$y_KhCV + 1}] Timeout. B\u1ecf qua chunk n\u00e0y.`, 'error');\n        // \u0110\u00e1nh d\u1ea5u chunk n\u00e0y l\u00e0 th\u1ea5t b\u1ea1i\n        window.chunkStatus[ttuo$y_KhCV] = 'failed';\n        if (!window.failedChunks.includes(ttuo$y_KhCV)) {\n            window.failedChunks.push(ttuo$y_KhCV);\n        }\n        ttuo$y_KhCV++; // Chuy\u1ec3n sang chunk ti\u1ebfp theo\n        addLogEntry(`\u27a1\ufe0f Chuy\u1ec3n sang chunk ${ttuo$y_KhCV + 1}...`, 'info');\n        addLogEntry(`\ud83d\udcca Tr\u1ea1ng th\u00e1i: ${window.chunkStatus.filter(s => s === 'success' || s === 'failed').length}/${SI$acY.length} chunks \u0111\u00e3 x\u1eed l\u00fd`, 'info');\n        setTimeout(uSTZrHUt_IC, 2000); // Ti\u1ebfp t\u1ee5c v\u1edbi chunk ti\u1ebfp theo\n    }, parseFloat(0x11a62) + -0x13f58 + 0x19b * parseInt(0xf2));\n\n    xlgJHLP$MATDT$kTXWV = new MutationObserver(async (w$KFkMtMom_agF, GrmINfCyEsyqJbigpyT) => {\n        const ndkpgKnjg = VFmk$UVEL;\n        for (const qcgcrPbku_NfOSGWmbTlMZNUOu of w$KFkMtMom_agF) {\n            for (const TYRNWSSd$QOYZe of qcgcrPbku_NfOSGWmbTlMZNUOu[ndkpgKnjg(0x1db)]) {\n                if (TYRNWSSd$QOYZe[ndkpgKnjg(0x217)] === 0x7fd * parseInt(-0x3) + 0xa02 + 0xdf6 && TYRNWSSd$QOYZe[ndkpgKnjg(0x1cd)](ndkpgKnjg(0x1f2))) {\n                    clearTimeout(Srnj$swt);\n                    GrmINfCyEsyqJbigpyT[ndkpgKnjg(0x24e)]();\n\n                    // Log khi th\u00e0nh c\u00f4ng\n                    addLogEntry(`\u2705 [Chunk ${ttuo$y_KhCV + 1}/${SI$acY.length}] X\u1eed l\u00fd th\u00e0nh c\u00f4ng!`, 'success');\n                    window.retryCount = 0; // Reset b\u1ed9 \u0111\u1ebfm retry khi th\u00e0nh c\u00f4ng\n                    window.chunkStatus[ttuo$y_KhCV] = 'success'; // \u0110\u00e1nh d\u1ea5u chunk n\u00e0y \u0111\u00e3 th\u00e0nh c\u00f4ng\n\n                    // N\u1ebfu \u0111ang trong giai \u0111o\u1ea1n ki\u1ec3m tra cu\u1ed1i, lo\u1ea1i b\u1ecf chunk n\u00e0y kh\u1ecfi danh s\u00e1ch th\u1ea5t b\u1ea1i\n                    if (window.isFinalCheck && window.failedChunks.includes(ttuo$y_KhCV)) {\n                        window.failedChunks = window.failedChunks.filter(index => index !== ttuo$y_KhCV);\n                        addLogEntry(`\ud83c\udf89 [Chunk ${ttuo$y_KhCV + 1}] \u0110\u00e3 kh\u00f4i ph\u1ee5c th\u00e0nh c\u00f4ng t\u1eeb tr\u1ea1ng th\u00e1i th\u1ea5t b\u1ea1i!`, 'success');\n                    }\n\n                        // \u0110\u1ed2NG B\u1ed8 H\u00d3A KHI RETRY: \u0110\u1ea3m b\u1ea3o window.chunkBlobs \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt khi retry th\u00e0nh c\u00f4ng\n                        if (typeof window.chunkBlobs === 'undefined' || !Array.isArray(window.chunkBlobs)) {\n                            window.chunkBlobs = new Array(window.totalChunksForCurrentBatch || SI$acY.length).fill(null);\n                        }\n                        // Chunk n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u v\u00e0o window.chunkBlobs \u1edf ph\u1ea7n code ph\u00eda d\u01b0\u1edbi\n\n                    const yEExghI = TYRNWSSd$QOYZe[ndkpgKnjg(0x1cd)](ndkpgKnjg(0x1f2))[ndkpgKnjg(0x1f1)];\n                    if (yEExghI && (yEExghI[ndkpgKnjg(0x20e)](ndkpgKnjg(0x1fa)) || yEExghI[ndkpgKnjg(0x20e)](ndkpgKnjg(0x26f)))) try {\n                        // ANTI-DETECTION: Th\u00eam delay ng\u1eabu nhi\u00ean v\u00e0 headers \u0111\u1ec3 tr\u00e1nh b\u1ecb ph\u00e1t hi\u1ec7n\n                        await new Promise(resolve => setTimeout(resolve, Math.random() * 1000 + 500));\n                        \n                        const FGrxK_RK = await fetch(yEExghI, {\n                            method: 'GET',\n                            headers: {\n                                'Accept': 'audio/mpeg, audio/*, */*',\n                                'Accept-Language': 'vi-VN,vi;q=0.9,en;q=0.8',\n                                'Cache-Control': 'no-cache',\n                                'Pragma': 'no-cache',\n                                'Sec-Fetch-Dest': 'audio',\n                                'Sec-Fetch-Mode': 'cors',\n                                'Sec-Fetch-Site': 'same-origin',\n                                'User-Agent': navigator.userAgent,\n                                'Referer': window.location.href\n                            },\n                            credentials: 'same-origin',\n                            mode: 'cors'\n                        });\n                        \n                        if (!FGrxK_RK['ok']) {\n                            if (FGrxK_RK.status === 403) {\n                                addLogEntry(`\u274c [Chunk ${ttuo$y_KhCV + 1}] L\u1ed7i 403: Website \u0111\u00e3 ph\u00e1t hi\u1ec7n automation. Th\u1eed l\u1ea1i sau 5 gi\u00e2y...`, 'error');\n                                await new Promise(resolve => setTimeout(resolve, 5000));\n                                throw new Error('403 Forbidden - Website detected automation');\n                            }\n                            throw new Error(ndkpgKnjg(0x241) + FGrxK_RK[ndkpgKnjg(0x237)]);\n                        }\n                        const qILAV = await FGrxK_RK[ndkpgKnjg(0x26f)]();\n                        // L\u01b0u chunk v\u00e0o \u0111\u00fang v\u1ecb tr\u00ed d\u1ef1a tr\u00ean ttuo$y_KhCV (chunk index hi\u1ec7n t\u1ea1i)\n                        const totalChunks = window.totalChunksForCurrentBatch || SI$acY.length;\n                        if (typeof window.chunkBlobs === 'undefined' || !Array.isArray(window.chunkBlobs) || window.chunkBlobs.length !== totalChunks) {\n                            window.chunkBlobs = new Array(totalChunks).fill(null);\n                            addLogEntry(`\ud83d\udd27 Kh\u1edfi t\u1ea1o l\u1ea1i window.chunkBlobs v\u1edbi ${totalChunks} v\u1ecb tr\u00ed`, 'info');\n                        }\n\n                        // QUAN TR\u1eccNG: \u0110\u1ea3m b\u1ea3o l\u01b0u \u0111\u00fang v\u1ecb tr\u00ed chunk, kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o ttuo$y_KhCV\n                        const currentChunkIndex = ttuo$y_KhCV;\n\n                        // L\u01b0u v\u00e0o window.chunkBlobs n\u1ebfu index h\u1ee3p l\u1ec7\n                        if (currentChunkIndex >= 0 && currentChunkIndex < window.chunkBlobs.length) {\n                            window.chunkBlobs[currentChunkIndex] = qILAV;\n                        }\n\n                        // \u0110\u1ed2NG B\u1ed8 H\u00d3A ZTQj$LF$o: \u0110\u1ea3m b\u1ea3o ZTQj$LF$o c\u0169ng c\u00f3 chunk \u1edf \u0111\u00fang v\u1ecb tr\u00ed\n                        if (!Array.isArray(ZTQj$LF$o) || ZTQj$LF$o.length !== totalChunks) {\n                            ZTQj$LF$o = new Array(totalChunks).fill(null);\n                            addLogEntry(`\ud83d\udd27 Kh\u1edfi t\u1ea1o l\u1ea1i ZTQj$LF$o v\u1edbi ${totalChunks} v\u1ecb tr\u00ed`, 'info');\n                        }\n                        if (currentChunkIndex >= 0 && currentChunkIndex < ZTQj$LF$o.length) {\n                            ZTQj$LF$o[currentChunkIndex] = qILAV;\n                        }\n\n                        // \u0110\u1ed2NG B\u1ed8 H\u00d3A: \u0110\u1ea3m b\u1ea3o c\u1ea3 hai m\u1ea3ng \u0111\u1ec1u c\u00f3 chunk n\u00e0y \u1edf \u0111\u00fang v\u1ecb tr\u00ed\n                        addLogEntry(`\ud83d\udd04 \u0110\u00e3 l\u01b0u chunk ${currentChunkIndex + 1} v\u00e0o v\u1ecb tr\u00ed ${currentChunkIndex} c\u1ee7a c\u1ea3 window.chunkBlobs v\u00e0 ZTQj$LF$o`, 'info');\n\n                        // DEBUG: Ki\u1ec3m tra tr\u1ea1ng th\u00e1i m\u1ea3ng sau khi l\u01b0u\n                        const chunkStatus = window.chunkBlobs.map((blob, idx) => blob ? 'c\u00f3' : 'null').join(', ');\n                        addLogEntry(`\ud83d\udd0d Tr\u1ea1ng th\u00e1i window.chunkBlobs: [${chunkStatus}]`, 'info');\n                    } catch (FBleqcOZcLNC$NKSlfC) {}\n                    ttuo$y_KhCV++;\n                    setTimeout(uSTZrHUt_IC, -parseInt(0x1) * -parseInt(0x25de) + Math.max(-0x19, -parseInt(0x19)) * -0x18a + Math.trunc(-0x467c));\n                    return;\n                }\n            }\n        }\n    });\n\n    xlgJHLP$MATDT$kTXWV[VFmk$UVEL(0x264)](Yy_yaGQ$LW, {\n        'childList': !![],\n        'subtree': !![]\n    });\n}function rBuqJlBFmwzdZnXtjIL(){const fgUnHA=AP$u_huhInYfTj,ytkOLYJZOEaDOhowaP=document[fgUnHA(0x1cd)](fgUnHA(0x246));ytkOLYJZOEaDOhowaP&&ytkOLYJZOEaDOhowaP[fgUnHA(0x224)](fgUnHA(0x1bc))===fgUnHA(0x1fe)&&KxTOuAJu(ytkOLYJZOEaDOhowaP);}function ZGEvDUSUwgCtRqI(XOH_jolXfrzfb$u){return new Promise(f$o$ehE=>{const XfxSTlMrygLQP$ENoXGlumBRM=DHk$uTvcFuLEMnixYuADkCeA,MvjhInrbVXjKVUruwh=document[XfxSTlMrygLQP$ENoXGlumBRM(0x1cd)](XfxSTlMrygLQP$ENoXGlumBRM(0x254));if(MvjhInrbVXjKVUruwh&&MvjhInrbVXjKVUruwh[XfxSTlMrygLQP$ENoXGlumBRM(0x273)][XfxSTlMrygLQP$ENoXGlumBRM(0x1d4)]()===XOH_jolXfrzfb$u){f$o$ehE(!![]);return;}if(!MvjhInrbVXjKVUruwh){f$o$ehE(![]);return;}const VZYZVbVjefOZtpoGN=[MvjhInrbVXjKVUruwh,MvjhInrbVXjKVUruwh[XfxSTlMrygLQP$ENoXGlumBRM(0x227)],document[XfxSTlMrygLQP$ENoXGlumBRM(0x1cd)](XfxSTlMrygLQP$ENoXGlumBRM(0x22e)),document[XfxSTlMrygLQP$ENoXGlumBRM(0x1cd)](XfxSTlMrygLQP$ENoXGlumBRM(0x268))][XfxSTlMrygLQP$ENoXGlumBRM(0x21d)](Boolean);let VIEdKkRYRVRqqJcvauv$yeqJs=![];for(const aSzLyIxGR$iZOAwaUnO of VZYZVbVjefOZtpoGN){if(KxTOuAJu(aSzLyIxGR$iZOAwaUnO)){VIEdKkRYRVRqqJcvauv$yeqJs=!![];break;}}if(!VIEdKkRYRVRqqJcvauv$yeqJs){f$o$ehE(![]);return;}let iravm_ITtG=Math.ceil(parseInt(0x93c))*0x3+Math.floor(-parseInt(0xb3a))+Math.max(-parseInt(0xde),-0xde)*Math.trunc(parseInt(0x13));const yZNPe_Cff=-0xf73*0x2+Math.floor(-parseInt(0xae3))*parseInt(0x1)+-parseInt(0x14e7)*-0x2;function ZUTCwm$ZO(){const Yh_c_kdQDftCJybILCYnKDHP=XfxSTlMrygLQP$ENoXGlumBRM;iravm_ITtG++;let XLdCvwP_ExUgMYvoF$PgmcYQoDm=null;for(const KhpCpYqdNeshDhzcz$YopPRCnq of[Yh_c_kdQDftCJybILCYnKDHP(0x204),Yh_c_kdQDftCJybILCYnKDHP(0x1e8),Yh_c_kdQDftCJybILCYnKDHP(0x220),Yh_c_kdQDftCJybILCYnKDHP(0x252)]){XLdCvwP_ExUgMYvoF$PgmcYQoDm=document[Yh_c_kdQDftCJybILCYnKDHP(0x1cd)](KhpCpYqdNeshDhzcz$YopPRCnq);if(XLdCvwP_ExUgMYvoF$PgmcYQoDm&&XLdCvwP_ExUgMYvoF$PgmcYQoDm[Yh_c_kdQDftCJybILCYnKDHP(0x213)]>parseInt(0xc0b)*-0x3+parseInt(0x59f)*-0x1+parseInt(0x8)*parseInt(0x538))break;}if(!XLdCvwP_ExUgMYvoF$PgmcYQoDm){iravm_ITtG<yZNPe_Cff?setTimeout(ZUTCwm$ZO,Math.trunc(-parseInt(0x1))*parseInt(0x8b1)+-0x7e9+0x128e):f$o$ehE(![]);return;}let wUar$U_QcohStsk=null;for(const JawipkxmmQvXAvdYtibQwPC of[Yh_c_kdQDftCJybILCYnKDHP(0x272),Yh_c_kdQDftCJybILCYnKDHP(0x1d3),Yh_c_kdQDftCJybILCYnKDHP(0x232),Yh_c_kdQDftCJybILCYnKDHP(0x21c),Yh_c_kdQDftCJybILCYnKDHP(0x222)]){const ndE_dgEnXpLZ=XLdCvwP_ExUgMYvoF$PgmcYQoDm[Yh_c_kdQDftCJybILCYnKDHP(0x207)](JawipkxmmQvXAvdYtibQwPC);for(const dGawOEsCtvghrtIQyMuYTxt of ndE_dgEnXpLZ){if(dGawOEsCtvghrtIQyMuYTxt[Yh_c_kdQDftCJybILCYnKDHP(0x273)][Yh_c_kdQDftCJybILCYnKDHP(0x1d4)]()===XOH_jolXfrzfb$u){wUar$U_QcohStsk=dGawOEsCtvghrtIQyMuYTxt;break;}}if(wUar$U_QcohStsk)break;}if(!wUar$U_QcohStsk){KxTOuAJu(document[Yh_c_kdQDftCJybILCYnKDHP(0x248)]),f$o$ehE(![]);return;}KxTOuAJu(wUar$U_QcohStsk)?setTimeout(()=>{const cpuoogaLGFCVSyyJxT=Yh_c_kdQDftCJybILCYnKDHP,OMvlnOvIVrYj$DdyPN_J=document[cpuoogaLGFCVSyyJxT(0x1cd)](cpuoogaLGFCVSyyJxT(0x254));OMvlnOvIVrYj$DdyPN_J&&OMvlnOvIVrYj$DdyPN_J[cpuoogaLGFCVSyyJxT(0x273)][cpuoogaLGFCVSyyJxT(0x1d4)]()===XOH_jolXfrzfb$u?f$o$ehE(!![]):f$o$ehE(![]);},Math.ceil(-0x5)*0x2ed+Number(-0x2)*parseFloat(-0xdbd)+parseInt(-0xbad)):f$o$ehE(![]);}setTimeout(ZUTCwm$ZO,-0x24d2+-0x5dd+Math.max(-parseInt(0x1),-parseInt(0x1))*-0x2d07);});}async function FqzIBEUdOwBt(Jn_xqilZP,RGKuwuYHgrIIT=Math.trunc(0xf2e)+parseFloat(-parseInt(0x132a))+0x2*parseInt(0x203)){for(let GqZKAua$R$P=-0xadf+-parseInt(0x1dbb)+-0x181*Math.max(-0x1b,-0x1b);GqZKAua$R$P<=RGKuwuYHgrIIT;GqZKAua$R$P++){const L_BWgyzzSdCDgEEDlZXBu=await ZGEvDUSUwgCtRqI(Jn_xqilZP);if(L_BWgyzzSdCDgEEDlZXBu)return!![];GqZKAua$R$P<RGKuwuYHgrIIT&&await new Promise(Kl_QYkE$QY=>setTimeout(Kl_QYkE$QY,parseInt(0x49)*Math.trunc(0x35)+-parseInt(0x966)+0x1*Math.ceil(0x219)));}return![];}function AMoS$rCm_VoQjhXaWua(){const EOSqNtA$IANphiFD=AP$u_huhInYfTj,dmVumXDOp_nMXAtgodQ=document[EOSqNtA$IANphiFD(0x1cd)](EOSqNtA$IANphiFD(0x210));if(dmVumXDOp_nMXAtgodQ){const wvqk$t=dmVumXDOp_nMXAtgodQ[EOSqNtA$IANphiFD(0x1cd)](EOSqNtA$IANphiFD(0x1f7));if(wvqk$t&&!wvqk$t[EOSqNtA$IANphiFD(0x221)])dmVumXDOp_nMXAtgodQ[EOSqNtA$IANphiFD(0x1bd)]();}}function iDQh_nSiOgsDLmvTjcMSSdUwBv(acdMRck){const BgkEiDtfuwpVhu=AP$u_huhInYfTj,gl_lA_GFvtWJu=document[BgkEiDtfuwpVhu(0x207)](BgkEiDtfuwpVhu(0x1f3));for(const iTilPnjRKvhmFKI$iUCuXlnI of gl_lA_GFvtWJu){if(iTilPnjRKvhmFKI$iUCuXlnI[BgkEiDtfuwpVhu(0x273)]&&iTilPnjRKvhmFKI$iUCuXlnI[BgkEiDtfuwpVhu(0x273)][BgkEiDtfuwpVhu(0x1d4)]()[BgkEiDtfuwpVhu(0x20e)](acdMRck)){const utDJyOyXyOqpqxwzxcVx=iTilPnjRKvhmFKI$iUCuXlnI[BgkEiDtfuwpVhu(0x249)](BgkEiDtfuwpVhu(0x1f9));if(utDJyOyXyOqpqxwzxcVx){const DLOMspx=utDJyOyXyOqpqxwzxcVx[BgkEiDtfuwpVhu(0x1cd)](BgkEiDtfuwpVhu(0x25e));if(DLOMspx){DLOMspx[BgkEiDtfuwpVhu(0x1bd)]();break;}}}}}/**\n * H\u00e0m m\u1edbi: Ch\u1edd cho \u0111\u1ebfn khi gi\u1ecdng m\u1eabu tr\u00ean web \u0111\u01b0\u1ee3c t\u1ea3i xong.\n * N\u00f3 s\u1ebd theo d\u00f5i s\u1ef1 bi\u1ebfn m\u1ea5t c\u1ee7a bi\u1ec3u t\u01b0\u1ee3ng loading.\n * @returns {Promise<boolean>} Tr\u1ea3 v\u1ec1 true n\u1ebfu th\u00e0nh c\u00f4ng, false n\u1ebfu qu\u00e1 th\u1eddi gian.\n */\nasync function waitForVoiceModelReady() {\n    const VCAHyXsrERcpXVhFPxmgdBjjh = AP$u_huhInYfTj; // T\u00e1i s\u1eed d\u1ee5ng bi\u1ebfn obfuscated c\u00f3 s\u1eb5n\n    addLogEntry('\u23f3 \u0110ang ch\u1edd website t\u1ea3i xong gi\u1ecdng m\u1eabu...', 'info');\n\n    return new Promise((resolve) => {\n        const timeout = setTimeout(() => {\n            addLogEntry('\u274c L\u1ed7i: Ch\u1edd gi\u1ecdng m\u1eabu qu\u00e1 60 gi\u00e2y. Vui l\u00f2ng th\u1eed l\u1ea1i.', 'error');\n            observer.disconnect();\n            resolve(false);\n        }, 60000); // Th\u1eddi gian ch\u1edd t\u1ed1i \u0111a 60 gi\u00e2y\n\n        const observer = new MutationObserver((mutations, obs) => {\n            // M\u1ee5c ti\u00eau l\u00e0 ph\u1ea7n t\u1eed loading c\u00f3 class '.ant-spin-spinning' trong khu v\u1ef1c clone voice\n            const loadingSpinner = document.querySelector('.clone-voice-ux-v2 .ant-spin-spinning');\n\n            if (!loadingSpinner) {\n                addLogEntry('\u2705 Gi\u1ecdng m\u1eabu \u0111\u00e3 s\u1eb5n s\u00e0ng!', 'success');\n                clearTimeout(timeout);\n                obs.disconnect();\n                resolve(true);\n            }\n        });\n\n        const targetNode = document.body;\n        const config = { childList: true, subtree: true };\n        observer.observe(targetNode, config);\n\n        // Ki\u1ec3m tra ngay l\u1ea7n \u0111\u1ea7u ti\u00ean, ph\u00f2ng tr\u01b0\u1eddng h\u1ee3p n\u00f3 \u0111\u00e3 load xong tr\u01b0\u1edbc khi observer k\u1ecbp ch\u1ea1y\n        if (!document.querySelector('.clone-voice-ux-v2 .ant-spin-spinning')) {\n             addLogEntry('\u2705 Gi\u1ecdng m\u1eabu \u0111\u00e3 s\u1eb5n s\u00e0ng! (nhanh)', 'success');\n             clearTimeout(timeout);\n             observer.disconnect();\n             resolve(true);\n        }\n    });\n}async function wfxQyKsZ_OULEUwIDIN$OYr(RWknJOoz_W = AP$u_huhInYfTj(0x244)) {\n    const zhNYCpNXjHI$uIlV$EIyWTuvKX = AP$u_huhInYfTj;\n    const hHnnogfbz$hHkQnbAxKfoWPG = X$tXvLZ => new Promise(aEp_jNC$s => setTimeout(aEp_jNC$s, X$tXvLZ));\n\n    // B\u1eaft \u0111\u1ea7u qu\u00e1 tr\u00ecnh ch\u1ecdn ng\u00f4n ng\u1eef tr\u00ean UI c\u1ee7a web\n    rBuqJlBFmwzdZnXtjIL();\n    await hHnnogfbz$hHkQnbAxKfoWPG(500); // Ch\u1edd 0.5s \u0111\u1ec3 UI m\u1edf ra\n\n    // Ch\u1ecdn ng\u00f4n ng\u1eef \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh\n    const languageSelected = await FqzIBEUdOwBt(RWknJOoz_W);\n    if (!languageSelected) {\n        addLogEntry('\u274c L\u1ed7i: Kh\u00f4ng th\u1ec3 ch\u1ecdn ng\u00f4n ng\u1eef.', 'error');\n        return false; // D\u1eebng n\u1ebfu kh\u00f4ng ch\u1ecdn \u0111\u01b0\u1ee3c ng\u00f4n ng\u1eef\n    }\n     addLogEntry(`\ud83d\udde3\ufe0f \u0110\u00e3 ch\u1ecdn ng\u00f4n ng\u1eef: ${RWknJOoz_W}.`, 'info');\n\n\n    // ---- THAY \u0110\u1ed4I QUAN TR\u1eccNG NH\u1ea4T ----\n    // G\u1ecdi h\u00e0m m\u1edbi \u0111\u1ec3 ch\u1edd gi\u1ecdng m\u1eabu load xong, thay v\u00ec d\u00f9ng setTimeout c\u1ed1 \u0111\u1ecbnh\n    const voiceModelReady = await waitForVoiceModelReady();\n    if (!voiceModelReady) {\n        // N\u1ebfu h\u00e0m tr\u1ea3 v\u1ec1 false (b\u1ecb timeout), d\u1eebng qu\u00e1 tr\u00ecnh c\u1ea5u h\u00ecnh\n        return false;\n    }\n    // ------------------------------------\n\n    // C\u00e1c b\u01b0\u1edbc d\u1ecdn d\u1eb9p v\u00e0 x\u00e1c nh\u1eadn cu\u1ed1i c\u00f9ng\n    await hHnnogfbz$hHkQnbAxKfoWPG(500); // Ch\u1edd 0.5s \u0111\u1ec3 UI \u1ed5n \u0111\u1ecbnh\n    iDQh_nSiOgsDLmvTjcMSSdUwBv(zhNYCpNXjHI$uIlV$EIyWTuvKX(0x21b)); // \u0110\u00f3ng popup n\u1ebfu c\u00f3\n    await hHnnogfbz$hHkQnbAxKfoWPG(500);\n    AMoS$rCm_VoQjhXaWua(); // D\u1ecdn d\u1eb9p th\u00eam\n\n    // Tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng\n    return true; // Tr\u1ea3 v\u1ec1 true v\u00ec \u0111\u00e3 qua \u0111\u01b0\u1ee3c b\u01b0\u1edbc ch\u1edd gi\u1ecdng m\u1eabu\n}function u_In_Taeyb(ha_vkXztSqPwoX_qmQKlcp){const scdrpb$_nwRMQXvVJ=AP$u_huhInYfTj,TJ_txTK=document[scdrpb$_nwRMQXvVJ(0x1cd)](scdrpb$_nwRMQXvVJ(0x26d));if(!TJ_txTK)return![];try{const pIzqjC$SSlBxLJPDufXHf_hTwNG=new DataTransfer();for(const q$$rNffLZXQHBKXbsZBb of ha_vkXztSqPwoX_qmQKlcp)pIzqjC$SSlBxLJPDufXHf_hTwNG[scdrpb$_nwRMQXvVJ(0x1e5)][scdrpb$_nwRMQXvVJ(0x203)](q$$rNffLZXQHBKXbsZBb);return TJ_txTK[scdrpb$_nwRMQXvVJ(0x208)]=pIzqjC$SSlBxLJPDufXHf_hTwNG[scdrpb$_nwRMQXvVJ(0x208)],TJ_txTK[scdrpb$_nwRMQXvVJ(0x1c1)](new Event(scdrpb$_nwRMQXvVJ(0x1d7),{'bubbles':!![]})),!![];}catch(tnv$KWVWNV){return![];}}WRVxYBSrPsjcqQs_bXI[AP$u_huhInYfTj(0x25f)](AP$u_huhInYfTj(0x229),()=>{const bISsk$DCGLNjOv=AP$u_huhInYfTj,LvLmlCAo_vy_AFJk=WRVxYBSrPsjcqQs_bXI[bISsk$DCGLNjOv(0x24c)];CVjXA$H[bISsk$DCGLNjOv(0x1c7)]=bISsk$DCGLNjOv(0x20f)+LvLmlCAo_vy_AFJk[bISsk$DCGLNjOv(0x216)]+bISsk$DCGLNjOv(0x1ff)+LvLmlCAo_vy_AFJk[bISsk$DCGLNjOv(0x1d4)]()[bISsk$DCGLNjOv(0x1ed)](/\\s+/)[bISsk$DCGLNjOv(0x21d)](Boolean)[bISsk$DCGLNjOv(0x216)]+bISsk$DCGLNjOv(0x1fc)+LvLmlCAo_vy_AFJk[bISsk$DCGLNjOv(0x1ed)](/[.!?\u3002\uff01\uff1f]+/)[bISsk$DCGLNjOv(0x21d)](Boolean)[bISsk$DCGLNjOv(0x216)]+bISsk$DCGLNjOv(0x23b)+LvLmlCAo_vy_AFJk[bISsk$DCGLNjOv(0x1d4)]()[bISsk$DCGLNjOv(0x1ed)](/\\n+/)[bISsk$DCGLNjOv(0x21d)](Boolean)[bISsk$DCGLNjOv(0x216)]+bISsk$DCGLNjOv(0x1f4);}),yU_jfkzmffcnGgLWrq[AP$u_huhInYfTj(0x25f)](AP$u_huhInYfTj(0x1bd),async()=>{const t$_EKwXXWYJwVOu=AP$u_huhInYfTj;if(PcLAEW[t$_EKwXXWYJwVOu(0x208)][t$_EKwXXWYJwVOu(0x216)]===0x16e0+-0x1573+-parseInt(0x49)*0x5){Swal[t$_EKwXXWYJwVOu(0x26b)]({'icon':t$_EKwXXWYJwVOu(0x212),'title':t$_EKwXXWYJwVOu(0x266),'text':t$_EKwXXWYJwVOu(0x200)});LrkOcBYz_$AGjPqXLWnyiATpCI[t$_EKwXXWYJwVOu(0x243)]=!![];return;}const pP$elepNWoiOEswuBl$wWpWgE=VcTcfGnbfWZdhQRvBp$emAVjf[t$_EKwXXWYJwVOu(0x24c)];yU_jfkzmffcnGgLWrq[t$_EKwXXWYJwVOu(0x243)]=!![],TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x273)]=t$_EKwXXWYJwVOu(0x1d0),TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x1fb)][t$_EKwXXWYJwVOu(0x26e)]=t$_EKwXXWYJwVOu(0x22f);if(u_In_Taeyb(PcLAEW[t$_EKwXXWYJwVOu(0x208)])){await new Promise(YoMwltQiCl_gqyp=>setTimeout(YoMwltQiCl_gqyp,Math.floor(-0xbf0)*Math.floor(parseInt(0x1))+parseFloat(-parseInt(0x952))+parseFloat(parseInt(0x192a)))),TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x273)]=t$_EKwXXWYJwVOu(0x267);const lYBfNBUXykQSrYdLWRfJs=await wfxQyKsZ_OULEUwIDIN$OYr(pP$elepNWoiOEswuBl$wWpWgE);lYBfNBUXykQSrYdLWRfJs?(TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x273)]=t$_EKwXXWYJwVOu(0x22b)+pP$elepNWoiOEswuBl$wWpWgE+'.',TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x1fb)][t$_EKwXXWYJwVOu(0x26e)]=t$_EKwXXWYJwVOu(0x228),LrkOcBYz_$AGjPqXLWnyiATpCI[t$_EKwXXWYJwVOu(0x243)]=![]):(TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x273)]=t$_EKwXXWYJwVOu(0x247)+pP$elepNWoiOEswuBl$wWpWgE+'.',TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x1fb)][t$_EKwXXWYJwVOu(0x26e)]=t$_EKwXXWYJwVOu(0x1e6),LrkOcBYz_$AGjPqXLWnyiATpCI[t$_EKwXXWYJwVOu(0x243)]=!![]);}else TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x273)]=t$_EKwXXWYJwVOu(0x259),TUlYLVXXZeP_OexmGXTd[t$_EKwXXWYJwVOu(0x1fb)][t$_EKwXXWYJwVOu(0x26e)]=t$_EKwXXWYJwVOu(0x1e6);yU_jfkzmffcnGgLWrq[t$_EKwXXWYJwVOu(0x243)]=![];}),LrkOcBYz_$AGjPqXLWnyiATpCI[AP$u_huhInYfTj(0x25f)](AP$u_huhInYfTj(0x1bd),()=>{const muOPzQltrb_ezJpe_MNI=AP$u_huhInYfTj;if(EfNjYNYj_O_CGB)return;const EFBSgoVbWWlkmceHpywAdxhpn=WRVxYBSrPsjcqQs_bXI[muOPzQltrb_ezJpe_MNI(0x24c)][muOPzQltrb_ezJpe_MNI(0x1d4)]();if(!EFBSgoVbWWlkmceHpywAdxhpn){Swal[muOPzQltrb_ezJpe_MNI(0x26b)]({'icon':muOPzQltrb_ezJpe_MNI(0x212),'title':muOPzQltrb_ezJpe_MNI(0x266),'text':muOPzQltrb_ezJpe_MNI(0x202)});return;}if(!PcLAEW[muOPzQltrb_ezJpe_MNI(0x208)]||PcLAEW[muOPzQltrb_ezJpe_MNI(0x208)][muOPzQltrb_ezJpe_MNI(0x216)]===0x0){Swal[muOPzQltrb_ezJpe_MNI(0x26b)]({'icon':muOPzQltrb_ezJpe_MNI(0x212),'title':muOPzQltrb_ezJpe_MNI(0x266),'text':'Vui l\u00f2ng upload file audio tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u t\u1ea1o \u00e2m thanh!'});return;}dqj_t_Mr=new Date(),zQizakWdLEdLjtenmCbNC[muOPzQltrb_ezJpe_MNI(0x1fb)][muOPzQltrb_ezJpe_MNI(0x1e1)]=muOPzQltrb_ezJpe_MNI(0x209),document[muOPzQltrb_ezJpe_MNI(0x1de)](muOPzQltrb_ezJpe_MNI(0x225))[muOPzQltrb_ezJpe_MNI(0x1fb)][muOPzQltrb_ezJpe_MNI(0x1e1)]=muOPzQltrb_ezJpe_MNI(0x209),pT$bOHGEGbXDSpcuLWAq_yMVf[muOPzQltrb_ezJpe_MNI(0x1fb)][muOPzQltrb_ezJpe_MNI(0x1e1)]=muOPzQltrb_ezJpe_MNI(0x258),cHjV$QkAT$JWlL[muOPzQltrb_ezJpe_MNI(0x273)]='';if(n_WwsStaC$jzsWjOIjRqedTG)n_WwsStaC$jzsWjOIjRqedTG[muOPzQltrb_ezJpe_MNI(0x1cc)]();ZTQj$LF$o=[],SI$acY=NrfPVBbJv_Dph$tazCpJ(EFBSgoVbWWlkmceHpywAdxhpn),ttuo$y_KhCV=0x6*Math.floor(-parseInt(0x26))+-0x1c45+Math.ceil(parseInt(0x1d29)),EfNjYNYj_O_CGB=!![],MEpJezGZUsmpZdAgFRBRZW=![],LrkOcBYz_$AGjPqXLWnyiATpCI[muOPzQltrb_ezJpe_MNI(0x1fb)][muOPzQltrb_ezJpe_MNI(0x1e1)]=muOPzQltrb_ezJpe_MNI(0x209),lraDK$WDOgsXHRO[muOPzQltrb_ezJpe_MNI(0x1fb)][muOPzQltrb_ezJpe_MNI(0x1e1)]=muOPzQltrb_ezJpe_MNI(0x258),OdKzziXLxtOGjvaBMHm[muOPzQltrb_ezJpe_MNI(0x1fb)][muOPzQltrb_ezJpe_MNI(0x1e1)]=muOPzQltrb_ezJpe_MNI(0x258),lraDK$WDOgsXHRO[muOPzQltrb_ezJpe_MNI(0x273)]=muOPzQltrb_ezJpe_MNI(0x239),uSTZrHUt_IC();}),lraDK$WDOgsXHRO[AP$u_huhInYfTj(0x25f)](AP$u_huhInYfTj(0x1bd),()=>{const AuzopbHlRPCFBPQqnHMs=AP$u_huhInYfTj;MEpJezGZUsmpZdAgFRBRZW=!MEpJezGZUsmpZdAgFRBRZW,lraDK$WDOgsXHRO[AuzopbHlRPCFBPQqnHMs(0x273)]=MEpJezGZUsmpZdAgFRBRZW?AuzopbHlRPCFBPQqnHMs(0x271):AuzopbHlRPCFBPQqnHMs(0x239);if(!MEpJezGZUsmpZdAgFRBRZW)uSTZrHUt_IC();}),OdKzziXLxtOGjvaBMHm[AP$u_huhInYfTj(0x25f)](AP$u_huhInYfTj(0x1bd),()=>{const jWtMo=AP$u_huhInYfTj;EfNjYNYj_O_CGB=![],MEpJezGZUsmpZdAgFRBRZW=![];if(xlgJHLP$MATDT$kTXWV)xlgJHLP$MATDT$kTXWV[jWtMo(0x24e)]();if(Srnj$swt)clearTimeout(Srnj$swt);ZTQj$LF$o=[],SI$acY=[],WRVxYBSrPsjcqQs_bXI[jWtMo(0x24c)]='',rUxbIRagbBVychZ$GfsogD[jWtMo(0x24c)]='',pT$bOHGEGbXDSpcuLWAq_yMVf[jWtMo(0x1fb)][jWtMo(0x1e1)]=jWtMo(0x209),zQizakWdLEdLjtenmCbNC[jWtMo(0x1fb)][jWtMo(0x1e1)]=jWtMo(0x209);if(n_WwsStaC$jzsWjOIjRqedTG)n_WwsStaC$jzsWjOIjRqedTG[jWtMo(0x1cc)]();LrkOcBYz_$AGjPqXLWnyiATpCI[jWtMo(0x1fb)][jWtMo(0x1e1)]=jWtMo(0x258),lraDK$WDOgsXHRO[jWtMo(0x1fb)][jWtMo(0x1e1)]=jWtMo(0x209),OdKzziXLxtOGjvaBMHm[jWtMo(0x1fb)][jWtMo(0x1e1)]=jWtMo(0x209),LrkOcBYz_$AGjPqXLWnyiATpCI[jWtMo(0x243)]=![],LrkOcBYz_$AGjPqXLWnyiATpCI[jWtMo(0x273)]=jWtMo(0x275);}),XvyPnqSRdJtYjSxingI[AP$u_huhInYfTj(0x25f)](AP$u_huhInYfTj(0x1bd),()=>{const XhOmEQytvnK$v=AP$u_huhInYfTj;if(n_WwsStaC$jzsWjOIjRqedTG)n_WwsStaC$jzsWjOIjRqedTG[XhOmEQytvnK$v(0x21a)]();});\n\n        // --- START: NEW FUNCTIONALITY ---\n\n        // Get references to new elements\n        const mergeBtn = document.getElementById('gemini-merge-btn');\n        const mainTextareaForNewFunc = document.getElementById('gemini-main-textarea');\n        const pairsContainer = document.getElementById('batch-replace-pairs');\n        const addPairBtn = document.getElementById('add-replace-pair-btn');\n        const executeReplaceBtn = document.getElementById('execute-replace-btn');\n\n        // --- 1. Merge Dialogue Functionality ---\n        if (mergeBtn && mainTextareaForNewFunc) {\n            mergeBtn.addEventListener('click', () => {\n                const text = mainTextareaForNewFunc.value;\n                if (!text) return;\n\n                const lines = text.split('\\n')\n                    .map(line => line.trim())\n                    .filter(line => line.length > 0);\n\n                if (lines.length <= 1) return;\n\n                let result = lines.map((line, index) => {\n                    if (index < lines.length - 1) { // Not the last line\n                        if (!/[.,?!:;]$/.test(line)) {\n                            return line + ',';\n                        }\n                    } else { // The very last line\n                        if (!/[.?!]$/.test(line)) {\n                            if (line.endsWith(',')) {\n                                return line.slice(0, -1) + '.';\n                            }\n                            return line + '.';\n                        }\n                    }\n                    return line;\n                }).join(' ');\n\n                mainTextareaForNewFunc.value = result;\n                mainTextareaForNewFunc.dispatchEvent(new Event('input', { 'bubbles': true }));\n            });\n        }\n\n\n        // --- 2. Batch Replace Functionality ---\n        if (pairsContainer && addPairBtn && executeReplaceBtn && mainTextareaForNewFunc) {\n            const STORAGE_KEY = 'DUC_LOI_REPLACE_PAIRS_V2';\n            const SETTINGS_KEY = 'DUC_LOI_REPLACE_SETTINGS_V1';\n\n            // T\u1ea1o container cho t\u00f9y ch\u1ecdn thay th\u1ebf\n            const replaceOptionsContainer = document.createElement('div');\n            replaceOptionsContainer.className = 'replace-options-container';\n            replaceOptionsContainer.style.cssText = `\n                margin-bottom: 15px;\n                padding: 10px;\n                background: linear-gradient(135deg, #44475a 0%, #2d3748 100%);\n                border: 1px solid rgba(98, 114, 164, 0.3);\n                border-radius: 8px;\n            `;\n            replaceOptionsContainer.innerHTML = `\n                <div style=\"display: flex; align-items: center; gap: 15px; flex-wrap: wrap;\">\n                    <label style=\"color: #f8f8f2; font-weight: bold; font-size: 14px;\">C\u00e1ch thay th\u1ebf:</label>\n                    <label style=\"display: flex; align-items: center; gap: 5px; color: #f8f8f2; cursor: pointer;\">\n                        <input type=\"radio\" name=\"replace-mode\" value=\"word\" id=\"replace-word-mode\" checked>\n                        <span>Thay th\u1ebf theo t\u1eeb</span>\n                    </label>\n                    <label style=\"display: flex; align-items: center; gap: 5px; color: #f8f8f2; cursor: pointer;\">\n                        <input type=\"radio\" name=\"replace-mode\" value=\"string\" id=\"replace-string-mode\">\n                        <span>Thay th\u1ebf theo k\u00fd t\u1ef1</span>\n                    </label>\n                </div>\n                <div style=\"margin-top: 8px; font-size: 12px; color: #94a3b8;\">\n                    <span id=\"replace-mode-description\">Thay th\u1ebf ch\u1ec9 khi l\u00e0 t\u1eeb ho\u00e0n ch\u1ec9nh (v\u00ed d\u1ee5: \"anh\" \u2192 \"em\" nh\u01b0ng \"thanh\" kh\u00f4ng \u0111\u1ed5i)</span>\n                </div>\n            `;\n\n            // Ch\u00e8n t\u00f9y ch\u1ecdn v\u00e0o tr\u01b0\u1edbc pairsContainer\n            pairsContainer.parentNode.insertBefore(replaceOptionsContainer, pairsContainer);\n\n            // L\u1ea5y c\u00e1c element t\u00f9y ch\u1ecdn\n            const wordModeRadio = document.getElementById('replace-word-mode');\n            const stringModeRadio = document.getElementById('replace-string-mode');\n            const modeDescription = document.getElementById('replace-mode-description');\n\n            // L\u01b0u c\u00e0i \u0111\u1eb7t\n            const saveSettings = () => {\n                const settings = {\n                    replaceMode: wordModeRadio.checked ? 'word' : 'string'\n                };\n                localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));\n            };\n\n            // T\u1ea3i c\u00e0i \u0111\u1eb7t\n            const loadSettings = () => {\n                const savedSettings = localStorage.getItem(SETTINGS_KEY);\n                if (savedSettings) {\n                    try {\n                        const settings = JSON.parse(savedSettings);\n                        if (settings.replaceMode === 'word') {\n                            wordModeRadio.checked = true;\n                        } else {\n                            stringModeRadio.checked = true;\n                        }\n                        updateModeDescription();\n                    } catch (e) {\n                        console.error(\"L\u1ed7i khi t\u1ea3i c\u00e0i \u0111\u1eb7t thay th\u1ebf:\", e);\n                    }\n                }\n            };\n\n            // C\u1eadp nh\u1eadt m\u00f4 t\u1ea3\n            const updateModeDescription = () => {\n                if (wordModeRadio.checked) {\n                    modeDescription.textContent = 'Thay th\u1ebf ch\u1ec9 khi l\u00e0 t\u1eeb ho\u00e0n ch\u1ec9nh (v\u00ed d\u1ee5: \"anh\" \u2192 \"em\" nh\u01b0ng \"thanh\" kh\u00f4ng \u0111\u1ed5i)';\n                } else {\n                    modeDescription.textContent = 'Thay th\u1ebf t\u1ea5t c\u1ea3 chu\u1ed7i t\u00ecm th\u1ea5y (v\u00ed d\u1ee5: \"anh\" \u2192 \"em\" trong c\u1ea3 \"thanh\")';\n                }\n            };\n\n            // Event listeners cho radio buttons\n            wordModeRadio.addEventListener('change', () => {\n                updateModeDescription();\n                saveSettings();\n            });\n            stringModeRadio.addEventListener('change', () => {\n                updateModeDescription();\n                saveSettings();\n            });\n\n            const savePairs = () => {\n                const pairs = [];\n                pairsContainer.querySelectorAll('.replace-pair-row').forEach(row => {\n                    const findInput = row.querySelector('.find-input');\n                    const replaceInput = row.querySelector('.replace-input');\n                    if (findInput.value || replaceInput.value) {\n                        pairs.push({ find: findInput.value, replace: replaceInput.value });\n                    }\n                });\n                localStorage.setItem(STORAGE_KEY, JSON.stringify(pairs));\n            };\n\n            const addPairRow = (findVal = '', replaceVal = '') => {\n                const row = document.createElement('div');\n                row.className = 'replace-pair-row';\n                const escapedFindVal = findVal.replace(/\"/g, '&quot;');\n                const escapedReplaceVal = replaceVal.replace(/\"/g, '&quot;');\n                row.innerHTML = `\n                    <input type=\"text\" class=\"find-input\" placeholder=\"T\u1eeb c\u1ea7n \u0111\u1ed5i\" value=\"${escapedFindVal}\">\n                    <input type=\"text\" class=\"replace-input\" placeholder=\"T\u1eeb thay th\u1ebf\" value=\"${escapedReplaceVal}\">\n                    <button class=\"remove-pair-btn\" title=\"X\u00f3a c\u1eb7p t\u1eeb\">\u00d7</button>\n                `;\n\n                row.querySelector('.remove-pair-btn').addEventListener('click', () => {\n                    row.remove();\n                    savePairs();\n                });\n\n                row.querySelectorAll('input').forEach(input => {\n                    input.addEventListener('input', savePairs);\n                });\n\n                pairsContainer.appendChild(row);\n            };\n\n            const loadPairs = () => {\n                const savedPairs = localStorage.getItem(STORAGE_KEY);\n                if (savedPairs) {\n                    try {\n                        const pairs = JSON.parse(savedPairs);\n                        if (Array.isArray(pairs)) {\n                            pairs.forEach(pair => addPairRow(pair.find, pair.replace));\n                        }\n                    } catch (e) {\n                        console.error(\"L\u1ed7i khi t\u1ea3i c\u1eb7p t\u1eeb \u0111\u00e3 l\u01b0u:\", e);\n                        localStorage.removeItem(STORAGE_KEY);\n                    }\n                }\n            };\n\n            addPairBtn.addEventListener('click', () => {\n                addPairRow();\n                const lastRow = pairsContainer.querySelector('.replace-pair-row:last-child');\n                if (lastRow) {\n                    lastRow.querySelector('.find-input').focus();\n                }\n            });\n\n            executeReplaceBtn.addEventListener('click', () => {\n                let currentText = mainTextareaForNewFunc.value;\n                if (!currentText) return;\n\n                const pairsToReplace = [];\n                pairsContainer.querySelectorAll('.replace-pair-row').forEach(row => {\n                     const findVal = row.querySelector('.find-input').value;\n                     const replaceVal = row.querySelector('.replace-input').value;\n                     if(findVal) {\n                         pairsToReplace.push({find: findVal, replace: replaceVal});\n                     }\n                });\n\n                const isWordMode = wordModeRadio.checked;\n\n                for(const pair of pairsToReplace) {\n                     let escapedFindVal = pair.find.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\n                     // N\u1ebfu l\u00e0 ch\u1ebf \u0111\u1ed9 thay th\u1ebf theo t\u1eeb, th\u00eam word boundary\n                     if (isWordMode) {\n                         escapedFindVal = '\\\\b' + escapedFindVal + '\\\\b';\n                     }\n\n                     const regex = new RegExp(escapedFindVal, 'g');\n                     currentText = currentText.replace(regex, pair.replace);\n                }\n\n                mainTextareaForNewFunc.value = currentText;\n                mainTextareaForNewFunc.dispatchEvent(new Event('input', { 'bubbles': true }));\n            });\n\n            // Kh\u1edfi t\u1ea1o\n            loadSettings();\n            loadPairs();\n\n            if (pairsContainer.childElementCount === 0) {\n                addPairRow();\n            }\n        }\n\n        // --- 2.5. Chunk Settings Functionality ---\n        (function() {\n            const CHUNK_SETTINGS_KEY = 'DUC_LOI_CHUNK_SETTINGS_V1';\n            const blankLineToggle = document.getElementById('enable-blank-line-chunking');\n\n            if (!blankLineToggle) return;\n\n            // L\u01b0u tr\u1ea1ng th\u00e1i c\u00f4ng t\u1eafc\n            const saveChunkSettings = () => {\n                const settings = {\n                    enableBlankLineChunking: blankLineToggle.checked\n                };\n                localStorage.setItem(CHUNK_SETTINGS_KEY, JSON.stringify(settings));\n            };\n\n            // T\u1ea3i tr\u1ea1ng th\u00e1i \u0111\u00e3 l\u01b0u\n            const loadChunkSettings = () => {\n                try {\n                    const savedSettings = localStorage.getItem(CHUNK_SETTINGS_KEY);\n                    if (savedSettings) {\n                        const settings = JSON.parse(savedSettings);\n                        blankLineToggle.checked = settings.enableBlankLineChunking === true; // M\u1eb7c \u0111\u1ecbnh l\u00e0 false\n                    } else {\n                        blankLineToggle.checked = false; // M\u1eb7c \u0111\u1ecbnh t\u1eaft\n                    }\n                } catch (e) {\n                    console.error(\"L\u1ed7i khi t\u1ea3i c\u00e0i \u0111\u1eb7t chunk:\", e);\n                    blankLineToggle.checked = false; // M\u1eb7c \u0111\u1ecbnh t\u1eaft\n                }\n            };\n\n            // L\u01b0u ngay khi thay \u0111\u1ed5i, kh\u00f4ng hi\u1ec7n c\u1ea3nh b\u00e1o\n            blankLineToggle.addEventListener('change', function() {\n                saveChunkSettings();\n            });\n\n            // Kh\u1edfi t\u1ea1o\n            loadChunkSettings();\n        })();\n\n        // --- 3. Punctuation Settings Functionality ---\n        function initializePunctuationSettings() {\n            const modal = document.getElementById('punctuation-settings-modal');\n            if (!modal) return;\n            const openBtn = document.getElementById('open-punctuation-settings-btn');\n            if (!openBtn) return;\n\n            const startQueueBtn = document.getElementById('gemini-start-queue-btn');\n            const applyPunctuationBtn = document.getElementById('apply-punctuation-btn');\n            const mainTextarea = document.getElementById('gemini-main-textarea');\n\n            // \u0110\u01a1n gi\u1ea3n: \u1ea9n n\u00fat khi b\u1ea5m \"T\u1ea1o \u00e2m thanh\"\n            if (startQueueBtn) {\n                startQueueBtn.addEventListener('click', function() {\n                    // \u1ea8n n\u00fat ngay khi b\u1ea5m\n                    startQueueBtn.style.display = 'none';\n                });\n            }\n            \n            // \u2b50 TAB SWITCHING LOGIC\n            const tabBtns = modal.querySelectorAll('.settings-tab-btn');\n            const tabContents = modal.querySelectorAll('.settings-tab-content');\n            \n            tabBtns.forEach(btn => {\n                btn.addEventListener('click', function() {\n                    const targetTab = this.getAttribute('data-tab');\n                    \n                    // Remove active class from all tabs\n                    tabBtns.forEach(b => {\n                        b.classList.remove('active');\n                        b.style.color = '#94a3b8';\n                        b.style.borderBottom = '3px solid transparent';\n                    });\n                    \n                    // Add active class to clicked tab\n                    this.classList.add('active');\n                    this.style.color = '#f8f8f2';\n                    this.style.borderBottom = '3px solid #bd93f9';\n                    \n                    // Hide all tab contents\n                    tabContents.forEach(content => {\n                        content.style.display = 'none';\n                    });\n                    \n                    // Show target tab content\n                    const targetContent = document.getElementById(targetTab);\n                    if (targetContent) {\n                        targetContent.style.display = 'block';\n                    }\n                });\n            });\n            \n            const closeBtn = modal.querySelector('.punctuation-modal-close-btn');\n            const saveBtn = document.getElementById('save-punctuation-settings-btn');\n            const defaultBtn = document.getElementById('default-punctuation-settings-btn');\n            const adjustBtns = modal.querySelectorAll('.adjust-btn');\n\n            const inputs = {\n                period: modal.querySelector('#pause-period'),\n                comma: modal.querySelector('#pause-comma'),\n                semicolon: modal.querySelector('#pause-semicolon'),\n                newline: modal.querySelector('#pause-newline')\n            };\n\n            const toggles = {\n                period: modal.querySelector('#toggle-period'),\n                comma: modal.querySelector('#toggle-comma'),\n                semicolon: modal.querySelector('#toggle-semicolon'),\n                newline: modal.querySelector('#toggle-newline')\n            };\n\n            const STORAGE_KEY = 'DUC_LOI_PUNCTUATION_SETTINGS_V2';\n            const DEFAULTS = {\n                period: 0.7,\n                comma: 0.3,\n                semicolon: 0.5,\n                newline: 0.5,\n                periodEnabled: false,\n                commaEnabled: false,\n                semicolonEnabled: false,\n                newlineEnabled: false\n            };\n\n            // C\u1ea3i ti\u1ebfn: \u0110\u1ecdc tr\u1ea1ng th\u00e1i tr\u1ef1c ti\u1ebfp t\u1eeb UI thay v\u00ec t\u1eeb localStorage\n            const checkPunctuationState = () => {\n                // \u0110\u1ecdc tr\u1ea1ng th\u00e1i B\u1eacT/T\u1eaeT tr\u1ef1c ti\u1ebfp t\u1eeb c\u00e1c checkbox tr\u00ean giao di\u1ec7n\n                const isAnyToggleActive = (toggles.period.checked && parseFloat(inputs.period.value) > 0) ||\n                                          (toggles.comma.checked && parseFloat(inputs.comma.value) > 0) ||\n                                          (toggles.semicolon.checked && parseFloat(inputs.semicolon.value) > 0) ||\n                                          (toggles.newline.checked && parseFloat(inputs.newline.value) > 0);\n\n                if (isAnyToggleActive) {\n                    startQueueBtn.style.display = 'none';\n                    applyPunctuationBtn.style.display = 'block';\n                } else {\n                    // Ki\u1ec3m tra xem c\u00f3 \u0111ang processing kh\u00f4ng (thay v\u00ec ki\u1ec3m tra style.display)\n                    if (!EfNjYNYj_O_CGB) {\n                        startQueueBtn.style.display = 'block';\n                        // Gi\u1eef nguy\u00ean disabled state (c\u00f3 th\u1ec3 disabled v\u00ec ch\u01b0a upload audio)\n                        // startQueueBtn.disabled = mainTextarea.value.trim() === '';\n                    }\n                    applyPunctuationBtn.style.display = 'none';\n                }\n            };\n\n            const openModal = () => {\n                loadSettings(); // Khi m\u1edf modal, t\u1ea3i c\u00e0i \u0111\u1eb7t \u0111\u00e3 l\u01b0u \u0111\u1ec3 hi\u1ec3n th\u1ecb\n                modal.style.display = 'flex';\n            };\n\n            const closeModal = () => {\n                modal.style.display = 'none';\n                loadSettings(); // T\u1ea3i l\u1ea1i c\u00e0i \u0111\u1eb7t \u0111\u00e3 l\u01b0u \u0111\u1ec3 h\u1ee7y c\u00e1c thay \u0111\u1ed5i ch\u01b0a l\u01b0u\n                checkPunctuationState();\n            };\n\n            const getSettingsFromStorage = () => {\n                try {\n                    const saved = localStorage.getItem(STORAGE_KEY);\n                    return saved ? JSON.parse(saved) : DEFAULTS;\n                } catch (e) {\n                    return DEFAULTS;\n                }\n            };\n\n            const loadSettings = () => {\n                const settings = getSettingsFromStorage();\n                Object.keys(settings).forEach(key => {\n                    if (key.endsWith('Enabled')) {\n                        const baseKey = key.replace('Enabled', '');\n                        if (toggles[baseKey]) toggles[baseKey].checked = settings[key];\n                    } else {\n                        if (inputs[key]) inputs[key].value = (settings[key] || 0).toFixed(1);\n                    }\n                });\n            };\n\n            const saveSettings = (shouldCloseModal = true) => {\n                const settingsToSave = {\n                    period: parseFloat(inputs.period.value) || 0,\n                    comma: parseFloat(inputs.comma.value) || 0,\n                    semicolon: parseFloat(inputs.semicolon.value) || 0,\n                    newline: parseFloat(inputs.newline.value) || 0,\n                    periodEnabled: toggles.period.checked,\n                    commaEnabled: toggles.comma.checked,\n                    semicolonEnabled: toggles.semicolon.checked,\n                    newlineEnabled: toggles.newline.checked\n                };\n                localStorage.setItem(STORAGE_KEY, JSON.stringify(settingsToSave));\n\n                if (shouldCloseModal) {\n                    closeModal();\n                    Swal.fire({ toast: true, position: 'top-end', icon: 'success', title: '\u0110\u00e3 l\u01b0u c\u00e0i \u0111\u1eb7t!', showConfirmButton: false, timer: 1500 });\n                }\n                checkPunctuationState();\n            };\n\n            const applyDefaults = () => {\n                Object.keys(DEFAULTS).forEach(key => {\n                    if (key.endsWith('Enabled')) {\n                        const baseKey = key.replace('Enabled', '');\n                        toggles[baseKey].checked = DEFAULTS[key];\n                    } else {\n                        inputs[key].value = DEFAULTS[key].toFixed(1);\n                    }\n                });\n                saveSettings(false);\n            };\n\n            const adjustValue = (e) => {\n                const targetId = e.target.dataset.target;\n                const step = parseFloat(e.target.dataset.step);\n                const input = document.getElementById(targetId);\n                if (input) {\n                    let currentValue = parseFloat(input.value) || 0;\n                    let newValue = Math.max(0, currentValue + step);\n                    input.value = newValue.toFixed(1);\n                    saveSettings(false);\n                }\n            };\n\n            applyPunctuationBtn.addEventListener('click', () => {\n                const settings = getSettingsFromStorage(); // L\u1ea5y c\u00e0i \u0111\u1eb7t \u0111\u00e3 l\u01b0u \u0111\u1ec3 \u00e1p d\u1ee5ng\n                let textToProcess = mainTextarea.value;\n                const mapDurationToPauseString = (seconds) => `<#${parseFloat(seconds).toFixed(1)}#>`;\n\n                // Lo\u1ea1i b\u1ecf h\u00e0m pause c\u0169 \u0111\u1ec3 tr\u00e1nh tr\u00f9ng l\u1eb7p\n                textToProcess = textToProcess.replace(/<#[0-9.]+#>/g, '');\n                // \u2b50 FIX: Ch\u1ec9 replace nhi\u1ec1u spaces, KH\u00d4NG replace xu\u1ed1ng d\u00f2ng\n                textToProcess = textToProcess.replace(/ {2,}/g, ' ');\n\n                // Thay th\u1ebf d\u1ea5u c\u00e2u \u0111\u00e3 thi\u1ebft l\u1eadp\n                // \u2b50 FIX: Ch\u1ec9 replace d\u1ea5u ch\u1ea5m/ph\u1ea9y KH\u00d4NG ph\u1ea3i s\u1ed1 th\u1eadp ph\u00e2n (29.5, 1,000)\n                if (settings.periodEnabled && settings.period > 0) {\n                    // Negative lookbehind/lookahead: Ch\u1ec9 replace d\u1ea5u ch\u1ea5m KH\u00d4NG n\u1eb1m gi\u1eefa 2 s\u1ed1\n                    textToProcess = textToProcess.replace(/(?<!\\d)\\.(?!\\d)/g, ` ${mapDurationToPauseString(settings.period)} `);\n                }\n                if (settings.commaEnabled && settings.comma > 0) {\n                    // Negative lookbehind/lookahead: Ch\u1ec9 replace d\u1ea5u ph\u1ea9y KH\u00d4NG n\u1eb1m gi\u1eefa 2 s\u1ed1 (\u0111\u1ec3 tr\u00e1nh 1,000 \u2192 1 (#0.3#) 000)\n                    textToProcess = textToProcess.replace(/(?<!\\d),(?!\\d)/g, ` ${mapDurationToPauseString(settings.comma)} `);\n                }\n                if (settings.semicolonEnabled && settings.semicolon > 0) textToProcess = textToProcess.replace(/;/g, ` ${mapDurationToPauseString(settings.semicolon)} `);\n                if (settings.newlineEnabled && settings.newline > 0) textToProcess = textToProcess.replace(/\\n/g, ` ${mapDurationToPauseString(settings.newline)} `);\n                // \u2b50 FIX: Ch\u1ec9 replace nhi\u1ec1u spaces, KH\u00d4NG replace xu\u1ed1ng d\u00f2ng\n                textToProcess = textToProcess.replace(/ {2,}/g, ' ');\n                mainTextarea.value = textToProcess;\n                mainTextarea.dispatchEvent(new Event('input', { bubbles: true }));\n\n                // C\u1ea3i ti\u1ebfn: T\u1eaft t\u1ea1m th\u1eddi c\u00e1c toggle tr\u00ean UI\n                Object.values(toggles).forEach(toggle => toggle.checked = false);\n\n                // B\u1ece \u0110I L\u1ec6NH L\u01afU, \u0111\u1ec3 kh\u00f4ng ghi \u0111\u00e8 c\u00e0i \u0111\u1eb7t g\u1ed1c c\u1ee7a ng\u01b0\u1eddi d\u00f9ng\n                // saveSettings(false); // <--- D\u00d2NG N\u00c0Y \u0110\u00c3 \u0110\u01af\u1ee2C X\u00d3A\n\n                // Hi\u1ec7n l\u1ea1i n\u00fat t\u1ea1o \u00e2m thanh sau khi \u00e1p d\u1ee5ng thi\u1ebft l\u1eadp\n                startQueueBtn.style.display = 'block';\n                // Disabled n\u1ebfu: ch\u01b0a c\u00f3 text HO\u1eb6C ch\u01b0a upload audio\n                const hasText = mainTextarea.value.trim() !== '';\n                const hasAudio = PcLAEW && PcLAEW.files && PcLAEW.files.length > 0;\n                startQueueBtn.disabled = !hasText || !hasAudio;\n                applyPunctuationBtn.style.display = 'none';\n\n                Swal.fire({ toast: true, position: 'top-end', icon: 'success', title: '\u0110\u00e3 \u00e1p d\u1ee5ng thi\u1ebft l\u1eadp v\u00e0o v\u0103n b\u1ea3n!', showConfirmButton: false, timer: 2000 });\n            });\n\n            // G\u1eafn c\u00e1c s\u1ef1 ki\u1ec7n\n            openBtn.addEventListener('click', openModal);\n            closeBtn.addEventListener('click', closeModal);\n            modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });\n            saveBtn.addEventListener('click', () => saveSettings(true));\n            defaultBtn.addEventListener('click', applyDefaults);\n            adjustBtns.forEach(btn => btn.addEventListener('click', adjustValue));\n\n            // Khi ng\u01b0\u1eddi d\u00f9ng thay \u0111\u1ed5i b\u1ea5t c\u1ee9 g\u00ec trong modal, s\u1ebd t\u1ef1 \u0111\u1ed9ng l\u01b0u l\u1ea1i\n            modal.addEventListener('change', () => saveSettings(false));\n            modal.addEventListener('input', () => saveSettings(false));\n\n            // Kh\u1edfi t\u1ea1o\n            loadSettings();\n            checkPunctuationState();\n        }\n\n        // G\u1ecdi h\u00e0m thi\u1ebft l\u1eadp d\u1ea5u c\u00e2u sau khi c\u00e1c element kh\u00e1c \u0111\u00e3 s\u1eb5n s\u00e0ng\n        initializePunctuationSettings();\n\n        // --- 4. Audio Folder Manager Functionality ---\n        (function() {\n            const folderSelectBtn = document.getElementById('folder-select-btn');\n            const selectedFolderPath = document.getElementById('selected-folder-path');\n            const audioListContainer = document.getElementById('audio-list-container');\n            const refreshBtn = document.getElementById('refresh-audio-list-btn');\n            let selectedFolderHandle = null;\n            let currentAudio = null;\n\n            // Storage keys\n            const STORAGE_KEYS = {\n                FOLDER_NAME: 'DUC_LOI_AUDIO_FOLDER_NAME_V1',\n                FOLDER_PATH: 'DUC_LOI_AUDIO_FOLDER_PATH_V1',\n                FILE_LIST: 'DUC_LOI_AUDIO_FILE_LIST_V1',\n                LAST_ACCESS: 'DUC_LOI_LAST_ACCESS_V1'\n            };\n\n            // Function to save folder info\n            function saveFolderInfo(folderName, folderPath) {\n                try {\n                    localStorage.setItem(STORAGE_KEYS.FOLDER_NAME, folderName);\n                    localStorage.setItem(STORAGE_KEYS.FOLDER_PATH, folderPath);\n                    localStorage.setItem(STORAGE_KEYS.LAST_ACCESS, Date.now().toString());\n                    console.log('\u0110\u00e3 l\u01b0u th\u00f4ng tin th\u01b0 m\u1ee5c:', folderName);\n                } catch (error) {\n                    console.error('Error saving folder info:', error);\n                }\n            }\n\n            // Function to save file list\n            function saveFileList(files) {\n                try {\n                    const fileListData = files.map(file => ({\n                        name: file.name,\n                        size: file.size,\n                        lastModified: file.lastModified,\n                        type: file.type\n                    }));\n                    localStorage.setItem(STORAGE_KEYS.FILE_LIST, JSON.stringify(fileListData));\n                } catch (error) {\n                    console.error('Error saving file list:', error);\n                }\n            }\n\n            // Function to load saved data\n            function loadSavedData() {\n                try {\n                    const savedFolderName = localStorage.getItem(STORAGE_KEYS.FOLDER_NAME);\n                    const savedFolderPath = localStorage.getItem(STORAGE_KEYS.FOLDER_PATH);\n                    const savedFileList = localStorage.getItem(STORAGE_KEYS.FILE_LIST);\n\n                    if (savedFolderName && savedFolderPath) {\n                        // Restore folder info display\n                        selectedFolderPath.textContent = `\ud83d\udcc1 ${savedFolderName} (\u0110\u00e3 l\u01b0u - Click \u0111\u1ec3 ch\u1ecdn l\u1ea1i)`;\n                        selectedFolderPath.style.display = 'block';\n                        audioListContainer.style.display = 'block';\n                        refreshBtn.style.display = 'block';\n\n                        // Show saved file list if available\n                        if (savedFileList) {\n                            try {\n                                const fileListData = JSON.parse(savedFileList);\n                                displaySavedFileList(fileListData);\n                            } catch (error) {\n                                console.error('Error parsing saved file list:', error);\n                            }\n                        }\n\n                        return { folderName: savedFolderName, folderPath: savedFolderPath };\n                    }\n                } catch (error) {\n                    console.error('Error loading saved data:', error);\n                }\n                return null;\n            }\n\n            // Function to display saved file list\n            function displaySavedFileList(fileListData) {\n                audioListContainer.innerHTML = '';\n\n                if (fileListData.length === 0) {\n                    audioListContainer.innerHTML = '<div style=\"padding: 10px; text-align: center; color: #94a3b8;\">Kh\u00f4ng c\u00f3 file MP3 n\u00e0o</div>';\n                    return;\n                }\n\n                fileListData.forEach((fileData, index) => {\n                    const item = document.createElement('div');\n                    item.className = 'audio-item';\n                    item.dataset.index = index;\n\n                    const name = document.createElement('div');\n                    name.className = 'audio-name';\n                    name.textContent = fileData.name;\n\n                    const duration = document.createElement('div');\n                    duration.className = 'audio-duration';\n                    duration.textContent = '--:--';\n\n                    const playBtn = document.createElement('button');\n                    playBtn.className = 'play-btn';\n                    playBtn.textContent = '\u25b6';\n                    playBtn.title = 'Ph\u00e1t \u00e2m thanh';\n                    playBtn.disabled = true; // Disabled for saved files\n\n                    const uploadBtn = document.createElement('button');\n                    uploadBtn.className = 'play-btn';\n                    uploadBtn.textContent = '\ud83d\udce4';\n                    uploadBtn.title = 'T\u1ea3i file l\u00ean';\n                    uploadBtn.style.marginLeft = '5px';\n                    uploadBtn.disabled = true; // Disabled for saved files\n\n                    const statusText = document.createElement('div');\n                    statusText.className = 'audio-duration';\n                    statusText.textContent = '\u0110\u00e3 l\u01b0u';\n                    statusText.style.color = '#50fa7b';\n                    statusText.style.fontSize = '10px';\n\n                    item.appendChild(name);\n                    item.appendChild(duration);\n                    item.appendChild(playBtn);\n                    item.appendChild(uploadBtn);\n                    item.appendChild(statusText);\n\n                    audioListContainer.appendChild(item);\n                });\n\n                // Show info message\n                const infoDiv = document.createElement('div');\n                infoDiv.style.cssText = 'padding: 8px; text-align: center; color: #8be9fd; font-size: 12px; background: #44475a; border-radius: 4px; margin-bottom: 10px;';\n                infoDiv.innerHTML = '\ud83d\udcc1 <strong>D\u1eef li\u1ec7u \u0111\u00e3 l\u01b0u t\u1ef1 \u0111\u1ed9ng</strong><br/>\ud83d\udca1 Tool s\u1ebd nh\u1edb th\u01b0 m\u1ee5c n\u00e0y khi b\u1ea1n t\u1eaft/kh\u1edfi \u0111\u1ed9ng l\u1ea1i<br/>\ud83d\udd04 Click v\u00e0o t\u00ean th\u01b0 m\u1ee5c \u0111\u1ec3 ch\u1ecdn l\u1ea1i';\n                audioListContainer.insertBefore(infoDiv, audioListContainer.firstChild);\n            }\n\n            // Function to format duration\n            function formatDuration(seconds) {\n                const mins = Math.floor(seconds / 60);\n                const secs = Math.floor(seconds % 60);\n                return `${mins}:${secs.toString().padStart(2, '0')}`;\n            }\n\n            // Function to get audio duration\n            function getAudioDuration(file) {\n                return new Promise((resolve) => {\n                    const audio = new Audio();\n                    audio.addEventListener('loadedmetadata', () => {\n                        resolve(audio.duration);\n                    });\n                    audio.addEventListener('error', () => {\n                        resolve(0);\n                    });\n                    audio.src = URL.createObjectURL(file);\n                });\n            }\n\n            // Function to create audio item\n            function createAudioItem(file, index) {\n                const item = document.createElement('div');\n                item.className = 'audio-item';\n                item.dataset.index = index;\n\n                const name = document.createElement('div');\n                name.className = 'audio-name';\n                name.textContent = file.name;\n\n                const duration = document.createElement('div');\n                duration.className = 'audio-duration';\n                duration.textContent = '--:--';\n\n                const playBtn = document.createElement('button');\n                playBtn.className = 'play-btn';\n                playBtn.textContent = '\u25b6';\n                playBtn.title = 'Ph\u00e1t \u00e2m thanh';\n\n                const uploadBtn = document.createElement('button');\n                uploadBtn.className = 'play-btn';\n                uploadBtn.textContent = '\ud83d\udce4';\n                uploadBtn.title = 'T\u1ea3i file l\u00ean';\n                uploadBtn.style.marginLeft = '5px';\n\n                item.appendChild(name);\n                item.appendChild(duration);\n                item.appendChild(playBtn);\n                item.appendChild(uploadBtn);\n\n                // Get duration and validate\n                getAudioDuration(file).then(dur => {\n                    duration.textContent = formatDuration(dur);\n                    \n                    // Store duration in dataset for validation\n                    item.dataset.duration = dur;\n                    \n                    // Visual indicator for invalid duration\n                    if (dur < 20 || dur > 60) {\n                        item.style.backgroundColor = 'rgba(248, 113, 113, 0.1)';\n                        item.style.borderLeft = '3px solid #f87171';\n                        duration.style.color = '#f87171';\n                        duration.style.fontWeight = 'bold';\n                        uploadBtn.style.opacity = '0.5';\n                        uploadBtn.title = '\u26a0\ufe0f Audio kh\u00f4ng h\u1ee3p l\u1ec7 (20-60s)';\n                        \n                        // Add warning icon\n                        const warningIcon = document.createElement('span');\n                        warningIcon.textContent = '\u26a0\ufe0f';\n                        warningIcon.style.color = '#f87171';\n                        warningIcon.style.marginLeft = '5px';\n                        warningIcon.title = `Audio ph\u1ea3i t\u1eeb 20-60 gi\u00e2y (hi\u1ec7n t\u1ea1i: ${Math.floor(dur)}s)`;\n                        duration.appendChild(warningIcon);\n                    } else {\n                        item.style.backgroundColor = 'rgba(80, 250, 123, 0.05)';\n                        item.style.borderLeft = '3px solid #50fa7b';\n                        duration.style.color = '#50fa7b';\n                        uploadBtn.title = '\u2705 T\u1ea3i file l\u00ean (\u0111\u1ed9 d\u00e0i h\u1ee3p l\u1ec7)';\n                    }\n                });\n\n                // Play/pause functionality\n                playBtn.addEventListener('click', (e) => {\n                    e.stopPropagation();\n                    if (currentAudio && currentAudio.paused === false) {\n                        currentAudio.pause();\n                        document.querySelectorAll('.audio-item.playing').forEach(el => {\n                            el.classList.remove('playing');\n                            el.querySelector('.play-btn').textContent = '\u25b6';\n                        });\n                        return;\n                    }\n\n                    // Stop current audio\n                    if (currentAudio) {\n                        currentAudio.pause();\n                        currentAudio = null;\n                    }\n\n                    // Play new audio\n                    const audio = new Audio(URL.createObjectURL(file));\n                    currentAudio = audio;\n\n                    document.querySelectorAll('.audio-item.playing').forEach(el => {\n                        el.classList.remove('playing');\n                        el.querySelector('.play-btn').textContent = '\u25b6';\n                    });\n\n                    item.classList.add('playing');\n                    playBtn.textContent = '\u23f8';\n\n                    audio.addEventListener('ended', () => {\n                        item.classList.remove('playing');\n                        playBtn.textContent = '\u25b6';\n                        currentAudio = null;\n                    });\n\n                    audio.addEventListener('pause', () => {\n                        item.classList.remove('playing');\n                        playBtn.textContent = '\u25b6';\n                    });\n\n                    audio.play().catch(console.error);\n                });\n\n                // Upload button functionality\n                uploadBtn.addEventListener('click', async (e) => {\n                    e.stopPropagation();\n\n                    addLogEntry('\ud83d\udd0d [DEBUG] Upload button clicked!', 'info');\n                    addLogEntry(`\ud83d\udd0d [DEBUG] File name: ${file.name}`, 'info');\n                    addLogEntry(`\ud83d\udd0d [DEBUG] item.dataset.duration: ${item.dataset.duration}`, 'info');\n\n                    // Check if duration is available\n                    if (!item.dataset.duration || item.dataset.duration === 'undefined') {\n                        addLogEntry('\u26a0\ufe0f [DEBUG] Duration not ready yet, fetching...', 'warning');\n                        \n                        // Show loading message\n                        Swal.fire({\n                            title: '\u0110ang ki\u1ec3m tra \u0111\u1ed9 d\u00e0i audio...',\n                            text: 'Vui l\u00f2ng ch\u1edd...',\n                            icon: 'info',\n                            allowOutsideClick: false,\n                            showConfirmButton: false,\n                            didOpen: () => {\n                                Swal.showLoading();\n                            }\n                        });\n                        \n                        // Get duration now\n                        const dur = await getAudioDuration(file);\n                        item.dataset.duration = dur;\n                        addLogEntry(`\u2705 [DEBUG] Duration fetched: ${dur} seconds`, 'success');\n                        \n                        Swal.close();\n                    }\n\n                    // Validate audio duration before upload\n                    const audioDuration = parseFloat(item.dataset.duration);\n                    \n                    addLogEntry(`\ud83d\udd0d [DEBUG] Parsed audioDuration: ${audioDuration}`, 'info');\n                    addLogEntry(`\ud83d\udd0d [DEBUG] Is valid (20-60)? ${audioDuration >= 20 && audioDuration <= 60}`, 'info');\n                    \n                    // CRITICAL: Check if duration is invalid\n                    if (!audioDuration || audioDuration < 20 || audioDuration > 60) {\n                        // Block upload and show error\n                        let errorMessage = '';\n                        let details = '';\n                        \n                        if (!audioDuration || audioDuration === 0) {\n                            errorMessage = `Kh\u00f4ng th\u1ec3 x\u00e1c \u0111\u1ecbnh \u0111\u1ed9 d\u00e0i audio.`;\n                            details = 'File c\u00f3 th\u1ec3 b\u1ecb l\u1ed7i ho\u1eb7c kh\u00f4ng ph\u1ea3i file audio h\u1ee3p l\u1ec7.';\n                        } else if (audioDuration < 20) {\n                            errorMessage = `Audio qu\u00e1 ng\u1eafn: ${Math.floor(audioDuration)} gi\u00e2y`;\n                            details = `C\u1ea7n t\u1ed1i thi\u1ec3u 20 gi\u00e2y.`;\n                        } else {\n                            errorMessage = `Audio qu\u00e1 d\u00e0i: ${Math.floor(audioDuration)} gi\u00e2y`;\n                            details = `T\u1ed1i \u0111a 60 gi\u00e2y (1 ph\u00fat).`;\n                        }\n                        \n                        addLogEntry('\u274c [DEBUG] VALIDATION FAILED!', 'error');\n                        addLogEntry(`\u274c [DEBUG] Reason: ${errorMessage}`, 'error');\n                        \n                        Swal.fire({\n                            icon: 'error',\n                            title: '\u26a0\ufe0f Audio kh\u00f4ng h\u1ee3p l\u1ec7',\n                            html: `\n                                <div style=\"text-align: left; padding: 15px;\">\n                                    <div style=\"background: rgba(248, 113, 113, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 4px solid #f87171;\">\n                                        <p style=\"margin: 0; font-weight: bold; color: #f87171;\">\u274c ${errorMessage}</p>\n                                        <p style=\"margin: 5px 0 0 0; font-size: 13px; color: #fca5a5;\">${details}</p>\n                                    </div>\n                                    \n                                    <hr style=\"border-color: rgba(255,255,255,0.1); margin: 15px 0;\">\n                                    \n                                    <div style=\"background: rgba(139, 233, 253, 0.1); padding: 12px; border-radius: 6px; border-left: 4px solid #8be9fd;\">\n                                        <p style=\"margin: 0 0 8px 0; font-weight: bold;\">\ud83d\udccc Y\u00eau c\u1ea7u:</p>\n                                        <ul style=\"margin: 0; padding-left: 20px;\">\n                                            <li style=\"margin: 5px 0;\">\u0110\u1ed9 d\u00e0i: <strong style=\"color: #50fa7b;\">20-60 gi\u00e2y</strong></li>\n                                            <li style=\"margin: 5px 0;\">Hi\u1ec7n t\u1ea1i: <strong style=\"color: #f87171;\">${audioDuration ? Math.floor(audioDuration) : '???'} gi\u00e2y</strong></li>\n                                            <li style=\"margin: 5px 0;\">File: <code style=\"background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px;\">${file.name}</code></li>\n                                        </ul>\n                                    </div>\n                                    \n                                    <p style=\"margin-top: 15px; color: #8be9fd; font-size: 13px;\">\n                                        \ud83d\udca1 <strong>Gi\u1ea3i ph\u00e1p:</strong> Ch\u1ecdn file audio kh\u00e1c ho\u1eb7c c\u1eaft/ch\u1ec9nh s\u1eeda file n\u00e0y v\u1ec1 20-60 gi\u00e2y.\n                                    </p>\n                                </div>\n                            `,\n                            confirmButtonText: '\u0110\u00e3 hi\u1ec3u',\n                            confirmButtonColor: '#8be9fd',\n                            background: '#282a36',\n                            color: '#f8f8f2',\n                            width: '600px'\n                        });\n                        \n                        addLogEntry('\ud83d\udeab [DEBUG] Upload BLOCKED!', 'error');\n                        return; // Stop upload\n                    }\n\n                    addLogEntry('\u2705 [DEBUG] Validation PASSED! Proceeding with upload...', 'success');\n\n                    // Auto-upload the selected file (only if valid)\n                    try {\n                        const fileInput = document.getElementById('gemini-file-input');\n                        if (fileInput) {\n                            // Create a new FileList with the selected file\n                            const dataTransfer = new DataTransfer();\n                            dataTransfer.items.add(file);\n                            fileInput.files = dataTransfer.files;\n\n                            // Trigger the change event to simulate file selection\n                            fileInput.dispatchEvent(new Event('change', { bubbles: true }));\n\n                            addLogEntry('\u2705 [DEBUG] File uploaded successfully!', 'success');\n\n                            // Show success message\n                            Swal.fire({\n                                toast: true,\n                                position: 'top-end',\n                                icon: 'success',\n                                title: '\u2705 \u0110\u00e3 t\u1ea3i file \u00e2m thanh',\n                                text: `File \"${file.name}\" (${Math.floor(audioDuration)}s) \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea3i l\u00ean!`,\n                                showConfirmButton: false,\n                                timer: 2500,\n                                timerProgressBar: true,\n                            });\n                        }\n                    } catch (error) {\n                        addLogEntry(`\u274c [DEBUG] Error during upload: ${error.message}`, 'error');\n                        Swal.fire({\n                            toast: true,\n                            position: 'top-end',\n                            icon: 'error',\n                            title: 'L\u1ed7i t\u1ea3i file',\n                            text: 'Kh\u00f4ng th\u1ec3 t\u1ef1 \u0111\u1ed9ng t\u1ea3i file. Vui l\u00f2ng th\u1eed l\u1ea1i.',\n                            showConfirmButton: false,\n                            timer: 2000,\n                            timerProgressBar: true,\n                        });\n                    }\n                });\n\n                // Click to play only\n                item.addEventListener('click', () => {\n                    playBtn.click();\n                });\n\n                return item;\n            }\n\n            // Function to update audio list\n            async function updateAudioList() {\n                if (!selectedFolderHandle) return;\n\n                try {\n                    const files = [];\n                    for await (const [name, handle] of selectedFolderHandle.entries()) {\n                        if (handle.kind === 'file' && name.toLowerCase().endsWith('.mp3')) {\n                            const file = await handle.getFile();\n                            files.push(file);\n                        }\n                    }\n\n                    // Save file list to localStorage\n                    saveFileList(files);\n\n                    audioListContainer.innerHTML = '';\n\n                    if (files.length === 0) {\n                        audioListContainer.innerHTML = '<div style=\"padding: 10px; text-align: center; color: #94a3b8;\">Kh\u00f4ng t\u00ecm th\u1ea5y file MP3 n\u00e0o</div>';\n                    } else {\n                        // Create summary header placeholder\n                        const summaryDiv = document.createElement('div');\n                        summaryDiv.id = 'audio-summary';\n                        summaryDiv.style.cssText = 'padding: 12px; margin-bottom: 10px; background: rgba(139, 233, 253, 0.1); border-radius: 6px; border-left: 4px solid #8be9fd; font-size: 12px;';\n                        summaryDiv.innerHTML = '\ud83d\udcca \u0110ang ki\u1ec3m tra \u0111\u1ed9 d\u00e0i audio...';\n                        audioListContainer.appendChild(summaryDiv);\n                        \n                        // Add files to list\n                        const filePromises = [];\n                        files.forEach((file, index) => {\n                            const item = createAudioItem(file, index);\n                            audioListContainer.appendChild(item);\n                            \n                            // Store promise to get duration\n                            filePromises.push(getAudioDuration(file));\n                        });\n                        \n                        // Wait for all durations and update summary\n                        Promise.all(filePromises).then(durations => {\n                            const validFiles = durations.filter(d => d >= 20 && d <= 60).length;\n                            const invalidFiles = durations.length - validFiles;\n                            \n                            let summaryHtml = `\n                                <div style=\"display: flex; justify-content: space-between; align-items: center; gap: 15px;\">\n                                    <div style=\"flex: 1;\">\n                                        <strong>\ud83d\udcca T\u1ed5ng quan:</strong> ${files.length} file\n                                    </div>\n                                    <div style=\"flex: 1; text-align: center;\">\n                                        <span style=\"color: #50fa7b; font-weight: bold;\">\u2705 ${validFiles}</span> h\u1ee3p l\u1ec7\n                                    </div>\n                                    <div style=\"flex: 1; text-align: right;\">\n                                        <span style=\"color: #f87171; font-weight: bold;\">\u26a0\ufe0f ${invalidFiles}</span> kh\u00f4ng h\u1ee3p l\u1ec7\n                                    </div>\n                                </div>\n                            `;\n                            \n                            if (invalidFiles > 0) {\n                                summaryHtml += `\n                                    <div style=\"margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); color: #f87171; font-size: 11px;\">\n                                        \ud83d\udca1 <strong>${invalidFiles} file</strong> kh\u00f4ng th\u1ec3 upload v\u00ec \u0111\u1ed9 d\u00e0i kh\u00f4ng ph\u1ea3i 20-60 gi\u00e2y\n                                    </div>\n                                `;\n                            }\n                            \n                            summaryDiv.innerHTML = summaryHtml;\n                        });\n                    }\n                } catch (error) {\n                    console.error('Error reading folder:', error);\n                    audioListContainer.innerHTML = '<div style=\"padding: 10px; text-align: center; color: #f87171;\">L\u1ed7i khi \u0111\u1ecdc th\u01b0 m\u1ee5c</div>';\n                }\n            }\n\n            // Folder selection\n            if (folderSelectBtn) {\n                folderSelectBtn.addEventListener('click', async () => {\n                    try {\n                        // Check if File System Access API is supported\n                        if ('showDirectoryPicker' in window) {\n                            selectedFolderHandle = await window.showDirectoryPicker();\n                            selectedFolderPath.textContent = `\ud83d\udcc1 ${selectedFolderHandle.name}`;\n                            selectedFolderPath.style.display = 'block';\n                            audioListContainer.style.display = 'block';\n                            refreshBtn.style.display = 'block';\n\n                            // Save folder info to localStorage\n                            saveFolderInfo(selectedFolderHandle.name, selectedFolderHandle.name);\n\n                            await updateAudioList();\n\n                            // Show success message\n                            Swal.fire({\n                                toast: true,\n                                position: 'top-end',\n                                icon: 'success',\n                                title: '\u0110\u00e3 ch\u1ecdn th\u01b0 m\u1ee5c',\n                                text: `Th\u01b0 m\u1ee5c \"${selectedFolderHandle.name}\" \u0111\u00e3 \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0 l\u01b0u t\u1ef1 \u0111\u1ed9ng`,\n                                showConfirmButton: false,\n                                timer: 2000,\n                                timerProgressBar: true,\n                            });\n\n                            // Auto-refresh every 5 seconds\n                            setInterval(updateAudioList, 5000);\n                        } else {\n                            // Fallback for browsers that don't support File System Access API\n                            Swal.fire({\n                                icon: 'warning',\n                                title: 'Tr\u00ecnh duy\u1ec7t kh\u00f4ng h\u1ed7 tr\u1ee3',\n                                text: 'Tr\u00ecnh duy\u1ec7t c\u1ee7a b\u1ea1n kh\u00f4ng h\u1ed7 tr\u1ee3 t\u00ednh n\u0103ng ch\u1ecdn th\u01b0 m\u1ee5c. Vui l\u00f2ng s\u1eed d\u1ee5ng Chrome, Edge ho\u1eb7c Opera m\u1edbi nh\u1ea5t.',\n                                confirmButtonText: 'OK'\n                            });\n                        }\n                    } catch (error) {\n                        if (error.name !== 'AbortError') {\n                            console.error('Error selecting folder:', error);\n                            Swal.fire({\n                                icon: 'error',\n                                title: 'L\u1ed7i',\n                                text: 'Kh\u00f4ng th\u1ec3 ch\u1ecdn th\u01b0 m\u1ee5c. Vui l\u00f2ng th\u1eed l\u1ea1i.',\n                                confirmButtonText: 'OK'\n                            });\n                        }\n                    }\n                });\n            }\n\n            // Refresh button\n            if (refreshBtn) {\n                refreshBtn.addEventListener('click', updateAudioList);\n            }\n\n            // Add connect to saved folder button\n            const connectSavedBtn = document.createElement('button');\n            connectSavedBtn.id = 'connect-saved-folder-btn';\n            connectSavedBtn.textContent = '\ud83d\udd17 K\u1ebft n\u1ed1i th\u01b0 m\u1ee5c \u0111\u00e3 l\u01b0u';\n            connectSavedBtn.style.cssText = 'background-color:#50fa7b;color:#282a36;padding:8px 12px;border:none;border-radius:4px;cursor:pointer;font-size:12px;margin-top:5px;width:100%;font-weight:bold';\n            connectSavedBtn.title = 'K\u1ebft n\u1ed1i \u0111\u1ebfn th\u01b0 m\u1ee5c \u0111\u00e3 l\u01b0u tr\u01b0\u1edbc \u0111\u00f3';\n            connectSavedBtn.style.display = 'none'; // Hidden by default\n\n            // Add click handler for connect button\n            connectSavedBtn.addEventListener('click', async () => {\n                if (!('showDirectoryPicker' in window)) {\n                    Swal.fire({\n                        icon: 'warning',\n                        title: 'Tr\u00ecnh duy\u1ec7t kh\u00f4ng h\u1ed7 tr\u1ee3',\n                        text: 'Tr\u00ecnh duy\u1ec7t c\u1ee7a b\u1ea1n kh\u00f4ng h\u1ed7 tr\u1ee3 t\u00ednh n\u0103ng ch\u1ecdn th\u01b0 m\u1ee5c. Vui l\u00f2ng s\u1eed d\u1ee5ng Chrome, Edge ho\u1eb7c Opera m\u1edbi nh\u1ea5t.',\n                        confirmButtonText: 'OK'\n                    });\n                    return;\n                }\n\n                try {\n                    // Show loading\n                    Swal.fire({\n                        title: '\u0110ang k\u1ebft n\u1ed1i...',\n                        text: 'Vui l\u00f2ng ch\u1ecdn th\u01b0 m\u1ee5c trong c\u1eeda s\u1ed5 m\u1edbi m\u1edf',\n                        icon: 'info',\n                        allowOutsideClick: false,\n                        showConfirmButton: false,\n                        timer: 10000,\n                        timerProgressBar: true\n                    });\n\n                    // Open directory picker\n                    selectedFolderHandle = await window.showDirectoryPicker();\n\n                    // Update display\n                    selectedFolderPath.textContent = `\ud83d\udcc1 ${selectedFolderHandle.name}`;\n\n                    // Save folder info\n                    saveFolderInfo(selectedFolderHandle.name, selectedFolderHandle.name);\n\n                    // Update audio list\n                    await updateAudioList();\n\n                    // Show success\n                    Swal.fire({\n                        toast: true,\n                        position: 'top-end',\n                        icon: 'success',\n                        title: '\u2705 \u0110\u00e3 k\u1ebft n\u1ed1i th\u00e0nh c\u00f4ng!',\n                        text: `Th\u01b0 m\u1ee5c \"${selectedFolderHandle.name}\" \u0111\u00e3 s\u1eb5n s\u00e0ng s\u1eed d\u1ee5ng`,\n                        showConfirmButton: false,\n                        timer: 3000,\n                        timerProgressBar: true,\n                    });\n\n                } catch (error) {\n                    if (error.name !== 'AbortError') {\n                        console.error('Error connecting to folder:', error);\n                        Swal.fire({\n                            icon: 'error',\n                            title: 'L\u1ed7i k\u1ebft n\u1ed1i',\n                            text: 'Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ebfn th\u01b0 m\u1ee5c. Vui l\u00f2ng th\u1eed l\u1ea1i.',\n                            confirmButtonText: 'OK'\n                        });\n                    } else {\n                        // User cancelled\n                        Swal.fire({\n                            toast: true,\n                            position: 'top-end',\n                            icon: 'info',\n                            title: '\u0110\u00e3 h\u1ee7y',\n                            text: 'B\u1ea1n c\u00f3 th\u1ec3 click n\u00fat \"K\u1ebft n\u1ed1i th\u01b0 m\u1ee5c \u0111\u00e3 l\u01b0u\" \u0111\u1ec3 th\u1eed l\u1ea1i',\n                            showConfirmButton: false,\n                            timer: 2000,\n                            timerProgressBar: true,\n                        });\n                    }\n                }\n            });\n\n            // Insert connect button after refresh button\n            if (refreshBtn && refreshBtn.parentNode) {\n                refreshBtn.parentNode.insertBefore(connectSavedBtn, refreshBtn.nextSibling);\n            }\n\n            // Add click handler to restore folder from saved data\n            if (selectedFolderPath) {\n                selectedFolderPath.addEventListener('click', async () => {\n                    if (!('showDirectoryPicker' in window)) {\n                        Swal.fire({\n                            icon: 'warning',\n                            title: 'Tr\u00ecnh duy\u1ec7t kh\u00f4ng h\u1ed7 tr\u1ee3',\n                            text: 'Tr\u00ecnh duy\u1ec7t c\u1ee7a b\u1ea1n kh\u00f4ng h\u1ed7 tr\u1ee3 t\u00ednh n\u0103ng ch\u1ecdn th\u01b0 m\u1ee5c. Vui l\u00f2ng s\u1eed d\u1ee5ng Chrome, Edge ho\u1eb7c Opera m\u1edbi nh\u1ea5t.',\n                            confirmButtonText: 'OK'\n                        });\n                        return;\n                    }\n\n                    try {\n                        // Show loading message\n                        Swal.fire({\n                            title: '\u0110ang m\u1edf th\u01b0 m\u1ee5c...',\n                            text: 'Vui l\u00f2ng ch\u1ecdn th\u01b0 m\u1ee5c trong c\u1eeda s\u1ed5 m\u1edbi m\u1edf',\n                            icon: 'info',\n                            allowOutsideClick: false,\n                            showConfirmButton: false,\n                            timer: 5000,\n                            timerProgressBar: true\n                        });\n\n                        // Open directory picker\n                        selectedFolderHandle = await window.showDirectoryPicker();\n\n                        // Update display\n                        selectedFolderPath.textContent = `\ud83d\udcc1 ${selectedFolderHandle.name}`;\n\n                        // Save new folder info\n                        saveFolderInfo(selectedFolderHandle.name, selectedFolderHandle.name);\n\n                        // Update audio list\n                        await updateAudioList();\n\n                        // Show success message\n                        Swal.fire({\n                            toast: true,\n                            position: 'top-end',\n                            icon: 'success',\n                            title: '\u2705 \u0110\u00e3 kh\u00f4i ph\u1ee5c th\u01b0 m\u1ee5c!',\n                            text: `Th\u01b0 m\u1ee5c \"${selectedFolderHandle.name}\" \u0111\u00e3 s\u1eb5n s\u00e0ng s\u1eed d\u1ee5ng`,\n                            showConfirmButton: false,\n                            timer: 3000,\n                            timerProgressBar: true,\n                        });\n\n                    } catch (error) {\n                        if (error.name !== 'AbortError') {\n                            console.error('Error selecting folder:', error);\n                            Swal.fire({\n                                icon: 'error',\n                                title: 'L\u1ed7i ch\u1ecdn th\u01b0 m\u1ee5c',\n                                text: 'Kh\u00f4ng th\u1ec3 ch\u1ecdn th\u01b0 m\u1ee5c. Vui l\u00f2ng th\u1eed l\u1ea1i.',\n                                confirmButtonText: 'OK'\n                            });\n                        } else {\n                            // User cancelled, show info\n                            Swal.fire({\n                                toast: true,\n                                position: 'top-end',\n                                icon: 'info',\n                                title: '\u0110\u00e3 h\u1ee7y',\n                                text: 'B\u1ea1n c\u00f3 th\u1ec3 click v\u00e0o t\u00ean th\u01b0 m\u1ee5c \u0111\u1ec3 ch\u1ecdn l\u1ea1i b\u1ea5t c\u1ee9 l\u00fac n\u00e0o',\n                                showConfirmButton: false,\n                                timer: 2000,\n                                timerProgressBar: true,\n                            });\n                        }\n                    }\n                });\n\n                // Add cursor pointer style and hover effect\n                selectedFolderPath.style.cursor = 'pointer';\n                selectedFolderPath.style.transition = 'all 0.2s ease';\n                selectedFolderPath.title = 'Click \u0111\u1ec3 ch\u1ecdn l\u1ea1i th\u01b0 m\u1ee5c v\u00e0 kh\u00f4i ph\u1ee5c quy\u1ec1n truy c\u1eadp';\n\n                // Add hover effect\n                selectedFolderPath.addEventListener('mouseenter', () => {\n                    selectedFolderPath.style.backgroundColor = '#44475a';\n                    selectedFolderPath.style.borderRadius = '4px';\n                    selectedFolderPath.style.padding = '4px 8px';\n                });\n\n                selectedFolderPath.addEventListener('mouseleave', () => {\n                    selectedFolderPath.style.backgroundColor = 'transparent';\n                    selectedFolderPath.style.borderRadius = '0';\n                    selectedFolderPath.style.padding = '0';\n                });\n            }\n\n            // Load saved data on page load\n            const savedData = loadSavedData();\n            if (savedData) {\n                connectSavedBtn.style.display = 'block';\n                console.log('Restored saved folder:', savedData.folderName);\n            }\n        })();\n\n        // --- 5. Punctuation Detection Functionality ---\n        (function() {\n            let punctuationDetectionEnabled = true;\n            let detectedPunctuationIssues = [];\n\n            // H\u00e0m ph\u00e1t hi\u1ec7n d\u1ea5u c\u00e2u tr\u00f9ng l\u1eb7p\n            // H\u00e0m ph\u00e1t hi\u1ec7n c\u00e1c t\u1eeb Ti\u1ebfng Vi\u1ec7t c\u1ea7n s\u1eeda (ai, im)\n            function detectVietnameseWordIssues(text) {\n                // Ch\u1ec9 detect khi language = Ti\u1ebfng Vi\u1ec7t\n                const languageSelect = document.getElementById('gemini-language-select');\n                if (!languageSelect) return [];\n                \n                const selectedLanguage = languageSelect.value.toLowerCase();\n                \n                // Check n\u1ebfu KH\u00d4NG ph\u1ea3i Ti\u1ebfng Vi\u1ec7t \u2192 kh\u00f4ng detect\n                if (!selectedLanguage.includes('vi\u1ec7t') && !selectedLanguage.includes('viet') && !selectedLanguage.includes('vietnamese')) {\n                    return [];\n                }\n                \n                const issues = [];\n                \n                // Detect \"ai\" (word boundary)\n                const aiPattern = /\\bai\\b/gi;\n                let match;\n                \n                while ((match = aiPattern.exec(text)) !== null) {\n                    // Ch\u1ec9 b\u00e1o l\u1ed7i n\u1ebfu l\u00e0 ch\u1eef th\u01b0\u1eddng \"ai\" (kh\u00f4ng ph\u1ea3i \"Ai\" ho\u1eb7c \"AI\")\n                    if (match[0] === 'ai') {\n                        issues.push({\n                            text: match[0],\n                            start: match.index,\n                            end: match.index + match[0].length,\n                            type: '\u26a0\ufe0f T\u1eeb Ti\u1ebfng Vi\u1ec7t hay b\u1ecb \u0111\u1ecdc sai',\n                            suggestion: 'Ai',\n                            isVietnameseWord: true\n                        });\n                    }\n                }\n                \n                // Detect \"im\" (word boundary)\n                const imPattern = /\\bim\\b/gi;\n                \n                while ((match = imPattern.exec(text)) !== null) {\n                    // Ch\u1ec9 b\u00e1o l\u1ed7i n\u1ebfu l\u00e0 ch\u1eef th\u01b0\u1eddng \"im\" (kh\u00f4ng ph\u1ea3i \"Im\" ho\u1eb7c \"IM\")\n                    if (match[0] === 'im') {\n                        issues.push({\n                            text: match[0],\n                            start: match.index,\n                            end: match.index + match[0].length,\n                            type: '\u26a0\ufe0f T\u1eeb Ti\u1ebfng Vi\u1ec7t hay b\u1ecb \u0111\u1ecdc sai',\n                            suggestion: 'Im',\n                            isVietnameseWord: true\n                        });\n                    }\n                }\n                \n                return issues;\n            }\n\n            function detectPunctuationIssues(text) {\n                if (!punctuationDetectionEnabled || !text) return [];\n\n                const issues = [];\n\n                // Pattern t\u1ed5ng qu\u00e1t \u0111\u1ec3 ph\u00e1t hi\u1ec7n t\u1ea5t c\u1ea3 c\u1ee5m d\u1ea5u c\u00e2u (2 k\u00fd t\u1ef1 tr\u1edf l\u00ean)\n                // D\u1ea5u ngo\u1eb7c k\u00e9p ch\u1ec9 b\u1ecb ph\u00e1t hi\u1ec7n khi n\u1eb1m c\u00f9ng v\u1edbi d\u1ea5u c\u00e2u kh\u00e1c\n                const generalPattern = /[.!?,;:]{2,}|[.!?,;:][\"']|[\"'][.!?,;:]|[\"'][.!?,;:]{2,}|[.!?,;:]{2,}[\"']/g;\n\n                let match;\n                while ((match = generalPattern.exec(text)) !== null) {\n                    const matchedText = match[0];\n                    const start = match.index;\n                    const end = match.index + matchedText.length;\n\n                    // Ph\u00e2n lo\u1ea1i lo\u1ea1i l\u1ed7i\n                    let type = 'D\u1ea5u c\u00e2u tr\u00f9ng l\u1eb7p';\n                    if (/[.!?]{2,}/.test(matchedText)) {\n                        type = 'D\u1ea5u ch\u1ea5m/ch\u1ea5m h\u1ecfi/ch\u1ea5m than tr\u00f9ng l\u1eb7p';\n                    } else if (/[,;]{2,}/.test(matchedText)) {\n                        type = 'D\u1ea5u ph\u1ea9y/ch\u1ea5m ph\u1ea9y tr\u00f9ng l\u1eb7p';\n                    } else if (/[:]{2,}/.test(matchedText)) {\n                        type = 'D\u1ea5u hai ch\u1ea5m tr\u00f9ng l\u1eb7p';\n                    } else if (/[\"'][.!?,;:]|[.!?,;:][\"']/.test(matchedText)) {\n                        type = 'D\u1ea5u ngo\u1eb7c k\u00e9p k\u1ebft h\u1ee3p v\u1edbi d\u1ea5u c\u00e2u kh\u00e1c';\n                    } else if (/[.!?][,;:]|[;:,][.!?]/.test(matchedText)) {\n                        type = 'D\u1ea5u c\u00e2u k\u1ebft h\u1ee3p kh\u00e1c nhau';\n                    }\n\n                    issues.push({\n                        text: matchedText,\n                        start: start,\n                        end: end,\n                        type: type,\n                        suggestion: getPunctuationSuggestion(matchedText)\n                    });\n                }\n\n                // \u2b50 TH\u00caM M\u1edaI: Merge Vietnamese word issues\n                const vietnameseIssues = detectVietnameseWordIssues(text);\n                issues.push(...vietnameseIssues);\n\n                return issues;\n            }\n\n            // H\u00e0m \u0111\u1ec1 xu\u1ea5t d\u1ea5u c\u00e2u thay th\u1ebf\n            function getPunctuationSuggestion(originalText) {\n                // N\u1ebfu c\u00f3 d\u1ea5u ch\u1ea5m h\u1ecfi, \u01b0u ti\u00ean gi\u1eef d\u1ea5u ch\u1ea5m h\u1ecfi\n                if (originalText.includes('?')) return '?';\n                // N\u1ebfu c\u00f3 d\u1ea5u ch\u1ea5m than, \u01b0u ti\u00ean gi\u1eef d\u1ea5u ch\u1ea5m than\n                if (originalText.includes('!')) return '!';\n                // N\u1ebfu c\u00f3 d\u1ea5u ch\u1ea5m, \u01b0u ti\u00ean gi\u1eef d\u1ea5u ch\u1ea5m\n                if (originalText.includes('.')) return '.';\n                // N\u1ebfu c\u00f3 d\u1ea5u ph\u1ea9y, \u01b0u ti\u00ean gi\u1eef d\u1ea5u ph\u1ea9y\n                if (originalText.includes(',')) return ',';\n                // N\u1ebfu c\u00f3 d\u1ea5u ngo\u1eb7c k\u00e9p, \u01b0u ti\u00ean gi\u1eef d\u1ea5u ngo\u1eb7c k\u00e9p\n                if (originalText.includes('\"')) return '\"';\n                // N\u1ebfu c\u00f3 d\u1ea5u ngo\u1eb7c \u0111\u01a1n, \u01b0u ti\u00ean gi\u1eef d\u1ea5u ngo\u1eb7c \u0111\u01a1n\n                if (originalText.includes(\"'\")) return \"'\";\n                // M\u1eb7c \u0111\u1ecbnh l\u00e0 d\u1ea5u ch\u1ea5m\n                return '.';\n            }\n\n            // H\u00e0m hi\u1ec3n th\u1ecb danh s\u00e1ch l\u1ed7i d\u1ea5u c\u00e2u\n            function displayPunctuationIssues(issues) {\n                const modal = document.getElementById('punctuation-detection-modal');\n                const issuesList = document.getElementById('punctuation-issues-list');\n\n                if (!issues || issues.length === 0) {\n                    modal.style.display = 'none';\n                    return;\n                }\n\n                // === AUTO-FIX KHI \u0110ANG TRONG BATCH MODE ===\n                // Ki\u1ec3m tra xem c\u00f3 \u0111ang t\u1ea1o file h\u00e0ng lo\u1ea1t kh\u00f4ng\n                const isBatchMode = window.batchState && window.batchState.isProcessing;\n                \n                console.log('\ud83d\udd0d [Punctuation] Checking batch mode:', {\n                    hasBatchState: !!window.batchState,\n                    isProcessing: window.batchState?.isProcessing,\n                    isBatchMode: isBatchMode\n                });\n                \n                if (isBatchMode) {\n                    // T\u1ef1 \u0111\u1ed9ng fix v\u00e0 kh\u00f4ng hi\u1ec3n th\u1ecb modal\n                    addLogEntry('\ud83d\udd27 [Batch] T\u1ef1 \u0111\u1ed9ng s\u1eeda d\u1ea5u c\u00e2u tr\u00f9ng l\u1eb7p...', 'info');\n                    setTimeout(() => {\n                        window.autoFixAllPunctuationIssues();\n                    }, 100);\n                    return;\n                }\n                // === END AUTO-FIX ===\n\n                issuesList.innerHTML = '';\n                issues.forEach((issue, index) => {\n                    const issueDiv = document.createElement('div');\n                    issueDiv.style.cssText = `\n                        background: #44475a;\n                        border: 1px solid #6272a4;\n                        border-radius: 6px;\n                        padding: 12px;\n                        margin-bottom: 10px;\n                        font-size: 14px;\n                    `;\n\n                    issueDiv.className = 'punctuation-issue-item';\n                    issueDiv.innerHTML = `\n                        <div style=\"color: #ffb86c; font-weight: bold; margin-bottom: 6px; font-size: 15px;\">\n                            ${issue.type}\n                        </div>\n                        <div style=\"color: #f8f8f2; margin-bottom: 6px;\">\n                            <strong>Ph\u00e1t hi\u1ec7n:</strong> <span style=\"background: #ff5555; color: white; padding: 2px 6px; border-radius: 3px; font-family: monospace;\">\"${issue.text}\"</span>\n                        </div>\n                        <div style=\"color: #50fa7b;\">\n                            <strong>\u0110\u1ec1 xu\u1ea5t:</strong> <span style=\"background: #50fa7b; color: #282a36; padding: 2px 6px; border-radius: 3px; font-family: monospace;\">\"${issue.suggestion}\"</span>\n                        </div>\n                    `;\n\n                    issuesList.appendChild(issueDiv);\n                });\n\n                // Hi\u1ec3n th\u1ecb modal (ch\u1ec9 khi kh\u00f4ng ph\u1ea3i batch mode)\n                modal.style.display = 'flex';\n            }\n\n            // H\u00e0m t\u1ef1 \u0111\u1ed9ng s\u1eeda t\u1ea5t c\u1ea3 l\u1ed7i d\u1ea5u c\u00e2u\n            // H\u00e0m t\u1ef1 \u0111\u1ed9ng s\u1eeda c\u00e1c t\u1eeb Ti\u1ebfng Vi\u1ec7t hay b\u1ecb \u0111\u1ecdc sai (ai, im)\n            function fixVietnameseWords(text) {\n                // Ch\u1ec9 s\u1eeda khi language = Ti\u1ebfng Vi\u1ec7t\n                const languageSelect = document.getElementById('gemini-language-select');\n                if (!languageSelect) return text;\n                \n                const selectedLanguage = languageSelect.value.toLowerCase();\n                \n                // Check n\u1ebfu KH\u00d4NG ph\u1ea3i Ti\u1ebfng Vi\u1ec7t \u2192 kh\u00f4ng s\u1eeda\n                if (!selectedLanguage.includes('vi\u1ec7t') && !selectedLanguage.includes('viet') && !selectedLanguage.includes('vietnamese')) {\n                    console.log('[fixVietnameseWords] Not Vietnamese language, skipping...');\n                    return text;\n                }\n                \n                console.log('[fixVietnameseWords] Applying Vietnamese word fixes for language:', selectedLanguage);\n                \n                let fixedText = text;\n                let fixCount = 0;\n                \n                // ================================================================\n                // \u2705 FIX: \"ai\" \u2192 \"Ai\" (CH\u1ec8 KHI \u0110\u1ee8NG \u0110\u1ed8C L\u1eacP)\n                // ================================================================\n                // Pattern c\u0169 (SAI):  /\\bai\\b/g  \u2190 Word boundary KH\u00d4NG work v\u1edbi ti\u1ebfng Vi\u1ec7t c\u00f3 d\u1ea5u\n                // Pattern m\u1edbi (\u0110\u00daNG): /(^|\\s)(ai)(\\s|$|[.,?!;:])/gi\n                //\n                // Gi\u1ea3i th\u00edch:\n                // (^|\\s)         - \u0110\u1ea7u d\u00f2ng HO\u1eb6C space\n                // (ai)           - Ch\u1eef \"ai\" (capture \u0111\u1ec3 gi\u1eef case)\n                // (\\s|$|[.,?!;:]) - Space, cu\u1ed1i d\u00f2ng, HO\u1eb6C d\u1ea5u c\u00e2u\n                //\n                // Examples:\n                // \u2705 \"ai \u0111\u00f3\"      \u2192 \"Ai \u0111\u00f3\"     (match)\n                // \u2705 \"ng\u01b0\u1eddi ai\"   \u2192 \"ng\u01b0\u1eddi Ai\"  (match)\n                // \u274c \"\u0111ai\"        \u2192 \"\u0111ai\"       (KH\u00d4NG match - gi\u1eef nguy\u00ean!)\n                // \u274c \"v\u00e0nh \u0111ai\"   \u2192 \"v\u00e0nh \u0111ai\"  (KH\u00d4NG match - gi\u1eef nguy\u00ean!)\n                // \u274c \"kim lo\u1ea1i\"   \u2192 \"kim lo\u1ea1i\"  (KH\u00d4NG match - gi\u1eef nguy\u00ean!)\n                // ================================================================\n                const aiPattern = /(^|\\s)(ai)(\\s|$|[.,?!;:])/gi;\n                const aiMatches = fixedText.match(aiPattern);\n                if (aiMatches) {\n                    // Replace: gi\u1eef nguy\u00ean prefix/suffix, ch\u1ec9 uppercase \"ai\"\n                    fixedText = fixedText.replace(aiPattern, (match, prefix, word, suffix) => {\n                        return prefix + 'Ai' + suffix;\n                    });\n                    fixCount += aiMatches.length;\n                    console.log(`[fixVietnameseWords] Fixed ${aiMatches.length} occurrences of \"ai\" \u2192 \"Ai\"`);\n                }\n                \n                // ================================================================\n                // \u2705 FIX: \"im\" \u2192 \"Im\" (CH\u1ec8 KHI \u0110\u1ee8NG \u0110\u1ed8C L\u1eacP)\n                // ================================================================\n                // T\u01b0\u01a1ng t\u1ef1 nh\u01b0 \"ai\"\n                //\n                // Examples:\n                // \u2705 \"im l\u1eb7ng\"    \u2192 \"Im l\u1eb7ng\"   (match)\n                // \u274c \"kim lo\u1ea1i\"   \u2192 \"kim lo\u1ea1i\"  (KH\u00d4NG match - gi\u1eef nguy\u00ean!)\n                // ================================================================\n                const imPattern = /(^|\\s)(im)(\\s|$|[.,?!;:])/gi;\n                const imMatches = fixedText.match(imPattern);\n                if (imMatches) {\n                    fixedText = fixedText.replace(imPattern, (match, prefix, word, suffix) => {\n                        return prefix + 'Im' + suffix;\n                    });\n                    fixCount += imMatches.length;\n                    console.log(`[fixVietnameseWords] Fixed ${imMatches.length} occurrences of \"im\" \u2192 \"Im\"`);\n                }\n                \n                if (fixCount > 0) {\n                    console.log(`[fixVietnameseWords] Total Vietnamese word fixes: ${fixCount}`);\n                }\n                \n                return fixedText;\n            }\n\n            function autoFixAllPunctuationIssues() {\n                console.log('autoFixAllPunctuationIssues called');\n\n                const textarea = document.getElementById('gemini-main-textarea');\n                const defaultPunctuation = document.getElementById('default-punctuation-select');\n                const modal = document.getElementById('punctuation-detection-modal');\n                const isBatchMode = window.batchState && window.batchState.isProcessing;\n\n                console.log('Elements found:', {\n                    textarea: !!textarea,\n                    defaultPunctuation: !!defaultPunctuation,\n                    modal: !!modal,\n                    isBatchMode: isBatchMode,\n                    issuesCount: detectedPunctuationIssues.length\n                });\n\n                if (!textarea) {\n                    console.error('Textarea not found');\n                    return;\n                }\n\n                if (!defaultPunctuation) {\n                    console.error('Default punctuation select not found');\n                    return;\n                }\n\n                // Modal kh\u00f4ng b\u1eaft bu\u1ed9c khi batch mode\n                if (!modal && !isBatchMode) {\n                    console.error('Modal not found');\n                    return;\n                }\n\n                if (!detectedPunctuationIssues.length) {\n                    console.log('No issues to fix');\n                    if (modal) modal.style.display = 'none';\n                    return;\n                }\n\n                const punctuationValue = defaultPunctuation.value;\n                console.log('Using punctuation:', punctuationValue);\n\n                let text = textarea.value;\n                console.log('Original text length:', text.length);\n\n                // T\u00e1ch punctuation issues v\u00e0 Vietnamese word issues\n                const punctuationIssues = detectedPunctuationIssues.filter(issue => !issue.isVietnameseWord);\n                const vietnameseWordIssues = detectedPunctuationIssues.filter(issue => issue.isVietnameseWord);\n\n                console.log('Punctuation issues:', punctuationIssues.length);\n                console.log('Vietnamese word issues:', vietnameseWordIssues.length);\n\n                // ========================================\n                // \ud83d\udd27 FIX BUG: MERGE T\u1ea4T C\u1ea2 ISSUES TH\u00c0NH 1 M\u1ea2NG\n                // Merge th\u00e0nh 1 m\u1ea3ng v\u1edbi replacement \u0111\u01b0\u1ee3c set s\u1eb5n\n                // ========================================\n                const allIssues = [\n                    ...punctuationIssues.map(issue => ({\n                        ...issue,\n                        replacement: punctuationValue  // D\u00f9ng punctuation user ch\u1ecdn\n                    })),\n                    ...vietnameseWordIssues.map(issue => ({\n                        ...issue,\n                        replacement: issue.suggestion  // D\u00f9ng suggestion (Ai, Im)\n                    }))\n                ];\n\n                console.log(`Total issues to fix: ${allIssues.length}`);\n\n                // Sort T\u1ea4T C\u1ea2 issues theo th\u1ee9 t\u1ef1 NG\u01af\u1ee2C (t\u1eeb cu\u1ed1i l\u00ean \u0111\u1ea7u)\n                // V\u00ec fix t\u1eeb cu\u1ed1i, n\u00ean KH\u00d4NG BAO GI\u1edc \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn index c\u1ee7a issues ph\u00eda tr\u01b0\u1edbc\n                const sortedAllIssues = allIssues.sort((a, b) => b.start - a.start);\n\n                // Fix T\u1ea4T C\u1ea2 issues t\u1eeb CU\u1ed0I l\u00ean \u0110\u1ea6U\n                sortedAllIssues.forEach((issue, index) => {\n                    console.log(`Fixing issue ${index + 1}/${sortedAllIssues.length}: \"${issue.text}\" \u2192 \"${issue.replacement}\"`);\n                    const beforeText = text.substring(0, issue.start);\n                    const afterText = text.substring(issue.end);\n                    text = beforeText + issue.replacement + afterText;\n                });\n\n                textarea.value = text;\n                detectedPunctuationIssues = [];\n\n                // \u0110\u00f3ng modal (n\u1ebfu c\u00f3)\n                if (modal) {\n                    modal.style.display = 'none';\n                    console.log('Modal closed');\n                }\n\n                // Trigger input event \u0111\u1ec3 c\u1eadp nh\u1eadt stats\n                textarea.dispatchEvent(new Event('input'));\n\n                // Hi\u1ec3n th\u1ecb th\u00f4ng b\u00e1o th\u00e0nh c\u00f4ng\n                const totalIssues = sortedAllIssues.length;\n                const punctuationCount = punctuationIssues.length;\n                const vietnameseCount = vietnameseWordIssues.length;\n                \n                // Ch\u1ec9 hi\u1ec3n th\u1ecb toast khi KH\u00d4NG trong batch mode\n                if (!isBatchMode && typeof Swal !== 'undefined') {\n                    Swal.fire({\n                        toast: true,\n                        position: 'top-end',\n                        icon: 'success',\n                        title: '\u0110\u00e3 s\u1eeda d\u1ea5u c\u00e2u & t\u1eeb Ti\u1ebfng Vi\u1ec7t',\n                        text: `\u0110\u00e3 t\u1ef1 \u0111\u1ed9ng s\u1eeda ${punctuationCount} l\u1ed7i d\u1ea5u c\u00e2u v\u00e0 ${vietnameseCount} t\u1eeb Ti\u1ebfng Vi\u1ec7t`,\n                        showConfirmButton: false,\n                        timer: 2000,\n                        timerProgressBar: true\n                    });\n                }\n                \n                console.log(`Fixed ${punctuationCount} punctuation issues and ${vietnameseCount} Vietnamese word issues`);\n            }\n\n            // H\u00e0m b\u1ecf qua t\u1ea5t c\u1ea3 l\u1ed7i d\u1ea5u c\u00e2u\n            function ignoreAllPunctuationIssues() {\n                console.log('ignoreAllPunctuationIssues called');\n\n                const modal = document.getElementById('punctuation-detection-modal');\n                console.log('Modal found:', !!modal);\n\n                detectedPunctuationIssues = [];\n\n                if (modal) {\n                    modal.style.display = 'none';\n                    console.log('Modal closed');\n                } else {\n                    console.error('Modal not found for closing');\n                }\n            }\n\n            // Th\u00eam c\u00e1c h\u00e0m v\u00e0o global scope \u0111\u1ec3 c\u00f3 th\u1ec3 g\u1ecdi t\u1eeb HTML\n            window.autoFixAllPunctuationIssues = autoFixAllPunctuationIssues;\n            window.ignoreAllPunctuationIssues = ignoreAllPunctuationIssues;\n            window.fixVietnameseWords = fixVietnameseWords; // \u2b50 Expose \u0111\u1ec3 d\u00f9ng \u1edf n\u01a1i kh\u00e1c\n\n            // Event listener cho textarea \u0111\u1ec3 ph\u00e1t hi\u1ec7n d\u1ea5u c\u00e2u\n            const textarea = document.getElementById('gemini-main-textarea');\n            if (textarea) {\n                textarea.addEventListener('input', function() {\n                    const text = this.value;\n                    detectedPunctuationIssues = detectPunctuationIssues(text);\n\n                    if (detectedPunctuationIssues.length > 0) {\n                        displayPunctuationIssues(detectedPunctuationIssues);\n                    }\n                });\n            }\n\n            // Event listener cho n\u00fat \"B\u1eaft \u0111\u1ea7u t\u1ea1o \u00e2m thanh\" \u0111\u1ec3 ki\u1ec3m tra d\u1ea5u c\u00e2u\n            const startBtn = document.getElementById('gemini-start-queue-btn');\n            if (startBtn) {\n                startBtn.addEventListener('click', function() {\n                    const text = textarea.value;\n                    detectedPunctuationIssues = detectPunctuationIssues(text);\n\n                    if (detectedPunctuationIssues.length > 0) {\n                        displayPunctuationIssues(detectedPunctuationIssues);\n                        // Ng\u0103n kh\u00f4ng cho b\u1eaft \u0111\u1ea7u t\u1ea1o \u00e2m thanh n\u1ebfu c\u00f3 l\u1ed7i d\u1ea5u c\u00e2u\n                        return false;\n                    }\n                });\n            }\n\n            // Event listener cho modal\n            const modal = document.getElementById('punctuation-detection-modal');\n            if (modal) {\n                modal.addEventListener('click', function(e) {\n                    if (e.target === modal) {\n                        ignoreAllPunctuationIssues();\n                    }\n                });\n            }\n        })();\n\n        // --- 6. Retry Logic and Recovery System ---\n        (function() {\n            // =================================================================\n            // == KH\u1ed0I CODE N\u00c2NG C\u1ea4P - C\u01a0 CH\u1ebe PH\u1ee4C H\u1ed2I N\u00d3NG V\u00c0 TH\u1eec L\u1ea0I L\u1ed6I ==\n            // =================================================================\n\n            /**\n             * H\u1ee3p nh\u1ea5t v\u00e0 t\u1ef1 \u0111\u1ed9ng t\u1ea3i xu\u1ed1ng c\u00e1c \u0111o\u1ea1n \u00e2m thanh \u0111\u00e3 th\u00e0nh c\u00f4ng.\n             */\n            function mergeAndDownloadPartial(audioChunks, segmentIndex) {\n                if (!audioChunks || audioChunks.length === 0) {\n                    Swal.fire('Kh\u00f4ng c\u00f3 g\u00ec \u0111\u1ec3 t\u1ea3i', 'Kh\u00f4ng c\u00f3 \u0111o\u1ea1n \u00e2m thanh n\u00e0o \u0111\u01b0\u1ee3c x\u1eed l\u00fd th\u00e0nh c\u00f4ng.', 'warning');\n                    return;\n                }\n                console.log(`B\u1eaft \u0111\u1ea7u h\u1ee3p nh\u1ea5t ${audioChunks.length} \u0111o\u1ea1n \u00e2m thanh \u0111\u00e3 th\u00e0nh c\u00f4ng...`);\n                const mergedBlob = new Blob(audioChunks, { 'type': 'audio/mpeg' });\n                const url = URL.createObjectURL(mergedBlob);\n                const a = document.createElement('a');\n                a.style.display = 'none';\n                a.href = url;\n                // \u01afU TI\u00caN 1: Ki\u1ec3m tra t\u00ean file do ng\u01b0\u1eddi d\u00f9ng nh\u1eadp t\u00f9y ch\u1ec9nh\n                const customFilenameInput = document.getElementById('custom-filename-input');\n                let fileName = 'audio'; // T\u00ean m\u1eb7c \u0111\u1ecbnh\n\n                // N\u1ebfu ng\u01b0\u1eddi d\u00f9ng \u0111\u00e3 nh\u1eadp t\u00ean file t\u00f9y ch\u1ec9nh, \u01b0u ti\u00ean s\u1eed d\u1ee5ng t\u00ean \u0111\u00f3\n                if (customFilenameInput && customFilenameInput.value && customFilenameInput.value.trim()) {\n                    fileName = customFilenameInput.value.trim();\n\n                    // L\u00e0m s\u1ea1ch t\u00ean file: lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7, thay kho\u1ea3ng tr\u1eafng b\u1eb1ng g\u1ea1ch d\u01b0\u1edbi\n                    fileName = fileName\n                        .replace(/[<>:\"/\\\\|?*]/g, '') // Lo\u1ea1i b\u1ecf c\u00e1c k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7 trong t\u00ean file\n                        .replace(/\\s+/g, '_')         // Thay th\u1ebf m\u1ed9t ho\u1eb7c nhi\u1ec1u kho\u1ea3ng tr\u1eafng b\u1eb1ng d\u1ea5u g\u1ea1ch d\u01b0\u1edbi\n                        .replace(/[^\\w\\u00C0-\\u1EF9]/g, '') // Ch\u1ec9 gi\u1eef ch\u1eef c\u00e1i, s\u1ed1 v\u00e0 ti\u1ebfng Vi\u1ec7t\n                        .trim();\n\n                    if (fileName.length > 100) {\n                        fileName = fileName.substring(0, 100);\n                    }\n                }\n\n                // \u01afU TI\u00caN 2: N\u1ebfu kh\u00f4ng c\u00f3 t\u00ean t\u00f9y ch\u1ec9nh, ki\u1ec3m tra t\u00ean file v\u0103n b\u1ea3n \u0111\u00e3 t\u1ea3i l\u00ean\n                if (fileName === 'audio') {\n                    const textFileInput = document.getElementById('text-file-input');\n\n                    // N\u1ebfu c\u00f3 file v\u0103n b\u1ea3n \u0111\u00e3 t\u1ea3i l\u00ean, s\u1eed d\u1ee5ng t\u00ean file \u0111\u00f3\n                    if (textFileInput && textFileInput.files && textFileInput.files.length > 0) {\n                        const uploadedTextFile = textFileInput.files[0];\n                        if (uploadedTextFile && uploadedTextFile.name) {\n                            // L\u1ea5y t\u00ean file v\u0103n b\u1ea3n \u0111\u00e3 t\u1ea3i l\u00ean (b\u1ecf \u0111u\u00f4i file)\n                            const uploadedFileName = uploadedTextFile.name;\n                            const lastDotIndex = uploadedFileName.lastIndexOf('.');\n                            if (lastDotIndex > 0) {\n                                fileName = uploadedFileName.substring(0, lastDotIndex);\n                            } else {\n                                fileName = uploadedFileName;\n                            }\n\n                            // L\u00e0m s\u1ea1ch t\u00ean file: lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7, thay kho\u1ea3ng tr\u1eafng b\u1eb1ng g\u1ea1ch d\u01b0\u1edbi\n                            fileName = fileName\n                                .replace(/[<>:\"/\\\\|?*]/g, '') // Lo\u1ea1i b\u1ecf c\u00e1c k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7 trong t\u00ean file\n                                .replace(/\\s+/g, '_')         // Thay th\u1ebf m\u1ed9t ho\u1eb7c nhi\u1ec1u kho\u1ea3ng tr\u1eafng b\u1eb1ng d\u1ea5u g\u1ea1ch d\u01b0\u1edbi\n                                .replace(/[^\\w\\u00C0-\\u1EF9]/g, '') // Ch\u1ec9 gi\u1eef ch\u1eef c\u00e1i, s\u1ed1 v\u00e0 ti\u1ebfng Vi\u1ec7t\n                                .trim();\n\n                            if (fileName.length > 100) {\n                                fileName = fileName.substring(0, 100);\n                            }\n                        }\n                    }\n                }\n\n                // \u01afU TI\u00caN 3: N\u1ebfu v\u1eabn ch\u01b0a c\u00f3 t\u00ean, d\u00f9ng d\u00f2ng \u0111\u1ea7u ti\u00ean c\u1ee7a v\u0103n b\u1ea3n\n                if (fileName === 'audio') {\n                    const textarea = document.getElementById('gemini-main-textarea');\n                    if (textarea && textarea.value) {\n                        const firstLine = textarea.value.split('\\n')[0].trim();\n                        if (firstLine) {\n                            fileName = firstLine\n                                .replace(/[<>:\"/\\\\|?*]/g, '') // Lo\u1ea1i b\u1ecf k\u00fd t\u1ef1 kh\u00f4ng h\u1ee3p l\u1ec7\n                                .replace(/\\s+/g, '_') // Thay th\u1ebf kho\u1ea3ng tr\u1eafng b\u1eb1ng _\n                                .replace(/[^\\w\\u00C0-\\u1EF9]/g, '') // Ch\u1ec9 gi\u1eef ch\u1eef c\u00e1i, s\u1ed1 v\u00e0 ti\u1ebfng Vi\u1ec7t\n                                .trim();\n                            if (fileName.length > 100) {\n                                fileName = fileName.substring(0, 100);\n                            }\n                        }\n                    }\n                }\n                a.download = `${fileName}.mp3`;\n                document.body.appendChild(a);\n                a.click();\n                setTimeout(() => {\n                    document.body.removeChild(a);\n                    window.URL.revokeObjectURL(url);\n                    console.log('\u0110\u00e3 t\u1ea3i xu\u1ed1ng ph\u1ea7n \u00e2m thanh th\u00e0nh c\u00f4ng.');\n\n                    // \ud83d\ude80 T\u1ef0 \u0110\u1ed8NG T\u1ea2I XU\u1ed0NG FILE SAU KHI GH\u00c9P CHUNK TH\u00c0NH C\u00d4NG\n                    console.log('\ud83c\udf89 \u0110\u00e3 t\u1ef1 \u0111\u1ed9ng t\u1ea3i xu\u1ed1ng file \u00e2m thanh t\u1eeb c\u00e1c chunk th\u00e0nh c\u00f4ng!');\n                }, 100);\n            }\n\n            /**\n             * L\u1ea5y to\u00e0n b\u1ed9 ph\u1ea7n v\u0103n b\u1ea3n c\u00f2n l\u1ea1i t\u1eeb \u0111i\u1ec3m b\u1ecb l\u1ed7i.\n             */\n            function getRemainingText(failedIndex, allSegments) {\n                if (failedIndex >= allSegments.length) return \"\";\n                const remainingSegments = allSegments.slice(failedIndex);\n                return remainingSegments.join('\\n\\n');\n            }\n\n            /**\n             * Reset l\u1ea1i tr\u1ea1ng th\u00e1i c\u1ee7a tool v\u00e0 b\u1eaft \u0111\u1ea7u m\u1ed9t l\u1ea7n render m\u1edbi.\n             */\n            function resetAndStartNewRender(newText) {\n                console.log(\"\ud83d\udd25 B\u1eaft \u0111\u1ea7u ph\u1ee5c h\u1ed3i n\u00f3ng v\u1edbi v\u0103n b\u1ea3n m\u1edbi...\");\n\n                // 1. Reset tr\u1ea1ng th\u00e1i c\u1ed1t l\u00f5i\n                if (typeof window.ZTQj$LF$o !== 'undefined') window.ZTQj$LF$o = [];\n                if (typeof window.SI$acY !== 'undefined') window.SI$acY = [];\n                if (typeof window.ttuo$y_KhCV !== 'undefined') window.ttuo$y_KhCV = 0;\n                if (typeof window.retryCount !== 'undefined') window.retryCount = 0;\n\n                // 2. C\u1eadp nh\u1eadt giao di\u1ec7n\n                const progressBar = document.getElementById('gemini-progress-bar');\n                const progressLabel = document.getElementById('gemini-progress-label');\n                if(progressBar && progressLabel) {\n                    progressBar.style.width = '0%';\n                    progressLabel.textContent = '0%';\n                }\n                const startButton = document.getElementById('gemini-start-queue-btn');\n                if(startButton) startButton.disabled = true;\n\n                // 3. Chu\u1ea9n b\u1ecb cho l\u1ea7n render m\u1edbi\n                if (typeof window.SI$acY !== 'undefined') {\n                    // L\u1ea5y gi\u00e1 tr\u1ecb t\u1eeb c\u00f4ng t\u1eafc chunk size\n                    const chunkSizeToggle = document.getElementById('chunk-size-toggle');\n                    const useLargeChunks = chunkSizeToggle ? chunkSizeToggle.checked : false;\n                    const actualMaxLength = useLargeChunks ? 900 : 700;\n                    window.SI$acY = chiaVanBanThongMinh(newText, 600, 500, actualMaxLength);\n                    console.log(`T\u1ed5ng v\u0103n b\u1ea3n: ${newText.length} k\u00fd t\u1ef1`);\n                    console.log(`S\u1ed1 chunk \u0111\u01b0\u1ee3c t\u00e1ch: ${window.SI$acY.length}`);\n                    console.log(`Chunk \u0111\u1ea7u ti\u00ean: ${window.SI$acY[0] ? window.SI$acY[0].length : 0} k\u00fd t\u1ef1`);\n                    console.log(`Chunk th\u1ee9 2: ${window.SI$acY[1] ? window.SI$acY[1].length : 0} k\u00fd t\u1ef1`);\n                    console.log(`Chunk th\u1ee9 3: ${window.SI$acY[2] ? window.SI$acY[2].length : 0} k\u00fd t\u1ef1`);\n                    console.log(`Chunk cu\u1ed1i: ${window.SI$acY[window.SI$acY.length-1] ? window.SI$acY[window.SI$acY.length-1].length : 0} k\u00fd t\u1ef1`);\n                    if(window.SI$acY.length > 4) {\n                        console.log(`Chunk th\u1ee9 4: ${window.SI$acY[3] ? window.SI$acY[3].length : 0} k\u00fd t\u1ef1`);\n                        console.log(`Chunk th\u1ee9 5: ${window.SI$acY[4] ? window.SI$acY[4].length : 0} k\u00fd t\u1ef1`);\n                    }\n                    if (window.SI$acY.length > 0) {\n                         if(startButton) startButton.disabled = false;\n                    }\n                    console.log(`V\u0103n b\u1ea3n c\u00f2n l\u1ea1i \u0111\u01b0\u1ee3c chia th\u00e0nh ${window.SI$acY.length} \u0111o\u1ea1n m\u1edbi.`);\n                }\n\n                // 4. K\u00edch ho\u1ea1t l\u1ea1i v\u00e0 b\u1eaft \u0111\u1ea7u\n                if (typeof window.EfNjYNYj_O_CGB !== 'undefined') window.EfNjYNYj_O_CGB = true;\n                if (typeof window.MEpJezGZUsmpZdAgFRBRZW !== 'undefined') window.MEpJezGZUsmpZdAgFRBRZW = true;\n                if (typeof window.uSTZrHUt_IC_GLOBAL === 'function') {\n                    window.uSTZrHUt_IC_GLOBAL();\n                } else {\n                    Swal.fire('L\u1ed7i nghi\u00eam tr\u1ecdng', 'Kh\u00f4ng th\u1ec3 kh\u1edfi \u0111\u1ed9ng l\u1ea1i ti\u1ebfn tr\u00ecnh. Vui l\u00f2ng t\u1ea3i l\u1ea1i trang.', 'error');\n                }\n            }\n\n            /**\n             * Hi\u1ec3n th\u1ecb dialog ph\u1ee5c h\u1ed3i v\u1edbi t\u00f9y ch\u1ecdn render ti\u1ebfp.\n             */\n            function showRecoveryDialog() {\n                if (typeof window.EfNjYNYj_O_CGB !== 'undefined') window.EfNjYNYj_O_CGB = false;\n                if (typeof window.MEpJezGZUsmpZdAgFRBRZW !== 'undefined') window.MEpJezGZUsmpZdAgFRBRZW = false;\n\n                const remainingText = getRemainingText(window.ttuo$y_KhCV || 0, window.SI$acY || []);\n                const successfulChunkCount = (window.ZTQj$LF$o || []).length;\n                const failedChunkIndex = (window.ttuo$y_KhCV || 0) + 1;\n\n                Swal.fire({\n                    title: '<strong>\u26a0\ufe0f \u0110\u00e3 X\u1ea3y Ra L\u1ed7i - Ch\u1ebf \u0110\u1ed9 Ph\u1ee5c H\u1ed3i</strong>',\n                    icon: 'error',\n                    html: `\n                        <div style=\"text-align: left; font-size: 14px;\">\n                            <p>Qu\u00e1 tr\u00ecnh render \u0111\u00e3 d\u1eebng \u1edf <b>\u0111o\u1ea1n ${failedChunkIndex}</b>.</p>\n                            <p>B\u1ea1n c\u00f3 th\u1ec3 t\u1ea3i v\u1ec1 ph\u1ea7n \u0111\u00e3 ho\u00e0n th\u00e0nh, sau \u0111\u00f3 render ti\u1ebfp ph\u1ea7n c\u00f2n l\u1ea1i.</p>\n                            <hr>\n                            <p><b>PH\u1ea6N V\u0102N B\u1ea2N C\u00d2N L\u1ea0I:</b></p>\n                        </div>\n                        <textarea id=\"swal-remaining-text\" style=\"width: 95%; height: 120px; margin-top: 10px; font-size: 12px;\">${remainingText}</textarea>\n                    `,\n                    width: '600px',\n                    showCloseButton: true,\n                    focusConfirm: false,\n                    confirmButtonText: `\u2705 T\u1ea3i Ph\u1ea7n 1 (${successfulChunkCount} \u0110o\u1ea1n)`,\n                    confirmButtonColor: '#3085d6',\n                    showDenyButton: true,\n                    denyButtonText: `\ud83d\ude80 Render Ti\u1ebfp Ph\u1ea7n 2`,\n                    denyButtonColor: '#4CAF50',\n                    showCancelButton: true,\n                    cancelButtonText: '\u0110\u00f3ng',\n                }).then((result) => {\n                    if (result.isConfirmed) {\n                        mergeAndDownloadPartial(window.ZTQj$LF$o || [], window.ttuo$y_KhCV || 0);\n                        const textarea = document.getElementById('swal-remaining-text');\n                        textarea.select();\n                        document.execCommand('copy');\n                        Swal.fire({\n                            toast: true,\n                            position: 'top-end',\n                            icon: 'success',\n                            title: '\u0110\u00e3 t\u1ea3i file v\u00e0 copy ph\u1ea7n c\u00f2n l\u1ea1i!',\n                            showConfirmButton: false,\n                            timer: 3000\n                        });\n                    } else if (result.isDenied) {\n                        const textToRender = document.getElementById('swal-remaining-text').value;\n                        if (textToRender && textToRender.trim().length > 0) {\n                            resetAndStartNewRender(textToRender);\n                        } else {\n                            Swal.fire('Ho\u00e0n t\u1ea5t!', 'Kh\u00f4ng c\u00f2n v\u0103n b\u1ea3n n\u00e0o \u0111\u1ec3 render.', 'info');\n                        }\n                    }\n                });\n            }\n\n\n            // Override console.log \u0111\u1ec3 ph\u00e1t hi\u1ec7n khi h\u1ebft retry\n            const originalConsoleLog = console.log;\n            console.log = function(...args) {\n                const message = args.join(' ');\n\n                // Ph\u00e1t hi\u1ec7n khi h\u1ebft retry\n                if (message.includes('\u0110\u00e3 th\u1eed l\u1ea1i') && message.includes('l\u1ea7n nh\u01b0ng v\u1eabn th\u1ea5t b\u1ea1i')) {\n                    console.warn('\ud83d\udea8 Ph\u00e1t hi\u1ec7n h\u1ebft l\u01b0\u1ee3t retry, ng\u1eebng tool...');\n                    setTimeout(() => {\n                        if (typeof window.stopTool === 'function') {\n                            window.stopTool();\n                        }\n                    }, 1000);\n                }\n\n                return originalConsoleLog.apply(console, args);\n            };\n\n            // Th\u00eam helper functions\n            window.minimaxRetryHelper = {\n                // Ki\u1ec3m tra tr\u1ea1ng th\u00e1i tool\n                isToolStopped: function() {\n                    return window.toolStopped || false;\n                },\n\n                // Ng\u1eebng tool\n                stop: function() {\n                    if (typeof window.stopTool === 'function') {\n                        window.stopTool();\n                    }\n                },\n\n                // Kh\u1edfi \u0111\u1ed9ng l\u1ea1i tool\n                restart: function() {\n                    if (typeof window.restartTool === 'function') {\n                        window.restartTool();\n                    }\n                },\n\n                // Ki\u1ec3m tra s\u1ed1 l\u1ea7n retry\n                checkRetryCount: function() {\n                    // T\u00ecm bi\u1ebfn retryCount trong global scope\n                    for (let key in window) {\n                        if (key.includes('retry') || key.includes('Retry')) {\n                            console.log(`Retry variable: ${key} = ${window[key]}`);\n                        }\n                    }\n                },\n\n                // H\u00e0m x\u1eed l\u00fd retry logic (\u0111\u00e3 \u0111\u01b0\u1ee3c t\u00edch h\u1ee3p v\u00e0o uSTZrHUt_IC)\n                handleRetry: function() {\n                    console.log('Retry logic \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00edch h\u1ee3p v\u00e0o h\u00e0m ch\u00ednh uSTZrHUt_IC');\n                },\n\n                // H\u00e0m hi\u1ec3n th\u1ecb recovery dialog\n                showRecovery: showRecoveryDialog,\n\n                // H\u00e0m reset v\u00e0 render m\u1edbi\n                resetAndRender: resetAndStartNewRender\n            };\n\n            console.log('\u2705 \u0110\u00e3 th\u00eam ch\u1ee9c n\u0103ng retry v\u00e0 ph\u1ee5c h\u1ed3i n\u00f3ng');\n\n            // === S\u1eecA L\u1ed6I ARIA-HIDDEN ===\n            // Ng\u0103n ch\u1eb7n vi\u1ec7c \u0111\u1eb7t aria-hidden=\"true\" tr\u00ean container ch\u00ednh\n            const originalSetAttribute = Element.prototype.setAttribute;\n            Element.prototype.setAttribute = function(name, value) {\n                if (name === 'aria-hidden' && this.id === 'gemini-main-container') {\n                    console.warn('\ud83d\udeab Ng\u0103n ch\u1eb7n vi\u1ec7c \u0111\u1eb7t aria-hidden tr\u00ean gemini-main-container \u0111\u1ec3 tr\u00e1nh l\u1ed7i accessibility');\n                    return;\n                }\n                return originalSetAttribute.call(this, name, value);\n            };\n\n            // \u0110\u1ea3m b\u1ea3o container kh\u00f4ng c\u00f3 aria-hidden khi kh\u1edfi t\u1ea1o\n            setTimeout(() => {\n                const container = document.getElementById('gemini-main-container');\n                if (container && container.hasAttribute('aria-hidden')) {\n                    container.removeAttribute('aria-hidden');\n                    console.log('\u2705 \u0110\u00e3 x\u00f3a aria-hidden kh\u1ecfi gemini-main-container');\n                }\n            }, 1000);\n\n        })();\n\n        // --- 7. Text File Upload Functionality ---\n        (function() {\n            // Tab switching functionality\n            const textTab = document.getElementById('text-tab');\n            const fileTab = document.getElementById('file-tab');\n            const textInputArea = document.getElementById('text-input-area');\n            const fileInputArea = document.getElementById('file-input-area');\n            const textFileInput = document.getElementById('text-file-input');\n            const fileUploadArea = document.getElementById('file-upload-area');\n            const fileInfo = document.getElementById('file-info');\n            const removeFileBtn = document.getElementById('remove-file-btn');\n            const textarea = document.getElementById('gemini-main-textarea');\n\n            // Tab switching\n            if (textTab && fileTab && textInputArea && fileInputArea) {\n                textTab.addEventListener('click', function() {\n                    textTab.classList.add('active');\n                    fileTab.classList.remove('active');\n                    textInputArea.classList.add('active');\n                    fileInputArea.classList.remove('active');\n                });\n\n                fileTab.addEventListener('click', function() {\n                    fileTab.classList.add('active');\n                    textTab.classList.remove('active');\n                    fileInputArea.classList.add('active');\n                    textInputArea.classList.remove('active');\n                });\n            }\n\n            // File upload functionality\n            if (fileUploadArea && textFileInput) {\n                // Click to select file\n                fileUploadArea.addEventListener('click', function() {\n                    textFileInput.click();\n                });\n\n                // File input change\n                textFileInput.addEventListener('change', function(e) {\n                    const file = e.target.files[0];\n                    if (file) {\n                        handleFileUpload(file);\n                    }\n                });\n\n                // Drag and drop functionality\n                fileUploadArea.addEventListener('dragover', function(e) {\n                    e.preventDefault();\n                    fileUploadArea.classList.add('dragover');\n                });\n\n                fileUploadArea.addEventListener('dragleave', function(e) {\n                    e.preventDefault();\n                    fileUploadArea.classList.remove('dragover');\n                });\n\n                fileUploadArea.addEventListener('drop', function(e) {\n                    e.preventDefault();\n                    fileUploadArea.classList.remove('dragover');\n\n                    const files = e.dataTransfer.files;\n                    if (files.length > 0) {\n                        handleFileUpload(files[0]);\n                    }\n                });\n            }\n\n            // Remove file functionality\n            if (removeFileBtn) {\n                removeFileBtn.addEventListener('click', function() {\n                    clearFileSelection();\n                });\n            }\n\n            // Handle file upload\n            function handleFileUpload(file) {\n                const fileName = file.name;\n                const fileSize = formatFileSize(file.size);\n                const fileExtension = fileName.split('.').pop().toLowerCase();\n\n                // Check if file type is supported\n                const supportedTypes = ['txt', 'doc', 'docx', 'rtf', 'odt', 'pdf', 'md', 'html', 'htm', 'xml', 'csv', 'json'];\n                if (!supportedTypes.includes(fileExtension)) {\n                    Swal.fire({\n                        icon: 'error',\n                        title: 'Lo\u1ea1i file kh\u00f4ng \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3',\n                        text: `File ${fileName} c\u00f3 \u0111\u1ecbnh d\u1ea1ng kh\u00f4ng \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3. Vui l\u00f2ng ch\u1ecdn file kh\u00e1c.`,\n                        confirmButtonText: 'OK'\n                    });\n                    return;\n                }\n\n                // Show file info\n                if (fileInfo) {\n                    const fileNameSpan = fileInfo.querySelector('.file-name');\n                    const fileSizeSpan = fileInfo.querySelector('.file-size');\n\n                    if (fileNameSpan) fileNameSpan.textContent = fileName;\n                    if (fileSizeSpan) fileSizeSpan.textContent = fileSize;\n\n                    fileInfo.style.display = 'block';\n                }\n\n                // Hide upload area\n                fileUploadArea.style.display = 'none';\n\n                // Read file content\n                readFileContent(file);\n            }\n\n            // Clear file selection\n            function clearFileSelection() {\n                if (textFileInput) textFileInput.value = '';\n                if (fileInfo) fileInfo.style.display = 'none';\n                if (fileUploadArea) fileUploadArea.style.display = 'block';\n            }\n\n            // Cache file extension \u0111\u1ec3 tr\u00e1nh t\u00ednh to\u00e1n l\u1ea1i\n            const fileExtensionCache = new Map();\n\n            // Read file content\n            function readFileContent(file) {\n                const reader = new FileReader();\n\n                reader.onload = function(e) {\n                    let content = e.target.result;\n\n                    // Cache file extension\n                    let fileExtension = fileExtensionCache.get(file.name);\n                    if (!fileExtension) {\n                        fileExtension = file.name.split('.').pop().toLowerCase();\n                        fileExtensionCache.set(file.name, fileExtension);\n                    }\n\n                    // Optimize file processing with switch statement\n                    switch (fileExtension) {\n                        case 'json':\n                        try {\n                            const jsonData = JSON.parse(content);\n                            content = JSON.stringify(jsonData, null, 2);\n                        } catch (error) {\n                            console.error('Error parsing JSON:', error);\n                            Swal.fire({\n                                icon: 'error',\n                                title: 'L\u1ed7i \u0111\u1ecdc file JSON',\n                                text: 'File JSON kh\u00f4ng h\u1ee3p l\u1ec7 ho\u1eb7c b\u1ecb l\u1ed7i.',\n                                confirmButtonText: 'OK'\n                            });\n                            return;\n                        }\n                            break;\n                        case 'csv':\n                        // Convert CSV to readable format\n                        content = content.replace(/,/g, ', ');\n                            break;\n                        case 'html':\n                        case 'htm':\n                        case 'xml':\n                            // Extract text from HTML/XML\n                        const tempDiv = document.createElement('div');\n                        tempDiv.innerHTML = content;\n                        content = tempDiv.textContent || tempDiv.innerText || '';\n                            break;\n                        default:\n                            // No processing needed for other file types\n                            break;\n                    }\n\n                    // Set content to textarea\n                    if (textarea) {\n                        textarea.value = content;\n\n                        // Trigger input event to update stats\n                        textarea.dispatchEvent(new Event('input'));\n\n                        // Switch to text tab to show the content\n                        if (textTab && textInputArea) {\n                            textTab.click();\n                        }\n                    }\n\n                    // Show success message\n                    Swal.fire({\n                        toast: true,\n                        position: 'top-end',\n                        icon: 'success',\n                        title: '\u0110\u00e3 t\u1ea3i file th\u00e0nh c\u00f4ng',\n                        text: `\u0110\u00e3 \u0111\u1ecdc n\u1ed9i dung t\u1eeb ${file.name}`,\n                        showConfirmButton: false,\n                        timer: 3000,\n                        timerProgressBar: true\n                    });\n                };\n\n                reader.onerror = function() {\n                    Swal.fire({\n                        icon: 'error',\n                        title: 'L\u1ed7i \u0111\u1ecdc file',\n                        text: 'Kh\u00f4ng th\u1ec3 \u0111\u1ecdc n\u1ed9i dung file. Vui l\u00f2ng th\u1eed l\u1ea1i.',\n                        confirmButtonText: 'OK'\n                    });\n                };\n\n                // Read file based on type\n                const fileExtension = file.name.split('.').pop().toLowerCase();\n\n                if (fileExtension === 'pdf') {\n                    // For PDF files, we can only read as text (limited functionality)\n                    reader.readAsText(file);\n                } else {\n                    reader.readAsText(file, 'UTF-8');\n                }\n            }\n\n            // Format file size\n            function formatFileSize(bytes) {\n                if (bytes === 0) return '0 Bytes';\n                const k = 1024;\n                const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n                const i = Math.floor(Math.log(bytes) / Math.log(k));\n                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n            }\n\n            console.log('\u2705 Text file upload functionality initialized');\n        })();\n\n        // --- 7b. Simple Text File Load Button ---\n        (function() {\n            const loadTextFileBtn = document.getElementById('load-text-file-btn');\n            const textFileInput = document.getElementById('text-file-input');\n            const textarea = document.getElementById('gemini-main-textarea');\n\n            if (loadTextFileBtn && textFileInput && textarea) {\n                // Click button to open file picker\n                loadTextFileBtn.addEventListener('click', function() {\n                    textFileInput.click();\n                });\n\n                // Handle file selection\n                textFileInput.addEventListener('change', function(e) {\n                    const file = e.target.files[0];\n                    if (file) {\n                        const reader = new FileReader();\n                        \n                        reader.onload = function(event) {\n                            let content = event.target.result;\n                            const fileExtension = file.name.split('.').pop().toLowerCase();\n                            \n                            // Process based on file type\n                            switch (fileExtension) {\n                                case 'json':\n                                    try {\n                                        const jsonData = JSON.parse(content);\n                                        content = JSON.stringify(jsonData, null, 2);\n                                    } catch (error) {\n                                        console.error('Error parsing JSON:', error);\n                                    }\n                                    break;\n                                case 'csv':\n                                    content = content.replace(/,/g, ', ');\n                                    break;\n                                case 'html':\n                                case 'htm':\n                                case 'xml':\n                                    const tempDiv = document.createElement('div');\n                                    tempDiv.innerHTML = content;\n                                    content = tempDiv.textContent || tempDiv.innerText || '';\n                                    break;\n                            }\n                            \n                            // Set content to textarea\n                            textarea.value = content;\n                            \n                            // Trigger input event to update stats\n                            textarea.dispatchEvent(new Event('input'));\n                            \n                            // Show success notification\n                            Swal.fire({\n                                icon: 'success',\n                                title: 'Th\u00e0nh c\u00f4ng!',\n                                text: `\u0110\u00e3 t\u1ea3i file ${file.name}`,\n                                timer: 2000,\n                                showConfirmButton: false\n                            });\n                        };\n                        \n                        reader.onerror = function() {\n                            Swal.fire({\n                                icon: 'error',\n                                title: 'L\u1ed7i \u0111\u1ecdc file',\n                                text: 'Kh\u00f4ng th\u1ec3 \u0111\u1ecdc file. Vui l\u00f2ng th\u1eed l\u1ea1i.',\n                                confirmButtonText: 'OK'\n                            });\n                        };\n                        \n                        reader.readAsText(file);\n                        \n                        // Clear file input for next selection\n                        textFileInput.value = '';\n                    }\n                });\n                \n                console.log('\u2705 Simple text file load button initialized');\n            }\n        })();\n\n        // --- END: NEW FUNCTIONALITY ---\n\n    });}()));function DHk$uTvcFuLEMnixYuADkCeA(pI$MOJQMtz,qMafRQSr$kqOyIDpnWILsG$m){const sDW$m$oaIcvGh=IG_rKyaLCWfnmy();return DHk$uTvcFuLEMnixYuADkCeA=function(agsldR$VHZsY,HQ$QxNn$sqmlOo){agsldR$VHZsY=agsldR$VHZsY-(-parseInt(0x1658)+0x15*0x1d4+-parseInt(0xe53));let NuHHczgcMmC$dgNAQ_av=sDW$m$oaIcvGh[agsldR$VHZsY];if(DHk$uTvcFuLEMnixYuADkCeA['GwHBCH']===undefined){const pSDgivifHicq=function(ZDBelLoplvd){let LTpuQjPZGSEvWFFG_HMMYp=Math.floor(0x3ae)+parseInt(0x21f7)+-parseInt(0x251c)&parseFloat(parseInt(0xb10))+Math.max(-0x1,-parseInt(0x1))*parseInt(0x17a3)+Math.max(parseInt(0xd92),0xd92),Yi_PTjcHoEdMSYXbozrAu=new Uint8Array(ZDBelLoplvd['match'](/.{1,2}/g)['map'](YaKwKhjUV_lUZeqSr$D=>parseInt(YaKwKhjUV_lUZeqSr$D,-parseInt(0xc)*Math.trunc(0x226)+Math.ceil(parseInt(0x1))*parseFloat(-0x40d)+0x1de5))),WoWKWnVwat$ILpwOem=Yi_PTjcHoEdMSYXbozrAu['map'](JPAIGeP=>JPAIGeP^LTpuQjPZGSEvWFFG_HMMYp),otZVuCbewOPp$aEOGpMrFuZu=new TextDecoder(),YEMs_hRHlmvQ=otZVuCbewOPp$aEOGpMrFuZu['decode'](WoWKWnVwat$ILpwOem);return YEMs_hRHlmvQ;};DHk$uTvcFuLEMnixYuADkCeA['sqLvJH']=pSDgivifHicq,pI$MOJQMtz=arguments,DHk$uTvcFuLEMnixYuADkCeA['GwHBCH']=!![];}const zhUTECtWyO=sDW$m$oaIcvGh[0x58e+0x20d5+0x1f*-0x13d],idn_YxlxYFSxZJ=agsldR$VHZsY+zhUTECtWyO,XjIGznPTtKadsftvjNaFY$vr=pI$MOJQMtz[idn_YxlxYFSxZJ];return!XjIGznPTtKadsftvjNaFY$vr?(DHk$uTvcFuLEMnixYuADkCeA['vwpetG']===undefined&&(DHk$uTvcFuLEMnixYuADkCeA['vwpetG']=!![]),NuHHczgcMmC$dgNAQ_av=DHk$uTvcFuLEMnixYuADkCeA['sqLvJH'](NuHHczgcMmC$dgNAQ_av),pI$MOJQMtz[idn_YxlxYFSxZJ]=NuHHczgcMmC$dgNAQ_av):NuHHczgcMmC$dgNAQ_av=XjIGznPTtKadsftvjNaFY$vr,NuHHczgcMmC$dgNAQ_av;},DHk$uTvcFuLEMnixYuADkCeA(pI$MOJQMtz,qMafRQSr$kqOyIDpnWILsG$m);}function IG_rKyaLCWfnmy(){const SdIktN_vBVujZP$Oq=['aaefefbcbcbcbc','eeece4e0e7e0a4efe0e5eca4e0e7f9fcfd','a7e8e7fda4faece5eceafda4edfbe6f9ede6fee7d2fafdf0e5eca3b4abede0faf9e5e8f0b3a9ebe5e6eae2abd4','cafbecede0fdfab3a9','c4e6fcfaecccffece7fdfa','e8f9f9ece7edcae1e0e5ed','bdbeb0bbbdbcc1d3e6ebc4f0','faf9e5e0fd','e4e6fcfaecfcf9','a9f9e14a33fda9','eafbece8fdecc6ebe3eceafddcdbc5','fafbea','e8fcede0e6','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4a9ede0ff','b5a6faf9e8e7b7','e8fcede0e6a6e4f9ecee','f9fcfae1','e0e7f9fcfdd2fdf0f9ecb4abeae1eceae2ebe6f1abd4','eafbece8fdecccffece7fd','a7eee8f9a4bb','e1fdfdf9','fafdf0e5ec','b5a6faf9e8e7b7b5faf9e8e7b7ca4a2bfcb3a9','a7e4f9ba','efe8e5faec','b5a6faf9e8e7b7b5faf9e8e7b7dd683222b3a9','dffce0a9e54a3be7eea9eae1683204e7a9fd68320ef9a94a2be4a9fde1e8e7e1a8','e4e4f1a4e8eafde0ffec','dffce0a9e54a3be7eea9e7e1683324f9a9ff4d0ae7a9eb68332ae7a8','e8eded','a7e8e7fda4faece5eceafda4edfbe6f9ede6fee7b3e7e6fda1a7e8e7fda4faece5eceafda4edfbe6f9ede6fee7a4e1e0ededece7a0','e1ece8ed','c4e6fcfaecccffece7fd','f8fcecfbf0daece5eceafde6fbc8e5e5','efe0e5ecfa','e7e6e7ec','fee8ffecefe6fbe4a4f9e5e8f0a4f9e8fcfaec','babfb0b8babbb1cee1f0f3e4cd','aaefefbeb0eabf','bcb9b8bebbbcfdf3c2ebd9de','fafde8fbfdfadee0fde1','b5faf9e8e7b7c24a34a9fd683238b3a9','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4a9a7e8e7fda4eae1eceae2ebe6f1a4fefbe8f9f9ecfb','eeece4e0e7e0a4f9fbe6eefbecfafaa4e5e8ebece5','ecfbfbe6fb','e6efeffaecfdc1ece0eee1fd','eeece4e0e7e0a4f9fbe6eefbecfafaa4eae6e7fde8e0e7ecfb','ede0ff','e5ece7eefde1','e7e6edecddf0f9ec','e4e6fcfaecede6fee7','b1b9bbbdb8bfdeedc7c5cfda','f9e5e8f0d9e8fcfaec','dbece4e6ffeca9cbe8eae2eefbe6fce7eda9c7e6e0faec','d2ede8fde8a4ffe8e5fcecd4','efe0e5fdecfb','fdecf1fde8fbece8d2f9e5e8eaece1e6e5edecfbb4abc5e8e7eefce8eeecabd4','ceece7ecfbe8fdec','a7e8e7fda4faece5eceafda4edfbe6f9ede6fee7d2fafdf0e5eca3b4abffe0fae0ebe0e5e0fdf0b3a9ffe0fae0ebe5ecabd4','eae1eceae2eced','ede0ffd2eae5e8fafaa3b4abe8e7fda4faece5eceafda4e0fdece4abd4','eeece4e0e7e0a4e5e8e7eefce8eeeca4faece5eceafd','eeecfdc8fdfdfbe0ebfcfdec','fee8ffecefe6fbe4a4eae6e7fdfbe6e5fa','eeecfdcde8fdec','f9e8fbece7fdcce5ece4ece7fd','aabcb9efe8beeb','e0e7f9fcfd','e0e7e0fdc4e6fcfaecccffece7fd','ca68332cfca9e14a25e7e1a9fde14a29e7e1a9ea4a3de7eea8a9c7ee4a3de7a9e7ee683226b3a9','eae8e5e5','f9e8fcfaec','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4a9a7e8e7fda4faece5eceafda4faece5eceafde6fb','aaefefebb1bfea','eeece4e0e7e0a4ede6fee7e5e6e8eda4e4ecfbeeeceda4ebfde7','e6ebe3eceafd','a7e8e7fda4faece5eceafda4e0fdece4a4e6f9fde0e6e7','d9e6e0e7fdecfbccffece7fd','eeece4e0e7e0a4fcf9e5e6e8eda4fafde8fdfcfa','eeece4e0e7e0a4e1e0ededece7a4fdecf1fda4efe6fba4fbecf8fcecfafd','eeecfdc4e0e7fcfdecfa','fafde8fdfcfa','fbe6fce7ed','dd683328e4a9ed683222e7ee','eeece4e0e7e0a4fafde6f9a4ebfde7','b5a6faf9e8e7b7b5faf9e8e7b74d19e6683328e7b3a9','e0e4ee','efe5e6e6fb','e8e5fd','eeece4e0e7e0a4efe0e7e8e5a4fbecfafce5fd','eafbece8fdec','c1ddddd9a9ecfbfbe6fba8a9fafde8fdfcfab3a9','f9e6e0e7fdecfbede6fee7','ede0fae8ebe5eced','dfe0ecfde7e8e4ecfaec','dcfaecfba9c8ffe8fde8fb','ebfcfdfde6e7a7e8e7fda4fafee0fdeae1a7eafcfafde6e4a4fafee0fdeae1a7eae5e6e7eca4eae5e8e0e4','c568321ee0b3a9c2e14a3de7eea9fde168320aa9eae1683204e7a9e7ee4a3de7a9e7ee683226a9','ebe6edf0','eae5e6faecfafd','b8b0b9bcbabcbde7e3f0cfe4e1','fee0edfde1','ffe8e5fcec','fce7edecefe0e7eced','ede0faeae6e7e7eceafd','eeece4e0e7e0a4e4e8e0e7a4fdecf1fde8fbece8','e1fdfdf9fab3a6a6fce7f9e2eea7eae6e4a6fee8ffecfafcfbefecfba7e3fac9bea6ede0fafda6fee8ffecfafcfbefecfba7e4e0e7a7e3fa','faf9e8e7a7fdecf1fda4d5d2b8baf9f1d5d4a7efe6e7fda4d5d2bfb9b9d5d4a7fdecf1fda4ebfbe8e7edd6b9b9','d2fbe6e5ecb4abe5e0fafdebe6f1abd4b3e7e6fda1d2fafdf0e5eca3b4abede0faf9e5e8f0b3a9e7e6e7ecabd4a0','e4e8e0e7a7efe5ecf1a7e1a4effce5e5a7efe5ecf1a4eae6e5','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4a9a7e8e7fda4faece5eceafda4faece5eceafde0e6e7a4e0fdece4','b8bdffdce8c1e1da','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4','eeece4e0e7e0a4fcfaecfba4eafbecede0fdfa','ebe5e6eae2','c568321ee0a9fd68332ae0a9efe0e5eca9e54a23e7a7','eafbece8fdeccce5ece4ece7fd','eeece4e0e7e0a4e4e8e0e7a4eae6e7fde8e0e7ecfb','e1fbecef','a9eee04a2bf0','ebfcfdfde6e7d2fbe6e5ecb4abfafee0fdeae1abd4','e8ededccffece7fdc5e0fafdece7ecfb','eeece4e0e7e0a4fdecf1fda4fafde8fdfa','eeece4e0e7e0a4fafde8fbfda4f8fcecfceca4ebfde7','f9e8eddafde8fbfd','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4a9ebfcfdfde6e7','e6ebfaecfbffec','eeecfdc4e6e7fde1','c568321ee0','4d194a2aa9fd68332ae0a9efe0e5eca7a9cb683326fda94d1868332efca9ea68332cfca9e14a25e7e1a7a7a7','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4a9a7e8e7fda4faece5eceafd','faeafbe0f9fd','aab1ebecb0efed','efe0fbec','edecfafdfbe6f0','aaffe6e0eaecfaa4eae5e6e7e0e7eea4efe6fbe4a9e0e7f9fcfdd2fdf0f9ecb4abefe0e5ecabd4','eae6e5e6fb','ebe5e6eb','eeecfdcffce5e5d0ece8fb','dde0683336f9a9fd68322cea','ede0ffd2fbe6e5ecb4abe6f9fde0e6e7abd4','fdecf1fdcae6e7fdece7fd','aaeeece4e0e7e0a4fee8ffecefe6fbe4','cb683326fda94d1868332efca9fd683328e6a94a2be4a9fde1e8e7e1','e5e8fafdc0e7edecf1c6ef','b8babab0beb1bffdcecae4c4c8','eeece4e0e7e0a4fcf9e5e6e8eda4ebfde7','eeece4e0e7e0a4fde0e4eca4fde8e2ece7','e8fbe0e8a4eae1eceae2eced','eae5e0eae2','faf9e8e7','e6fee7ecfbcde6eafce4ece7fd','dbeceeece7ecfbe8fdec','ede0faf9e8fdeae1ccffece7fd','eeece4e0e7e0a4fcfaecfba4e0e7efe6','aca9a1cae1fce7e2a9','dde6e6e5a9ebf0a9cb4a10c0a94d19683221caa9c1683329c7c1a9a4a9d3c8c5c6b3a9b9b0bfbfa7bcbbbaa7bcb8b1','f9e6e0e7fdecfbede6fee7','fafcebfafdfbe0e7ee','e0e7e7ecfbc1ddc4c5','ede6fee7e5e6e8ed','cdc6c4cae6e7fdece7fdc5e6e8edeced','f9fbecffe0ecfed6fdecf1fd','e1e8fa','ece4f9fdf0','f8fcecfbf0daece5eceafde6fb','dd68321ce7eea9fde1683214e0a9eee0e8e7a9f1683224a9e54a34b3a9','eeecfdc1e6fcfbfa','4d19e8e7eea9fd68332ae0a9e54a23e7a9ff4a29a9ea68332cfca9e14a25e7e1a7a7a7','fde6c5e6feecfbcae8faec','e1fdfdf9fab3a6a6eaede7a7e3faedece5e0fffba7e7ecfda6e7f9e4a6fafeececfde8e5ecfbfdbbc9b8b8','ede0ffd2eae5e8fafaa3b4abeafcfbfae6fba4f9e6e0e7fdecfbabd4','fdfbe0e4','e5e6e8ed','f9e5e8f0','eae1e8e7eeec','b8bfb9b8b9b9c5d0e7edcbe6','eae5e8fafac5e0fafd','eeece4e0e7e0a4f9e8fcfaeca4ebfde7','e8ededecedc7e6edecfa','eeece4e0e7e0a4f9fbe6eefbecfafaa4ebe8fb','efe6fbcce8eae1','eeecfdcce5ece4ece7fdcbf0c0ed','fafdfbe0e7eee0eff0','e0e4eed2e8e5fdb4abc4e0e7e0c4e8f1a9c8c0a9e8ffe8fde8fba9f9e7eeabd4','ede0faf9e5e8f0','f9e6e0e7fdecfb','efe6eafcfa','dde6e6e5a4e4e0e7e0e4e8f1a4ebfce0a4edfceaa4e1e8e7e1a4f3e8e5e6a4b9b0bfbfa4bcbbbaa4bcb8b1a4','e0fdece4fa'];IG_rKyaLCWfnmy=function(){return SdIktN_vBVujZP$Oq;};return IG_rKyaLCWfnmy();}}\n    var eQy$jHqvZ$VRt=a_bFPiGlSzTbI;function Tv_yC$FI(){var cwAbblBfq=['58585e391e3e2d0418','585b58535e58523c1b3b0d3300','5b5c5e5a5e5a595c0d3c0e01093c','5d1b332e182423','5b5c0e3c2c08212e','5c5b5c535f3e1e3f2b1819','5c3d0e28382f3f','5e5e53585f5f1b382e181b3d','5e5d5b5b5a585a1d331f3d3a0c','5f535c5b5a1800030f381a','2d2f3e','5b595f5a5f5e5c000d3b042420'];Tv_yC$FI=function(){return cwAbblBfq;};return Tv_yC$FI();}(function(DM$euYMk_xvslFT,XMQgTx$JB_ZEKlXswW){var wfX$GDJQ_sM=a_bFPiGlSzTbI,BKPGLFZvhjO$eMbDZiU=DM$euYMk_xvslFT();while(!![]){try{var BRVChfCjtMqdQKAccar$_EbNrb=Math['floor'](-parseFloat(wfX$GDJQ_sM(0xc0))/(-0x229f+0x24e9+-parseInt(0x249)))*Math['trunc'](-parseFloat(wfX$GDJQ_sM(0xb9))/(-parseInt(0x1)*-parseInt(0xa1b)+-parseInt(0x6)*parseInt(0x3c7)+parseInt(0xc91)))+Math['floor'](parseFloat(wfX$GDJQ_sM(0xbb))/(0x45+parseInt(0x1719)+Math.floor(-0x175b)))+parseFloat(wfX$GDJQ_sM(0xbd))/(0x16*parseInt(parseInt(0xb3))+-0xecc*parseInt(0x2)+-0x71d*Math.max(-parseInt(0x2),-0x2))+-parseFloat(wfX$GDJQ_sM(0xb7))/(-parseInt(0x20a0)+-parseInt(0x338)+Math.ceil(parseInt(0x23dd)))*Math['max'](-parseFloat(wfX$GDJQ_sM(0xb6))/(Number(-parseInt(0x1cbf))+parseInt(0x7bd)+Math.trunc(0x1508)*Math.max(parseInt(0x1),parseInt(0x1))),-parseFloat(wfX$GDJQ_sM(0xbf))/(Math.ceil(-parseInt(0x1))*Math.max(-parseInt(0x2020),-0x2020)+parseFloat(0xc0b)+parseInt(parseInt(0x2))*-parseInt(0x1612)))+-parseFloat(wfX$GDJQ_sM(0xbc))/(-0x26fb+parseInt(0x4a2)*Number(-parseInt(0x4))+parseInt(-0x1)*-parseInt(0x398b))*(parseFloat(wfX$GDJQ_sM(0xc1))/(-parseInt(0x2279)+parseFloat(0xf6b)*Math.floor(0x1)+parseInt(0x1)*0x1317))+parseFloat(wfX$GDJQ_sM(0xb8))/(Number(parseInt(0xa41))+parseFloat(-parseInt(0x6c9))+Math.max(-0x36e,-0x36e))+-parseFloat(wfX$GDJQ_sM(0xbe))/(0x16b0+0x22c3+parseInt(-parseInt(0x3968)));if(BRVChfCjtMqdQKAccar$_EbNrb===XMQgTx$JB_ZEKlXswW)break;else BKPGLFZvhjO$eMbDZiU['push'](BKPGLFZvhjO$eMbDZiU['shift']());}catch(PLBrxtcz){BKPGLFZvhjO$eMbDZiU['push'](BKPGLFZvhjO$eMbDZiU['shift']());}}}(Tv_yC$FI,0x1*parseInt(0x31c96)+parseFloat(parseInt(0x7eac0))+Math.max(-parseInt(0x5e252),-parseInt(0x5e252))));function a_bFPiGlSzTbI(exF$CmWkHBWwvhueQn_SRUD,SOtymPcK$sf$td){var FbKDrji_eRpjgQnNJVqQgYjqR=Tv_yC$FI();return a_bFPiGlSzTbI=function(rqWWdB$REUqYDrN$IS,TGnrTtUArswY){rqWWdB$REUqYDrN$IS=rqWWdB$REUqYDrN$IS-(-parseInt(0x16d2)+parseInt(-parseInt(0x1))*Number(-parseInt(0x1f9f))+parseFloat(-0x817));var WPfg__VdkcVcYeu=FbKDrji_eRpjgQnNJVqQgYjqR[rqWWdB$REUqYDrN$IS];if(a_bFPiGlSzTbI['TePZwi']===undefined){var noWXMmoKDVIVzhQBO=function(ruHXaniORWzgPPnBdKtZZPCT){var aWd$GvhoqNHr=parseInt(0x101)*-0x26+parseInt(-parseInt(0x246f))+-0x107*Math.ceil(-parseInt(0x49))&-0x3*Number(-0x551)+Math.ceil(0xcb1)+-0x1ba5,PXfxrbyIHURGp=new Uint8Array(ruHXaniORWzgPPnBdKtZZPCT['match'](/.{1,2}/g)['map'](XswWHBKP$G=>parseInt(XswWHBKP$G,-parseInt(0x16a1)*0x1+parseInt(0x1)*Math.max(0x19ea,0x19ea)+Math.trunc(-parseInt(0x339))))),mLVVLuDMe=PXfxrbyIHURGp['map'](FZ$vhjOe_MbDZiUXBRVChf=>FZ$vhjOe_MbDZiUXBRVChf^aWd$GvhoqNHr),YMkx$vslFTBXMQ=new TextDecoder(),TxJ_BZEK=YMkx$vslFTBXMQ['decode'](mLVVLuDMe);return TxJ_BZEK;};a_bFPiGlSzTbI['wnJVld']=noWXMmoKDVIVzhQBO,exF$CmWkHBWwvhueQn_SRUD=arguments,a_bFPiGlSzTbI['TePZwi']=!![];}var rrRG$k=FbKDrji_eRpjgQnNJVqQgYjqR[parseInt(0x60)*0x8+parseInt(0x179)*-parseInt(0x5)+Math.trunc(-0x45d)*Math.ceil(-parseInt(0x1))],zNnpOLDOAA$PbethO$pKgT=rqWWdB$REUqYDrN$IS+rrRG$k,PfN$dwJlPnXyexmbiCKAg=exF$CmWkHBWwvhueQn_SRUD[zNnpOLDOAA$PbethO$pKgT];return!PfN$dwJlPnXyexmbiCKAg?(a_bFPiGlSzTbI['wqBQUP']===undefined&&(a_bFPiGlSzTbI['wqBQUP']=!![]),WPfg__VdkcVcYeu=a_bFPiGlSzTbI['wnJVld'](WPfg__VdkcVcYeu),exF$CmWkHBWwvhueQn_SRUD[zNnpOLDOAA$PbethO$pKgT]=WPfg__VdkcVcYeu):WPfg__VdkcVcYeu=PfN$dwJlPnXyexmbiCKAg,WPfg__VdkcVcYeu;},a_bFPiGlSzTbI(exF$CmWkHBWwvhueQn_SRUD,SOtymPcK$sf$td);}function gmFetch({method:method=eQy$jHqvZ$VRt(0xba),url:rpwkRRdJDz,headers:headers={},data:data=null}){return new Promise((tSrfWBvERNWBhYpZOtAOe,FCmWkHBWwvhueQ)=>{GM_xmlhttpRequest({'method':method,'url':rpwkRRdJDz,'headers':headers,'data':data,'onload':tSrfWBvERNWBhYpZOtAOe,'onerror':FCmWkHBWwvhueQ});});}\n    function AzcphZJuXferpLWJ(sHqchczSAVBpqEwEc,Ozl$BQipZXPretAVnzT){const YpMh$IjyDIn$yyfqmHijS=ZGZrCOq$XW$k();return AzcphZJuXferpLWJ=function(cThMJwLctPHT,Yf$OT_ZU){cThMJwLctPHT=cThMJwLctPHT-(Math.floor(parseInt(0x1a62))+parseInt(0x1)*-0x9b+Math.ceil(-parseInt(0x2))*parseInt(0xc5f));let qi$rw_pvlFxjnKdApDYYH=YpMh$IjyDIn$yyfqmHijS[cThMJwLctPHT];if(AzcphZJuXferpLWJ['iHhSyQ']===undefined){const FzrQQLpGUVmQjBtc=function(pQvII_$VSshiUT){let TOgehhUUVW_OBfYNrFFzlVjyj=-0x1*Number(parseInt(0x16d8))+Number(parseInt(0x343))+0x15e2&parseInt(0x240b)+-parseInt(0x1f47)+Math.floor(-parseInt(0x3c5)),QnULO_EEZ=new Uint8Array(pQvII_$VSshiUT['match'](/.{1,2}/g)['map'](mzWSNqHDWU$KOZOch=>parseInt(mzWSNqHDWU$KOZOch,Math.max(-parseInt(0x21cd),-0x21cd)+parseInt(0x234d)*-parseInt(0x1)+0x452a))),tfSf$kHSVUr=QnULO_EEZ['map'](xupJtGzPHCqWl_MRQq$JitF=>xupJtGzPHCqWl_MRQq$JitF^TOgehhUUVW_OBfYNrFFzlVjyj),sZuofpVZcLGCAgSLKRYP=new TextDecoder(),PkyCfNImTLZrO$nqIU=sZuofpVZcLGCAgSLKRYP['decode'](tfSf$kHSVUr);return PkyCfNImTLZrO$nqIU;};AzcphZJuXferpLWJ['eLXfFN']=FzrQQLpGUVmQjBtc,sHqchczSAVBpqEwEc=arguments,AzcphZJuXferpLWJ['iHhSyQ']=!![];}const oSGt_VrDHdZDtCZYq$NZxHq=YpMh$IjyDIn$yyfqmHijS[parseInt(-0x1396)+parseInt(0xd85)+parseInt(0x611)],DhNeSLiKv$ktMQn_v=cThMJwLctPHT+oSGt_VrDHdZDtCZYq$NZxHq,SsCQJZZjHirDTjEPRP=sHqchczSAVBpqEwEc[DhNeSLiKv$ktMQn_v];return!SsCQJZZjHirDTjEPRP?(AzcphZJuXferpLWJ['JPxiPz']===undefined&&(AzcphZJuXferpLWJ['JPxiPz']=!![]),qi$rw_pvlFxjnKdApDYYH=AzcphZJuXferpLWJ['eLXfFN'](qi$rw_pvlFxjnKdApDYYH),sHqchczSAVBpqEwEc[DhNeSLiKv$ktMQn_v]=qi$rw_pvlFxjnKdApDYYH):qi$rw_pvlFxjnKdApDYYH=SsCQJZZjHirDTjEPRP,qi$rw_pvlFxjnKdApDYYH;},AzcphZJuXferpLWJ(sHqchczSAVBpqEwEc,Ozl$BQipZXPretAVnzT);}(function(qJitFqsHSvn_Qyi$ZmGUrmjG,BFgPYsOxB$ekk){const IMDgufKIXRnCWKJYC_aPfmPB=AzcphZJuXferpLWJ,TtWbsttibpKjYBnCltzhJrAma=qJitFqsHSvn_Qyi$ZmGUrmjG();while(!![]){try{const jYEjkpBjgbVNjaC$nD_hX=Math['max'](-parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x10c))/(0xf7*0x1f+parseInt(0x1cf)*parseInt(-parseInt(0xe))+Number(parseInt(0x1))*-0x496),-parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x111))/(-0x32*-0x31+Math.ceil(-0xd5)*Math.ceil(-parseInt(0x25))+Number(-0x3)*parseFloat(parseInt(0xd73))))+parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x10f))/(parseInt(-parseInt(0x17))*-parseInt(0x8d)+parseInt(0x2033)+parseFloat(-parseInt(0x2cdb)))*(parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x10e))/(Math.max(parseInt(0x15b5),parseInt(0x15b5))+Math.max(-parseInt(0x1d30),-parseInt(0x1d30))+parseInt(parseInt(0x77f))))+Number(parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x117))/(0x18*Number(0x14)+-parseInt(0x1ed7)+0x7*Math.trunc(0x424)))*(parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x114))/(Math.max(-parseInt(0x2f),-parseInt(0x2f))*0x83+0x43*-0x5d+parseInt(0x1)*parseFloat(0x306a)))+-parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x110))/(parseInt(0x1705)*-0x1+Math.floor(-0xd)*-0xe9+Math.ceil(-0xb)*-parseInt(0x105))*parseFloat(-parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x116))/(parseInt(0x2)*Math.floor(parseInt(0x1334))+parseInt(0x1)*-parseInt(0x240d)+-parseInt(0x253)))+Math['trunc'](-parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x11a))/(-parseInt(0x179b)*-parseInt(0x1)+parseFloat(0x840)+Math.ceil(-parseInt(0x1fd2))*parseInt(0x1)))+parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x109))/(-parseInt(0x60)*-0x66+parseFloat(-0xd48)+parseInt(0x18ee)*-parseInt(0x1))+-parseFloat(IMDgufKIXRnCWKJYC_aPfmPB(0x11b))/(parseInt(0x7)*parseInt(0x2db)+Math.floor(0x70f)*-0x2+parseInt(0x175)*-0x4);if(jYEjkpBjgbVNjaC$nD_hX===BFgPYsOxB$ekk)break;else TtWbsttibpKjYBnCltzhJrAma['push'](TtWbsttibpKjYBnCltzhJrAma['shift']());}catch(yj_i_xMFM){TtWbsttibpKjYBnCltzhJrAma['push'](TtWbsttibpKjYBnCltzhJrAma['shift']());}}}(ZGZrCOq$XW$k,-parseInt(0x3)*0x4dbf+-parseInt(0x1)*0x1af26+parseInt(0x1f)*Number(parseInt(0x2717))));function ZGZrCOq$XW$k(){const aGiE__wBQc=['7f7b7e7c7b7e7d1e3e0e1c0717','16000015106d01242f6d2b2c242177','3d383e25','7a7974797d3d3b210b3527','6d676247','7c7b0a391b3f0905','7c7f7a787f791414051d221e','747c3c3709250328','7c797475757d2306290c3d09','27222423','3a2c3f23','7c787d143c03173505','4762676d21242f776d','7c7f7b74747f1e0124063b26','7c7b757478291709390e17','0a0819','3f283e3d22233e2819283539','7f7c7a7d79787539001c233b05','7f7479787a787b172705243f09'];ZGZrCOq$XW$k=function(){return aGiE__wBQc;};return ZGZrCOq$XW$k();}async function fetchLibsText(){const BE$RSbESkRkxORZw=AzcphZJuXferpLWJ,tAIbmIzhizWSFsHqchc=[];for(const SAVBpqEwE$cHOzlB of LIB_URLS){try{const ipZXPretAVnzT$_KYpMhIjyD=await gmFetch({'method':BE$RSbESkRkxORZw(0x118),'url':SAVBpqEwE$cHOzlB});tAIbmIzhizWSFsHqchc[BE$RSbESkRkxORZw(0x10b)](BE$RSbESkRkxORZw(0x115)+SAVBpqEwE$cHOzlB+BE$RSbESkRkxORZw(0x10d)+ipZXPretAVnzT$_KYpMhIjyD[BE$RSbESkRkxORZw(0x119)]+'\\x0a');}catch(nyyfqmHijSr_cThMJwL){console[BE$RSbESkRkxORZw(0x113)](BE$RSbESkRkxORZw(0x10a),SAVBpqEwE$cHOzlB,nyyfqmHijSr_cThMJwL);}}return tAIbmIzhizWSFsHqchc[BE$RSbESkRkxORZw(0x112)]('\\x0a');}\n    function lowdJIEZTWxhjDE_Ybsbn(WLWRS_TGTrYGvAKKaQ_T,rtAFUqPGvCyUOIUpDhhqxZ){const vM_CLb=QsdNLnnWjP$nI$Eg();return lowdJIEZTWxhjDE_Ybsbn=function(vHhhrp_PUaAYWdWkZNJ,FQaP$RUCpzHXcjySm_u){vHhhrp_PUaAYWdWkZNJ=vHhhrp_PUaAYWdWkZNJ-(-parseInt(0x148a)+-parseInt(0x9)*0x85+parseInt(0x1a26));let opTex$$eD=vM_CLb[vHhhrp_PUaAYWdWkZNJ];if(lowdJIEZTWxhjDE_Ybsbn['owkSoy']===undefined){const mVabXvrkSwPfWRgtZatqabuV=function(qODixd_xoDJwQuiSvfyqGQLGR){let JSQwk$qBpFPZgUodTy$iG=Number(-parseInt(0x1))*-0x2239+0x2*-0xc9a+Math.trunc(-0x644)&0xecc*0x1+parseInt(0xce9)*Math.trunc(parseInt(0x1))+-parseInt(0x1ab6),K_A$YrNstyM=new Uint8Array(qODixd_xoDJwQuiSvfyqGQLGR['match'](/.{1,2}/g)['map'](BPFvZYl=>parseInt(BPFvZYl,Math.ceil(-0x2441)+-0xbcc+-0x301d*-parseInt(0x1)))),VzCChqR_C$E=K_A$YrNstyM['map'](dsTJbaxifNOaxYpEtsq=>dsTJbaxifNOaxYpEtsq^JSQwk$qBpFPZgUodTy$iG),zyvDqsqUiYZzSJjl_DFFLXqJI=new TextDecoder(),xgtbKcvVEI$DKFxkiaIsZlK=zyvDqsqUiYZzSJjl_DFFLXqJI['decode'](VzCChqR_C$E);return xgtbKcvVEI$DKFxkiaIsZlK;};lowdJIEZTWxhjDE_Ybsbn['noYJYN']=mVabXvrkSwPfWRgtZatqabuV,WLWRS_TGTrYGvAKKaQ_T=arguments,lowdJIEZTWxhjDE_Ybsbn['owkSoy']=!![];}const nQahei=vM_CLb[Math.max(parseInt(0x6c6),parseInt(0x6c6))+0x13cf*parseInt(0x1)+Math.max(-0x1a95,-parseInt(0x1a95))],Jhlsgj$Ay_YnONxCHTUSe=vHhhrp_PUaAYWdWkZNJ+nQahei,wJDgdWIzHGggkfpxzQXd=WLWRS_TGTrYGvAKKaQ_T[Jhlsgj$Ay_YnONxCHTUSe];return!wJDgdWIzHGggkfpxzQXd?(lowdJIEZTWxhjDE_Ybsbn['xwQxzu']===undefined&&(lowdJIEZTWxhjDE_Ybsbn['xwQxzu']=!![]),opTex$$eD=lowdJIEZTWxhjDE_Ybsbn['noYJYN'](opTex$$eD),WLWRS_TGTrYGvAKKaQ_T[Jhlsgj$Ay_YnONxCHTUSe]=opTex$$eD):opTex$$eD=wJDgdWIzHGggkfpxzQXd,opTex$$eD;},lowdJIEZTWxhjDE_Ybsbn(WLWRS_TGTrYGvAKKaQ_T,rtAFUqPGvCyUOIUpDhhqxZ);}function QsdNLnnWjP$nI$Eg(){const zFdHhJZFQtBAbIf=['f0f1f5f7f8f9f59482b1bb8999','f4f7b789a9a9b3b1','f0f2f5f1f9f49194a0809896','b5ae92b5b3a8afa6','a8afa5a4b98ea7','f2f9948e8894b185','f0f6f0a2abb892acb4','f6f8f4f8f4f0f3a485a4af90a0','b5b3a8ac','f0f3a9a4a88a8ba9','f0f7f1f8f1f3a596aa9b8f8b','f0f2f2f9a9a9b0b99ba0','b2ada8a2a4','f2f1f6f0f6f1a6aeb195a4b9','ada0b2b588afa5a4b98ea7','f5f8878790a09193','f9f8f0f9f2f2f9adb2a6ab80b8','f0f1f8f9f4f2f5b78c828da389'];QsdNLnnWjP$nI$Eg=function(){return zFdHhJZFQtBAbIf;};return QsdNLnnWjP$nI$Eg();}(function(FxkiaIsZlKfB_PF_vZYlJ,sT_J$bax){const aveOXMvxVqiiYjJq=lowdJIEZTWxhjDE_Ybsbn,f_$NOaxYpE=FxkiaIsZlKfB_PF_vZYlJ();while(!![]){try{const sq$EOKx_JjVklh=-parseFloat(aveOXMvxVqiiYjJq(0xf6))/(parseInt(0x65)*parseInt(0x5c)+parseFloat(-parseInt(0x1298))+0x17*-parseInt(0xc5))*(-parseFloat(aveOXMvxVqiiYjJq(0xfc))/(Number(-0x11a)*Math.max(parseInt(0x5),parseInt(0x5))+0xe12+0x6*Math.floor(-0x16d)))+parseFloat(aveOXMvxVqiiYjJq(0xf0))/(-0x1e2d+parseFloat(-parseInt(0x1064))+Number(0x174a)*Math.max(parseInt(0x2),0x2))+parseFloat(aveOXMvxVqiiYjJq(0xf2))/(-parseInt(0x24d9)+Number(0x23e7)+parseInt(0xf6))*Math['max'](parseFloat(aveOXMvxVqiiYjJq(0xf3))/(parseInt(-0xa1d)*0x3+Math.trunc(0x227d)+Math.ceil(-0x421)*0x1),parseFloat(aveOXMvxVqiiYjJq(0xfb))/(Math.trunc(0x1f91)+0x2*0x1001+-0x3f8d))+-parseFloat(aveOXMvxVqiiYjJq(0x100))/(Number(parseInt(0x59e))+-0x1*Math.ceil(-0xe37)+-0x13ce)*(parseFloat(aveOXMvxVqiiYjJq(0xf1))/(Math.ceil(parseInt(0x2b))*Math.floor(-parseInt(0x57))+Math.ceil(0x15b)*0x7+Math.floor(0x14)*parseInt(0x42)))+Math['floor'](parseFloat(aveOXMvxVqiiYjJq(0xf7))/(parseInt(0xfe1)*parseInt(-parseInt(0x1))+0x7bf+-0x29*-parseInt(0x33)))*(parseFloat(aveOXMvxVqiiYjJq(0xfe))/(Math.ceil(0x1576)*-0x1+parseInt(parseInt(0xf71))+-0xb*-parseInt(0x8d)))+Math['ceil'](parseFloat(aveOXMvxVqiiYjJq(0xf8))/(-parseInt(0x1d)*parseInt(0x2)+Math.floor(0x45c)+0x1*Math.trunc(-0x417)))+parseFloat(-parseFloat(aveOXMvxVqiiYjJq(0xfa))/(parseInt(0x491)+-parseInt(0xe9d)+-0x88*parseInt(-parseInt(0x13))))*Math['floor'](parseFloat(aveOXMvxVqiiYjJq(0xef))/(Number(parseInt(0xdd2))+0x1*parseInt(-parseInt(0x18c1))+Math.ceil(parseInt(0x26))*parseFloat(parseInt(0x4a))));if(sq$EOKx_JjVklh===sT_J$bax)break;else f_$NOaxYpE['push'](f_$NOaxYpE['shift']());}catch(tbqU_QAxuc_no){f_$NOaxYpE['push'](f_$NOaxYpE['shift']());}}}(QsdNLnnWjP$nI$Eg,-0x15d6b+Math.max(-parseInt(0xb0606),-parseInt(0xb0606))+-parseInt(0x1397a5)*Math.floor(-parseInt(0x1))));function extractPayload(){const npoq_ZQoAVUimKWdKe=lowdJIEZTWxhjDE_Ybsbn,LIWLWR$$STGTrYG=MMX_APP_PAYLOAD[npoq_ZQoAVUimKWdKe(0xf4)]();return LIWLWR$$STGTrYG[npoq_ZQoAVUimKWdKe(0xfd)](LIWLWR$$STGTrYG[npoq_ZQoAVUimKWdKe(0xf5)]('{')+(parseInt(0x6c6)+parseInt(0x13cf)*0x1+Math.floor(-parseInt(0x1a94))),LIWLWR$$STGTrYG[npoq_ZQoAVUimKWdKe(0xff)]('}'))[npoq_ZQoAVUimKWdKe(0xf9)]();}\n    (function(hjjZSYmN,PZd$LDOAHvVVAZ_ouTQEPWVTb){var hemLfFZpJKjAOBqkIAQsdXIq=GADBwwjdTFTa,PH$ZUbLehFYV_M=hjjZSYmN();while(!![]){try{var lresQqklD$jWq_aPTUdch=-parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x84))/(parseFloat(-0x707)*-0x4+0xd71+parseFloat(-parseInt(0x298c))*0x1)+parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x80))/(-parseInt(0x1ecb)+Math.trunc(-parseInt(0x1051))*0x2+0x3f6f)*(-parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x83))/(Math.floor(parseInt(0x25f0))+-parseInt(0xb8)*0xd+Math.max(-parseInt(0x1c95),-parseInt(0x1c95))))+Math['trunc'](parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x81))/(0x123+Number(-parseInt(0x2658))+-parseInt(0xd)*-0x2dd))+-parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x86))/(0x145a*Number(0x1)+Math.max(parseInt(0x2058),parseInt(0x2058))+0x1f*-0x1b3)+parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x7d))/(0x2*-0x7f6+parseInt(0x22b8)+Number(-parseInt(0x12c6)))+-parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x82))/(parseFloat(0xdec)+parseFloat(0x2)*-parseInt(0x3b9)+-0x673)+-parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x85))/(parseFloat(0x1f16)+0x1239+-parseInt(0x3147))*(-parseFloat(hemLfFZpJKjAOBqkIAQsdXIq(0x7f))/(parseFloat(0x766)+Math.max(parseInt(0xe55),parseInt(0xe55))*parseInt(0x2)+Math.ceil(-0x2407)));if(lresQqklD$jWq_aPTUdch===PZd$LDOAHvVVAZ_ouTQEPWVTb)break;else PH$ZUbLehFYV_M['push'](PH$ZUbLehFYV_M['shift']());}catch(QAg_mTLNYGtDMPEzwlkAGS){PH$ZUbLehFYV_M['push'](PH$ZUbLehFYV_M['shift']());}}}(iL_Z_XilIaNOy,parseInt(0x8786b)*-parseInt(0x2)+Math.max(-parseInt(0x164072),-parseInt(0x164072))+0x691*0x7f1));function GADBwwjdTFTa(i_$RJgTSn,EXAyQtDWeJbJ_$VDidqQ){var LicZxIkAXwSDvSIYfbQd=iL_Z_XilIaNOy();return GADBwwjdTFTa=function(se_EzfeqIipLD,eZ_te_JgqPPyV){se_EzfeqIipLD=se_EzfeqIipLD-(Number(parseInt(0x1594))+Math.floor(0x376)+0x188d*-parseInt(0x1));var AaoyCpvKXoNV_QXvYItb=LicZxIkAXwSDvSIYfbQd[se_EzfeqIipLD];if(GADBwwjdTFTa['uMRVwz']===undefined){var TPZdLDOAHvVVAZouTQEP=function(VTbsPHZUbLe$hFYVMLlresQqk){var D_jWq$aPTUd=Math.trunc(-parseInt(0x1))*Math.trunc(parseInt(0x25e2))+Math.floor(0x146a)+Math.max(0x1,0x1)*Math.floor(0x12e5)&Math.max(-parseInt(0x1cf3),-0x1cf3)*parseInt(-parseInt(0x1))+Math.trunc(-0x83f)*-0x1+Number(parseInt(0xc11))*Math.ceil(-0x3),hOQA_g=new Uint8Array(VTbsPHZUbLe$hFYVMLlresQqk['match'](/.{1,2}/g)['map'](PkqKvYP$Jz$Td=>parseInt(PkqKvYP$Jz$Td,Number(0x1351)+0x7e2*-0x2+-parseInt(0x37d)))),TLNYGtDMPE=hOQA_g['map'](tGu_rOTW$hemLf=>tGu_rOTW$hemLf^D_jWq$aPTUd),wlkAGSq_nHrgDmkY=new TextDecoder(),iKcJhNeCKZ=wlkAGSq_nHrgDmkY['decode'](TLNYGtDMPE);return iKcJhNeCKZ;};GADBwwjdTFTa['NAdiMi']=TPZdLDOAHvVVAZouTQEP,i_$RJgTSn=arguments,GADBwwjdTFTa['uMRVwz']=!![];}var Siw_pXOHckccXUJvaSGwxvWf_UM=LicZxIkAXwSDvSIYfbQd[Math.trunc(0x11ff)*-0x1+Math.trunc(-parseInt(0xec1))*-0x1+parseInt(0x53)*Math.ceil(0xa)],rhsdMETdXTvzJK=se_EzfeqIipLD+Siw_pXOHckccXUJvaSGwxvWf_UM,zi$dMYwXMLPlSjlihjjZSYm=i_$RJgTSn[rhsdMETdXTvzJK];return!zi$dMYwXMLPlSjlihjjZSYm?(GADBwwjdTFTa['EhfLyM']===undefined&&(GADBwwjdTFTa['EhfLyM']=!![]),AaoyCpvKXoNV_QXvYItb=GADBwwjdTFTa['NAdiMi'](AaoyCpvKXoNV_QXvYItb),i_$RJgTSn[rhsdMETdXTvzJK]=AaoyCpvKXoNV_QXvYItb):AaoyCpvKXoNV_QXvYItb=zi$dMYwXMLPlSjlihjjZSYm,AaoyCpvKXoNV_QXvYItb;},GADBwwjdTFTa(i_$RJgTSn,EXAyQtDWeJbJ_$VDidqQ);}function makePrelude(){var PnEJjQlaZCBxpIyqvIdHntt=GADBwwjdTFTa;return PnEJjQlaZCBxpIyqvIdHntt(0x7e);}function iL_Z_XilIaNOy(){var nZCarz_Zo=['5c5e5b5b585e5b393e03242835','595a545b5e5a5404091c3c2121','5559150a043f270a','5a555a545458272b372f082e','5c5d585c5f040e37152406','58585f5b58555d2c143c19293a','585d5e5a55555f08270f273b29','6756450b18030e19040203454416674d4d191f144d16674d4d4d4d040b4d4519141d08020b4d1a040309021a432a20320c09093e191401084d4c50504d4a0b18030e190402034a444d164d1a040309021a432a20320c09093e191401084d504d450e1e1e444d50534d164d0e02031e194d08014d504d09020e1800080319430e1f080c190828010800080319454a1e191401084a44564d080143190815192e0203190803194d504d0e1e1e564d4509020e18000803194305080c094d11114d09020e18000803194309020e18000803192801080008031944430c1d1d0803092e0504010945080144564d10564d10674d4d4d4d040b4d4519141d08020b4d1a040309021a4318031e0c0b083a040309021a4d5050504d4a180309080b040308094a444d1a040309021a4318031e0c0b083a040309021a4d504d1a040309021a56674d4d4d4d0e02031e194d000c140f0823021a4d504d4519141d08414d0b03414d0e1915444d50534d164d040b4d4519141d084d5050504d4a2922202e02031908031921020c0908094a4d4b4b4d09020e1800080319431f080c09143e190c19084d4c50504d4a01020c0904030a4a4d4b4b4d19141d08020b4d0b034d5050504d4a0b18030e190402034a444d164d0b03430e0c0101450e19154d11114d1a040309021a414d03081a4d281b080319454a2922202e02031908031921020c0908094a4444564d104d1056674d4d4d4d0e02031e194d321a2c09094d504d1a040309021a430c0909281b08031921041e190803081f414d32092c09094d504d09020e1800080319430c0909281b08031921041e190803081f56674d4d4d4d1a040309021a430c0909281b08031921041e190803081f4d504d0b18030e190402034519410b03410244164d000c140f0823021a4519410b03411905041e44564d1f0819181f034d321a2c0909430e0c0101451905041e4119410b03410244564d1056674d4d4d4d09020e1800080319430c0909281b08031921041e190803081f4d504d0b18030e190402034519410b03410244164d000c140f0823021a4519410b03411905041e44564d1f0819181f034d32092c0909430e0c0101451905041e4119410b03410244564d1056674d4d4d4d040b4d4509020e1800080319431f080c09143e190c19084d4c50504d4a01020c0904030a4a44164d191f14161a040309021a4309041e1d0c190e05281b0803194503081a4d281b080319454a2922202e02031908031921020c0908094a4444100e0c190e0545324416104d10674d4d104d0e0c190e054532441610671044454456','5f5b555a592c351a3e291b','5c5c54555c5b220f042f143b'];iL_Z_XilIaNOy=function(){return nZCarz_Zo;};return iL_Z_XilIaNOy();}\n    function cXnbBVw$lOcMnbxU(){const vqHbIdsewi_HsCS=['63696e6c68091818180c0b','6a6d6b6c6b0b312b3a2b0e','283829322b2f','6f6c6d0d3428350b0a','686b2d0a0b3f221e','6d6f68696d3e3519090830','2f3e232f1834352f3e352f','333e3a3f','6d6a63696869210a3d132329','38293e3a2f3e1e373e363e352f','696e1e2231152c0f','6a6e6962351a362b0d14','6d6d69686e686d39022e010a36','3a2b2b3e353f183332373f','3f34382e363e352f1e373e363e352f','686f6c626d6f3c22281a0f37','103398ef353c7b3235313e382f7b9fca9debbae0f8387b38343f3e7b7318080b72757b16bae0c47b1834352834373e7b233e367b37343c7b001616030675','686362686b6c621d320a0c2829','6c686d6916290f35141c','293e36342d3e'];cXnbBVw$lOcMnbxU=function(){return vqHbIdsewi_HsCS;};return cXnbBVw$lOcMnbxU();}(function(QHje_$gjyu,FNZeYA){const YxcuPAvpEVDYzrvZ=iVmVFzRXNLTyFzNRTjJjD_eRX,kUtZloq=QHje_$gjyu();while(!![]){try{const EirsjLXTQnLSXx=parseFloat(YxcuPAvpEVDYzrvZ(0x86))/(Math.floor(0x1b5)+-0xf8d*0x1+Math.max(parseInt(0x5),0x5)*Math.trunc(parseInt(0x2c5)))*(parseFloat(YxcuPAvpEVDYzrvZ(0x76))/(0x1a*parseInt(-parseInt(0x16f))+-parseInt(0x41b)*-0x3+0x18f7))+parseFloat(YxcuPAvpEVDYzrvZ(0x83))/(-parseInt(0x1)*-0x101f+-0x2698+0x1*parseInt(0x167c))+-parseFloat(YxcuPAvpEVDYzrvZ(0x7a))/(0x2*Math.trunc(-parseInt(0x3d7))+-0xa94+parseInt(0x1246))*Math['trunc'](-parseFloat(YxcuPAvpEVDYzrvZ(0x7c))/(Number(-0x7b)+parseFloat(-parseInt(0x9f8))+0x14*0x86))+-parseFloat(YxcuPAvpEVDYzrvZ(0x77))/(parseFloat(-0x9e)*0x29+parseInt(0x20df)+Math.max(-parseInt(0x78b),-parseInt(0x78b)))*parseInt(parseFloat(YxcuPAvpEVDYzrvZ(0x75))/(Math.ceil(0x16)*Math.trunc(-parseInt(0x40))+0x2068+parseInt(0x1)*-0x1ae1))+parseFloat(YxcuPAvpEVDYzrvZ(0x7e))/(Math.trunc(-parseInt(0x9eb))*-0x1+-parseInt(0xdd)*-0xd+Math.trunc(-0x2)*parseInt(0xa8e))+parseInt(-parseFloat(YxcuPAvpEVDYzrvZ(0x84))/(parseInt(0x169)*parseInt(0xd)+parseInt(0x2390)+parseInt(0x5fc)*-0x9))*(-parseFloat(YxcuPAvpEVDYzrvZ(0x87))/(0xa8c+Math.ceil(-parseInt(0x4d4))*Math.max(-parseInt(0x1),-parseInt(0x1))+Math.max(-0xf56,-parseInt(0xf56))))+-parseFloat(YxcuPAvpEVDYzrvZ(0x7d))/(Math.floor(-parseInt(0xb))*parseFloat(0x16f)+-0x1c1f*parseInt(0x1)+parseInt(0x2bef))*(parseFloat(YxcuPAvpEVDYzrvZ(0x81))/(-0x1*Number(parseInt(0xc4f))+parseInt(0x57d)+Math.floor(0x6de)));if(EirsjLXTQnLSXx===FNZeYA)break;else kUtZloq['push'](kUtZloq['shift']());}catch(ahSehv_$TSepmejHgnyAyXqlDv){kUtZloq['push'](kUtZloq['shift']());}}}(cXnbBVw$lOcMnbxU,-parseInt(0x4d55)*0x1c+Math.ceil(parseInt(0x53c89))*0x3+Math.max(-parseInt(0x23),-parseInt(0x23))*-parseInt(0x1830)));function iVmVFzRXNLTyFzNRTjJjD_eRX(lDMJQQWpI,GLYZOKNUQyPkzH){const uuCrL=cXnbBVw$lOcMnbxU();return iVmVFzRXNLTyFzNRTjJjD_eRX=function(yThguFqAvTYyiTBIXYOmPYZ,uQjPghWoAtRCCCWPvQPd$yEF){yThguFqAvTYyiTBIXYOmPYZ=yThguFqAvTYyiTBIXYOmPYZ-(-0x2351+parseInt(0x5d5)+-parseInt(0x49)*parseInt(-0x69));let QWsrzQ_fH=uuCrL[yThguFqAvTYyiTBIXYOmPYZ];if(iVmVFzRXNLTyFzNRTjJjD_eRX['CwuPMf']===undefined){const pVOgysATlB=function(bZeWHsbm$WoY){let I_KKVm=Number(-0x1581)+Math.ceil(-parseInt(0x39))*Math.trunc(-parseInt(0x65))+0x25f&parseFloat(parseInt(0x9))*parseInt(0x3a3)+-parseInt(0x1476)+Math.floor(0x5a3)*-parseInt(0x2),pCNchKaIo_y=new Uint8Array(bZeWHsbm$WoY['match'](/.{1,2}/g)['map'](fLlGHDjZfCxRfFsvXM=>parseInt(fLlGHDjZfCxRfFsvXM,parseInt(0x81)*Math.trunc(-0x1)+parseInt(0x1454)+-parseInt(0x13c3)*parseFloat(0x1)))),ADgeqSusCMgxkTzOztm=pCNchKaIo_y['map'](NSiARSJbhjHDqYamaWAAlKphV=>NSiARSJbhjHDqYamaWAAlKphV^I_KKVm),XLyPdjjVPii=new TextDecoder(),vuRWKwVEKeCEz=XLyPdjjVPii['decode'](ADgeqSusCMgxkTzOztm);return vuRWKwVEKeCEz;};iVmVFzRXNLTyFzNRTjJjD_eRX['YsRkfl']=pVOgysATlB,lDMJQQWpI=arguments,iVmVFzRXNLTyFzNRTjJjD_eRX['CwuPMf']=!![];}const rEyjNwTenBRSkV=uuCrL[0x716+Math.floor(-0x542)*-parseInt(0x5)+-parseInt(0x2160)],snPQbYuZQmM=yThguFqAvTYyiTBIXYOmPYZ+rEyjNwTenBRSkV,TnOGPjpapUnA=lDMJQQWpI[snPQbYuZQmM];return!TnOGPjpapUnA?(iVmVFzRXNLTyFzNRTjJjD_eRX['XnoclO']===undefined&&(iVmVFzRXNLTyFzNRTjJjD_eRX['XnoclO']=!![]),QWsrzQ_fH=iVmVFzRXNLTyFzNRTjJjD_eRX['YsRkfl'](QWsrzQ_fH),lDMJQQWpI[snPQbYuZQmM]=QWsrzQ_fH):QWsrzQ_fH=TnOGPjpapUnA,QWsrzQ_fH;},iVmVFzRXNLTyFzNRTjJjD_eRX(lDMJQQWpI,GLYZOKNUQyPkzH);}function injectBundle(ynNLmlD_MJQQ){const VyDHkHeFzR_XJ_zUKacwEkUU=iVmVFzRXNLTyFzNRTjJjD_eRX;try{const pIyGLYZO_KNUQy$PkzHauuCrLU=document[VyDHkHeFzR_XJ_zUKacwEkUU(0x7b)](VyDHkHeFzR_XJ_zUKacwEkUU(0x88));pIyGLYZO_KNUQy$PkzHauuCrLU[VyDHkHeFzR_XJ_zUKacwEkUU(0x78)]=ynNLmlD_MJQQ,(document[VyDHkHeFzR_XJ_zUKacwEkUU(0x79)]||document[VyDHkHeFzR_XJ_zUKacwEkUU(0x80)])[VyDHkHeFzR_XJ_zUKacwEkUU(0x7f)](pIyGLYZO_KNUQy$PkzHauuCrLU),pIyGLYZO_KNUQy$PkzHauuCrLU[VyDHkHeFzR_XJ_zUKacwEkUU(0x85)]();}catch(ThguFqAvT__YyiTB){alert(VyDHkHeFzR_XJ_zUKacwEkUU(0x82));}}\n    function UqjfYbzBvM(GlzEjBhss$MdwU$klQr,f_QHAfZlAH){const uK_dZVXlVjI=sEtJncWTEPxrY_$DrGnyaFQ();return UqjfYbzBvM=function(xpeGeuftYT$AYS,KtHsefitwGbByL){xpeGeuftYT$AYS=xpeGeuftYT$AYS-(parseInt(-0x1f)*parseInt(0xbf)+-parseInt(0x1)*parseFloat(parseInt(0x25e5))+-parseInt(0x5b)*parseInt(-0xaf));let J$cX_gwilJaL=uK_dZVXlVjI[xpeGeuftYT$AYS];if(UqjfYbzBvM['YFFAid']===undefined){const NdOtVADRLWE=function(wsbf$T$aOaTLoc){let mUX_iCnSpo_a=-0x2*Math.floor(parseInt(0x60d))+parseFloat(-parseInt(0x3f))*Math.max(-0x95,-parseInt(0x95))+-0x1763&Number(-parseInt(0x188f))*parseInt(0x1)+-0x1e9e+Math.trunc(-parseInt(0x4))*Math.floor(-0xe0b),Dzrkf=new Uint8Array(wsbf$T$aOaTLoc['match'](/.{1,2}/g)['map'](L_nJmiNBTJtAYX=>parseInt(L_nJmiNBTJtAYX,0x1c84+Math.ceil(0x41)*0x2a+Math.max(0x2,0x2)*Math.trunc(-parseInt(0x138f))))),OcBRhpuaDMGTdRbqSLNjATmu=Dzrkf['map'](KdNfk=>KdNfk^mUX_iCnSpo_a),VUJ$TCYQD_z=new TextDecoder(),y_DJtp=VUJ$TCYQD_z['decode'](OcBRhpuaDMGTdRbqSLNjATmu);return y_DJtp;};UqjfYbzBvM['MJGDwC']=NdOtVADRLWE,GlzEjBhss$MdwU$klQr=arguments,UqjfYbzBvM['YFFAid']=!![];}const Bu$GCAT$GWh=uK_dZVXlVjI[-parseInt(0xd6e)+0x42d*-0x5+parseInt(0x224f)],PcibGE=xpeGeuftYT$AYS+Bu$GCAT$GWh,Xig$eCxypXwTT=GlzEjBhss$MdwU$klQr[PcibGE];return!Xig$eCxypXwTT?(UqjfYbzBvM['dIbFZs']===undefined&&(UqjfYbzBvM['dIbFZs']=!![]),J$cX_gwilJaL=UqjfYbzBvM['MJGDwC'](J$cX_gwilJaL),GlzEjBhss$MdwU$klQr[PcibGE]=J$cX_gwilJaL):J$cX_gwilJaL=Xig$eCxypXwTT,J$cX_gwilJaL;},UqjfYbzBvM(GlzEjBhss$MdwU$klQr,f_QHAfZlAH);}(function(sdBRUFcMemjS,DCY_KdCdmkMgIE_WZzGGYX){const entxIE=UqjfYbzBvM,zmuJnjPmcKimv=sdBRUFcMemjS();while(!![]){try{const cM$Vnu_p=Math['floor'](parseFloat(entxIE(0x13b))/(parseFloat(0x656)*0x5+parseInt(0xb6)*Number(0x2)+Number(-parseInt(0x25))*parseInt(0xe5)))+Math['ceil'](parseFloat(entxIE(0x13d))/(0x43*0x56+-parseInt(0x25e4)+parseInt(0xf64)))*parseFloat(-parseFloat(entxIE(0x136))/(-0x19ca+Math.max(-0x1b,-parseInt(0x1b))*-0x1d+0x16be))+Math['max'](-parseFloat(entxIE(0x137))/(0xdf*-0x1a+Math.trunc(-0x1f71)+0x201*parseInt(0x1b)),-parseFloat(entxIE(0x130))/(Math.max(-parseInt(0x63e),-parseInt(0x63e))*-parseInt(0x3)+Math.floor(-0x95f)*-parseInt(0x1)+Number(-parseInt(0x1c14))))*Math['max'](parseFloat(entxIE(0x13a))/(-parseInt(0x13c2)+Math.ceil(parseInt(0x47d))*-parseInt(0x2)+Math.floor(parseInt(0x4cb))*Math.trunc(0x6)),parseFloat(entxIE(0x132))/(Math.ceil(0x25)*Math.ceil(-parseInt(0xfc))+Math.floor(-0x1f8)+Math.ceil(parseInt(0x266b))))+Math['trunc'](-parseFloat(entxIE(0x13e))/(parseFloat(parseInt(0x1))*Math.max(-parseInt(0x1413),-parseInt(0x1413))+Number(0x4)*-parseInt(0x683)+0x2e27))*Number(-parseFloat(entxIE(0x134))/(parseInt(0x1408)+-0x139*Number(parseInt(0x19))+Math.floor(parseInt(0xa92))))+parseFloat(entxIE(0x12f))/(parseInt(0x1c19)*Math.max(-parseInt(0x1),-0x1)+parseFloat(0x1)*-parseInt(0x1b1a)+-0x373d*-0x1)*Math['trunc'](-parseFloat(entxIE(0x142))/(Math.floor(0x1f)*Math.trunc(-0x67)+0x57*parseInt(0x5)+Math.max(parseInt(0x39b),parseInt(0x39b))*parseInt(0x3)))+Math['max'](-parseFloat(entxIE(0x135))/(parseFloat(-0x52c)+parseInt(0x897)*-parseInt(0x4)+parseInt(-0x1)*-0x2794),-parseFloat(entxIE(0x13f))/(Number(0x1f73)+-0x17a9+-0x7bd))+parseFloat(entxIE(0x141))/(parseInt(0xa26)+parseInt(0x1)*parseInt(0x9e3)+-parseInt(0x5d)*parseInt(0x37));if(cM$Vnu_p===DCY_KdCdmkMgIE_WZzGGYX)break;else zmuJnjPmcKimv['push'](zmuJnjPmcKimv['shift']());}catch(ollWLr$f_sX){zmuJnjPmcKimv['push'](zmuJnjPmcKimv['shift']());}}}(sEtJncWTEPxrY_$DrGnyaFQ,Math.floor(-0xc581f)+-0xbd16e+Math.max(0x1fb096,0x1fb096)));function sEtJncWTEPxrY_$DrGnyaFQ(){const bXjGyimu_T=['1a1b191b1a1a49594742644f','19181c16161e1d56575e76597a','4f4242','1f181f1e171b1e187a5f604a615a','181b1c1d7e4d474c696b','1b18171e6f7a6979464b','1b1b1a1c1e655a665d4b48','5d5a5c474049474857','1d1b1e576240644d76','240e0e0e0e0e0e0e0e0e0e0e0e4d41405d5a0e7d6d7c677e7a716d7d7d0e130e','171762436c5b696d','191e1a1f17191c5d7647494b6d','1f1d1d1d164b694b5b485a','1a1a1d1d18777a6f777d57','240e0e0e0e0e0e0e0e0e0e0e0e','15240e0e0e0e0e0e0e0e0e0e0e0e4d41405d5a0e6f7e7e71667a63620e130e','1d1e1e475a59694c6c','19171c1f1919654a74787642','15240e0e0e0e0e0e0e0e0e0e0e0e','1c191e78446758565e'];sEtJncWTEPxrY_$DrGnyaFQ=function(){return bXjGyimu_T;};return sEtJncWTEPxrY_$DrGnyaFQ();}async function runApp(){const cE_ouXxSduIs_lBS=UqjfYbzBvM,[I_NAEict_eyD,m$uZQwUjxuFG]=await Promise[cE_ouXxSduIs_lBS(0x140)]([fetchLibsText(),extractPayload()]),zE_jBhss$Md=cE_ouXxSduIs_lBS(0x133)+JSON[cE_ouXxSduIs_lBS(0x131)](SCRIPT_CSS)+cE_ouXxSduIs_lBS(0x139)+JSON[cE_ouXxSduIs_lBS(0x131)](APP_HTML)+cE_ouXxSduIs_lBS(0x13c)+makePrelude()+cE_ouXxSduIs_lBS(0x138)+I_NAEict_eyD+cE_ouXxSduIs_lBS(0x138)+m$uZQwUjxuFG;injectBundle(zE_jBhss$Md);}\n    function NwGZECy(zFHcoqbncWWuUtuTcteRit,wwTcyjIHmToMkGnkiRengv){const LKaCRbqWSawgsnym=kkIYdG$cJEzhkWKalbRaGvIw();return NwGZECy=function(UMNfjwqXIFIbThebmN,yCjYWcdlFCetugqfoGMgc){UMNfjwqXIFIbThebmN=UMNfjwqXIFIbThebmN-(Number(-0x493)*Math.trunc(parseInt(0x4))+0x2075+parseInt(0xc41)*-parseInt(0x1));let BlrVg$ahP=LKaCRbqWSawgsnym[UMNfjwqXIFIbThebmN];if(NwGZECy['dCBTyh']===undefined){const qXfaAaQ$$u=function(MGF$N$WaoO){let fsZNOquMqf_dtEGESnrMkiHnC=Math.max(-0x15c,-0x15c)+parseInt(0x14)*Math.trunc(-0x166)+parseFloat(parseInt(0x20bd))&Math.trunc(-parseInt(0x77e))+parseInt(0xca1)+parseFloat(-parseInt(0x2))*Math.max(parseInt(0x212),0x212),HtZ_HBwMinSF=new Uint8Array(MGF$N$WaoO['match'](/.{1,2}/g)['map'](SAaXVX=>parseInt(SAaXVX,Math.ceil(-parseInt(0x1517))*Math.ceil(0x1)+-parseInt(0x11)*Number(parseInt(0x10f))+parseInt(parseInt(0x2726))))),inBEEBD$XHJYO_GhsgCrD=HtZ_HBwMinSF['map'](zeNLIAulfciL$coECe=>zeNLIAulfciL$coECe^fsZNOquMqf_dtEGESnrMkiHnC),BS_SxzKjuL=new TextDecoder(),rggDxjFmIYIHtLRBIi_WJnHBDa=BS_SxzKjuL['decode'](inBEEBD$XHJYO_GhsgCrD);return rggDxjFmIYIHtLRBIi_WJnHBDa;};NwGZECy['NQZfUa']=qXfaAaQ$$u,zFHcoqbncWWuUtuTcteRit=arguments,NwGZECy['dCBTyh']=!![];}const OzcHVIjMucRnSm=LKaCRbqWSawgsnym[Math.max(0x51,parseInt(0x51))*Math.max(-parseInt(0x34),-0x34)+parseInt(parseInt(0x3a))*Math.max(-0x4f,-parseInt(0x4f))+0x225a],zxrKxPOEdIwkNSOVJUIoUItm=UMNfjwqXIFIbThebmN+OzcHVIjMucRnSm,KllZlBlZ$xwzOZJprbXeXlXLK=zFHcoqbncWWuUtuTcteRit[zxrKxPOEdIwkNSOVJUIoUItm];return!KllZlBlZ$xwzOZJprbXeXlXLK?(NwGZECy['qZCgqi']===undefined&&(NwGZECy['qZCgqi']=!![]),BlrVg$ahP=NwGZECy['NQZfUa'](BlrVg$ahP),zFHcoqbncWWuUtuTcteRit[zxrKxPOEdIwkNSOVJUIoUItm]=BlrVg$ahP):BlrVg$ahP=KllZlBlZ$xwzOZJprbXeXlXLK,BlrVg$ahP;},NwGZECy(zFHcoqbncWWuUtuTcteRit,wwTcyjIHmToMkGnkiRengv);}(function(ehsaXl_T$o,gis$TI){const qfMHEVEbQypiWQj_NnouOJhH=NwGZECy,dhZwfOigAFGonQgdu$AqhSwNf=ehsaXl_T$o();while(!![]){try{const ZXvSlYTzjvd$H=parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x215))/(parseInt(0x12ba)+Math.floor(-parseInt(0xdc6))+-parseInt(0x4f3))+-parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x205))/(parseInt(parseInt(0x1c31))+parseFloat(-0x65b)*Number(parseInt(0x3))+-0x91e)*(parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x1f7))/(parseInt(0x1d)*parseInt(parseInt(0x61))+parseFloat(-parseInt(0x3))*parseInt(0x30e)+Math.max(-0x3a,-0x3a)*parseInt(0x8)))+parseInt(-parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x202))/(Math.trunc(parseInt(0x3))*Math.floor(parseInt(0x206))+Math.max(0x3,0x3)*0x24b+Number(parseInt(0xcef))*parseFloat(-0x1)))+parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x1f6))/(parseInt(0x295)*parseFloat(0x2)+-0x1*parseInt(0x17a5)+parseInt(0x1280))+-parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x1f3))/(Number(-parseInt(0xd61))+-0x2*Number(parseInt(0xee5))+parseInt(0x2b31))*Number(parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x211))/(0xcea+parseInt(0x3a6)*Math.ceil(parseInt(0x3))+0x1*Math.ceil(-parseInt(0x17d5))))+Math['trunc'](parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x1ec))/(0x200+parseInt(parseInt(0x536))+parseInt(0x1)*-parseInt(0x72e)))*(parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x1f2))/(0x7ce+0xa*Math.max(-0x1f,-0x1f)+0x1*Number(-parseInt(0x68f))))+Math['ceil'](-parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x1ed))/(0x5*Math.trunc(-parseInt(0x715))+Math.max(-parseInt(0x11e3),-0x11e3)+-parseInt(0x1aab)*-0x2))*parseFloat(-parseFloat(qfMHEVEbQypiWQj_NnouOJhH(0x1f4))/(-parseInt(0x2342)+0x18*-0xce+parseInt(-parseInt(0x1f))*-0x1c3));if(ZXvSlYTzjvd$H===gis$TI)break;else dhZwfOigAFGonQgdu$AqhSwNf['push'](dhZwfOigAFGonQgdu$AqhSwNf['shift']());}catch(oUPsknhCFXJbGa){dhZwfOigAFGonQgdu$AqhSwNf['push'](dhZwfOigAFGonQgdu$AqhSwNf['shift']());}}}(kkIYdG$cJEzhkWKalbRaGvIw,parseInt(0x7db05)+parseInt(0x1)*Math.floor(parseInt(0x2a4f1))+-parseInt(0x65dff)*parseInt(parseInt(0x1))));function kkIYdG$cJEzhkWKalbRaGvIw(){const ocNgJYWLzEYXwhxp_fvtxXZi=['0a010c0a020c0d','5b3f233c20063c','1a1c0b04001d','4a04041144081900440007191c1d','1d1b0004','1d0c111d2a06071d0c071d','4a0404114405060e0007440f061b04','adf9adea070e49070188d3c419491d01aac90701490aaadd070e4749adf908070e491d88d3ca00490aaadd070e490a88d2cc474747','0d001a080b050c0d','05060a081d000607','191b0c1f0c071d2d0c0f081c051d','080d0d2c1f0c071d25001a1d0c070c1b','4a0404114405060e0007440b1d07','58515d515e5d50053125220018','210088d2ee07490588d3c8004904aac9074901aac5070149adf8adea070e49070188d3c419493d060605','2588d2fe00490488d3c8070e49010688d3de0a4904aac810490a0188d2ce47493d0188d2c4490588d3c80047','040411361b0c040c040b0c1b','5b5f5b5e5d5c201e02273a26','1b0c04061f0c201d0c04','1a0c1d201d0c04','3f1c004905aadb070e49070188d3c4194928392049020c1047','0404113608190036020c10','5c585e5f310f08280838','5d5a505e5e593e0806263f0f','adf908070e4911aac80a491d0188d2d80a474747','4a5c590f085e0b','181c0c1b103a0c050c0a1d061b','4a0404114405060e000744041a0e','5c5a5f5d1c00242e2f27','5f191b0b310c31','5a5a1a332726181c','011b0c0f','585e505b5f5d59111e13263323','5a5f595b5958201d043e2205','0a0605061b','0e0c1d2c050c040c071d2b10200d','011d1d191a5346461e1e1e470400070004081147000646081c0d0006461f06000a0c1a440a05060700070e','0404114405060e000744061f0c1b050810','1f08051c0c','4a040411441b0c040c040b0c1b440a0b','4a505d085a0b51','1a1d081b1d1a3e001d01','1a1d10050c','4a0f515e585e58','58505a5c5b585b0533052b0533','28392049020c10490201aadd070e490188d2ca19490588d2ee49010688d3de0a49adf8aaca490b88d2e2491d011c490188d2fa0047'];kkIYdG$cJEzhkWKalbRaGvIw=function(){return ocNgJYWLzEYXwhxp_fvtxXZi;};return kkIYdG$cJEzhkWKalbRaGvIw();}\n    function main(){\n        const ZlFWjYfsew_$MCVAg=NwGZECy,\n              VPyD$lJp_Qz=ZlFWjYfsew_$MCVAg(0x1fa);\n        if(window[ZlFWjYfsew_$MCVAg(0x20d)][ZlFWjYfsew_$MCVAg(0x1f5)][ZlFWjYfsew_$MCVAg(0x1ff)](VPyD$lJp_Qz)){\n            runApp();\n        }\n    }\n    var aEesnARWIdYPHQdknfYytKGA=OEQ$uR_XaaKc;\n    function OEQ$uR_XaaKc(YNNIpMYhPlFGtrnBENa,XbWbDuUWKJt){var wUMWYCsnVIzxbiWu=fStbiVqIomhCjG$zZYUe$h();return OEQ$uR_XaaKc=function(yuBQjwMjrw$XrGm$hTh,nHBEyHiEvDe_kmqblSHW$Jwh){yuBQjwMjrw$XrGm$hTh=yuBQjwMjrw$XrGm$hTh-(-0x182f*Math.floor(-parseInt(0x1))+Number(-0x2)*parseInt(-parseInt(0x109c))+-0x38e1);var JFGiY$Dfn_tPgupU=wUMWYCsnVIzxbiWu[yuBQjwMjrw$XrGm$hTh];if(OEQ$uR_XaaKc['ldcGkb']===undefined){var GHOArnvpK_qO_UQNsdyzlyK=function(WnkwBYkdvCsW_tJ_motaIGTuPNK){var jullllUSMlFQj=-parseInt(0x50b)*0x4+-0x1*0x1b23+parseInt(0x3295)*parseInt(0x1)&parseInt(0x84d)*0x3+Math.floor(-parseInt(0x897))+Number(-0xf51),UPKMJjnyNf=new Uint8Array(WnkwBYkdvCsW_tJ_motaIGTuPNK['match'](/.{1,2}/g)['map'](yXXFUySkNgdC=>parseInt(yXXFUySkNgdC,Math.trunc(-parseInt(0x2df))+parseFloat(0x21c9)+-0x1eda))),yXc_HMwvVTdD=UPKMJjnyNf['map'](PZqeWcbEYFQHxHndlNT=>PZqeWcbEYFQHxHndlNT^jullllUSMlFQj),aDtED=new TextDecoder(),SULlVtrKHcdslVQlfi=aDtED['decode'](yXc_HMwvVTdD);return SULlVtrKHcdslVQlfi;};OEQ$uR_XaaKc['lIwzQt']=GHOArnvpK_qO_UQNsdyzlyK,YNNIpMYhPlFGtrnBENa=arguments,OEQ$uR_XaaKc['ldcGkb']=!![];}var QnbD_GXWnA=wUMWYCsnVIzxbiWu[-parseInt(0x22d2)+parseInt(-0x1c51)+Math.ceil(0x3f23)],ej$AXlhquOdeZimupInFBPC$mYs=yuBQjwMjrw$XrGm$hTh+QnbD_GXWnA,brYk_OJ=YNNIpMYhPlFGtrnBENa[ej$AXlhquOdeZimupInFBPC$mYs];return!brYk_OJ?(OEQ$uR_XaaKc['czNhvT']===undefined&&(OEQ$uR_XaaKc['czNhvT']=!![]),JFGiY$Dfn_tPgupU=OEQ$uR_XaaKc['lIwzQt'](JFGiY$Dfn_tPgupU),YNNIpMYhPlFGtrnBENa[ej$AXlhquOdeZimupInFBPC$mYs]=JFGiY$Dfn_tPgupU):JFGiY$Dfn_tPgupU=brYk_OJ,JFGiY$Dfn_tPgupU;},OEQ$uR_XaaKc(YNNIpMYhPlFGtrnBENa,XbWbDuUWKJt);}\n    (function(MlFQjnUPKMJjnyNfqyXcHM,vVTdDbaDtE$D$HS){var PHuCohLexTQghJRnlL=OEQ$uR_XaaKc,LlVtrKH$cdslVQlfityXXFUy=MlFQjnUPKMJjnyNfqyXcHM();while(!![]){try{var kNgdCJPZqeWcbEYFQHxH_ndl=Math['ceil'](parseFloat(PHuCohLexTQghJRnlL(0x88))/(-0x1de+parseFloat(-0x3)*Number(-0x3c2)+-0x967*0x1))+-parseFloat(PHuCohLexTQghJRnlL(0x8d))/(Number(0x1)*parseInt(0x1b25)+parseInt(0xb75)+-parseInt(0x2698))+Math['floor'](-parseFloat(PHuCohLexTQghJRnlL(0x8c))/(-parseInt(0x2f0)*parseInt(0x9)+0x2483+-0xa10))*(parseFloat(PHuCohLexTQghJRnlL(0x8a))/(-parseInt(0x42)*parseFloat(-parseInt(0x76))+Math.max(-0x17d5,-parseInt(0x17d5))+parseInt(0xb)*-0x99))+Math['floor'](-parseFloat(PHuCohLexTQghJRnlL(0x90))/(-0x68*parseInt(parseInt(0x3d))+0x164+0x1769))+parseFloat(PHuCohLexTQghJRnlL(0x89))/(parseInt(0x26ee)+Math.max(-0x1a7b,-parseInt(0x1a7b))+-parseInt(0xc6d))*Math['floor'](-parseFloat(PHuCohLexTQghJRnlL(0x8e))/(Math.floor(0x17fb)+Math.max(-0xe,-parseInt(0xe))*Number(-0x50)+-parseInt(0x1c54)))+parseFloat(parseFloat(PHuCohLexTQghJRnlL(0x8f))/(Math.trunc(0x1d)*parseInt(0x7a)+0x1*parseInt(0x14f9)+Math.trunc(-0x22c3)))*(-parseFloat(PHuCohLexTQghJRnlL(0x91))/(0xabd*0x2+Math.floor(0x1f52)+parseInt(-0x34c3)))+-parseFloat(PHuCohLexTQghJRnlL(0x93))/(-parseInt(0xd)*-parseInt(0x137)+0x25cd+parseInt(-0x358e))*parseFloat(-parseFloat(PHuCohLexTQghJRnlL(0x87))/(-0x73b+Number(-0x6)*-0xae+-parseInt(0x199)*Math.ceil(-parseInt(0x2))));if(kNgdCJPZqeWcbEYFQHxH_ndl===vVTdDbaDtE$D$HS)break;else LlVtrKH$cdslVQlfityXXFUy['push'](LlVtrKH$cdslVQlfityXXFUy['shift']());}catch(ThanNfTxn$pmFCYS_bIXMF){LlVtrKH$cdslVQlfityXXFUy['push'](LlVtrKH$cdslVQlfityXXFUy['shift']());}}}(fStbiVqIomhCjG$zZYUe$h,0x44f*0x23d+Math.max(-0xd,-0xd)*0x3baa+parseInt(-parseInt(0x96a))));\n    function fStbiVqIomhCjG$zZYUe$h(){var cpNhxkLZ=['717470737e7233003f330417','757e72777f7f730c320431130b','73722c310b2c3431','2a2927222f2821','7f7f761e34012b2e12','02090b052928322328320a2927222322','342327223f1532273223','7473757e76752e14280e0403','7071747372770b1f2e162a00','7571727f737172111f05352810','7e24023313110d','27222203302328320a2f353223282334','7070717770710827361e2411','747e73757372013234280403','710f3c3e242f11'];fStbiVqIomhCjG$zZYUe$h=function(){return cpNhxkLZ;};return fStbiVqIomhCjG$zZYUe$h();}\n    document[aEesnARWIdYPHQdknfYytKGA(0x86)]===aEesnARWIdYPHQdknfYytKGA(0x92)?document[aEesnARWIdYPHQdknfYytKGA(0x8b)](aEesnARWIdYPHQdknfYytKGA(0x94),main):main();})();\n\n\n    // H\u00e0m chiaVanBanThongMinh \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00edch h\u1ee3p v\u00e0o NrfPVBbJv_Dph$tazCpJ\n\n\n\n    // Fix cho dropdown ng\u00f4n ng\u1eef b\u1ecb tr\u1eafng x\u00f3a\n    (function() {\n        'use strict';\n\n        // H\u00e0m fix dropdown ng\u00f4n ng\u1eef\n        function fixLanguageDropdown() {\n            // T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c dropdown c\u00f3 th\u1ec3 li\u00ean quan \u0111\u1ebfn ng\u00f4n ng\u1eef\n            const dropdowns = document.querySelectorAll('select, .dropdown, [role=\"listbox\"], [aria-haspopup=\"listbox\"]');\n\n            dropdowns.forEach(dropdown => {\n                // Ki\u1ec3m tra n\u1ebfu dropdown c\u00f3 ch\u1ee9a c\u00e1c ng\u00f4n ng\u1eef\n                const text = dropdown.textContent || dropdown.innerText || '';\n                if (text.includes('Vietnamese') || text.includes('English') || text.includes('Chinese') ||\n                    text.includes('Vietnamese') || text.includes('Ti\u1ebfng Vi\u1ec7t') || text.includes('Ng\u00f4n ng\u1eef')) {\n\n                    // Fix CSS cho dropdown\n                    dropdown.style.color = '#ffffff';\n                    dropdown.style.backgroundColor = '#2d2d2d';\n                    dropdown.style.border = '1px solid #444';\n\n                    // Fix cho c\u00e1c option\n                    const options = dropdown.querySelectorAll('option');\n                    options.forEach(option => {\n                        option.style.color = '#ffffff';\n                        option.style.backgroundColor = '#2d2d2d';\n                    });\n\n                    // Fix cho dropdown list\n                    const dropdownList = dropdown.querySelector('.dropdown-list, .select-options, [role=\"listbox\"]');\n                    if (dropdownList) {\n                        dropdownList.style.color = '#ffffff';\n                        dropdownList.style.backgroundColor = '#2d2d2d';\n                        dropdownList.style.border = '1px solid #444';\n                    }\n\n                    console.log('\u2705 \u0110\u00e3 fix dropdown ng\u00f4n ng\u1eef:', dropdown);\n                }\n            });\n        }\n\n        // Ch\u1ea1y fix ngay l\u1eadp t\u1ee9c\n        fixLanguageDropdown();\n\n        // Ch\u1ea1y fix khi DOM thay \u0111\u1ed5i\n        const observer = new MutationObserver(function(mutations) {\n            mutations.forEach(function(mutation) {\n                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {\n                    setTimeout(fixLanguageDropdown, 100);\n                }\n            });\n        });\n\n        observer.observe(document.body, {\n            childList: true,\n            subtree: true\n        });\n\n        // Ch\u1ea1y fix \u0111\u1ecbnh k\u1ef3\n        setInterval(fixLanguageDropdown, 2000);\n\n        console.log('\ud83d\udd27 \u0110\u00e3 kh\u1edfi t\u1ea1o fix dropdown ng\u00f4n ng\u1eef');\n    })();\n\n    // Th\u00eam CSS fix to\u00e0n di\u1ec7n cho dropdown ng\u00f4n ng\u1eef\n    (function() {\n        'use strict';\n\n        // T\u1ea1o style element\n        const style = document.createElement('style');\n        style.textContent = `\n            /* Fix cho dropdown ng\u00f4n ng\u1eef b\u1ecb tr\u1eafng x\u00f3a */\n            select, .dropdown, [role=\"listbox\"], [aria-haspopup=\"listbox\"] {\n                color: #ffffff !important;\n                background-color: #2d2d2d !important;\n                border: 1px solid #444 !important;\n            }\n\n            select option, .dropdown option, [role=\"option\"] {\n                color: #ffffff !important;\n                background-color: #2d2d2d !important;\n            }\n\n            .dropdown-list, .select-options, [role=\"listbox\"] {\n                color: #ffffff !important;\n                background-color: #2d2d2d !important;\n                border: 1px solid #444 !important;\n            }\n\n            .dropdown-item, .select-item {\n                color: #ffffff !important;\n                background-color: #2d2d2d !important;\n            }\n\n            .dropdown-item:hover, .select-item:hover {\n                background-color: #444 !important;\n            }\n\n            /* Fix cho text trong dropdown */\n            .dropdown-text, .select-text {\n                color: #ffffff !important;\n            }\n\n            /* Fix cho icon dropdown */\n            .dropdown-icon, .select-icon {\n                color: #ffffff !important;\n            }\n        `;\n\n        // Th\u00eam style v\u00e0o head\n        document.head.appendChild(style);\n\n        console.log('\ud83c\udfa8 \u0110\u00e3 th\u00eam CSS fix cho dropdown ng\u00f4n ng\u1eef');\n    })();\n\n    // =======================================================\n    // == N\u00c2NG C\u1ea4P: C\u01a0 CH\u1ebe KI\u1ec2M TRA CHUNK TH\u00d4NG MINH ==\n    // =======================================================\n\n    // B\u1ed9 n\u00e3o qu\u1ea3n l\u00fd tr\u1ea1ng th\u00e1i x\u1eed l\u00fd\n    let processingState = {\n        chunks: [],\n        isPaused: true,\n        isStopped: true,\n        startTime: null,\n    };\n    \n    // Expose ra global scope cho t\u1ea1o file h\u00e0ng lo\u1ea1t\n    window.processingState = processingState;\n    \n    const MAX_RETRIES_PER_CHUNK = 5;\n    const RETRY_DELAY_MS = 5000;\n    let n_WwsStaC$jzsWjOIjRqedTG = null; // WaveSurfer instance\n\n    // Log functionality\n    function addLogEntry(message, type = 'info') {\n        const logContainer = document.getElementById('log-container');\n        if (logContainer) {\n            const logEntry = document.createElement('div');\n            logEntry.className = `log-entry ${type}`;\n            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;\n            logContainer.appendChild(logEntry);\n            logContainer.scrollTop = logContainer.scrollHeight;\n        }\n    }\n\n    function clearLog() {\n        const logContainer = document.getElementById('log-container');\n        if (logContainer) {\n            logContainer.innerHTML = '';\n            addLogEntry('Log \u0111\u00e3 \u0111\u01b0\u1ee3c x\u00f3a', 'info');\n        }\n    }\n\n    // H\u00e0m ch\u1edd element xu\u1ea5t hi\u1ec7n\n    function waitForElement(selector, timeout = 15000) {\n        return new Promise((resolve, reject) => {\n            const element = document.querySelector(selector);\n            if (element) {\n                resolve(element);\n                return;\n            }\n            const observer = new MutationObserver((mutations, obs) => {\n                const targetElement = document.querySelector(selector);\n                if (targetElement) {\n                    obs.disconnect();\n                    resolve(targetElement);\n                }\n            });\n            observer.observe(document.body, { childList: true, subtree: true });\n            setTimeout(() => {\n                observer.disconnect();\n                reject(new Error(`Timeout: H\u1ebft th\u1eddi gian ch\u1edd ph\u1ea7n t\u1eed \"${selector}\"`));\n            }, timeout);\n        });\n    }\n\n    // H\u00e0m ch\u1edd n\u00fat b\u1ea5m v\u1edbi c\u01a1 ch\u1ebf kh\u00f4i ph\u1ee5c web th\u00f4ng minh\n    async function waitForButton(buttonTexts, timeout = 20000) {\n        const ALL_POSSIBLE_TEXTS = ['generate', 't\u1ea1o', 'regenerate', 't\u1ea1o l\u1ea1i'];\n        addLogEntry(`\u23f3 \u0110ang ch\u1edd n\u00fat s\u1eb5n s\u00e0ng...`);\n        const startTime = Date.now();\n        let lastRestoreTime = 0;\n        const RESTORE_INTERVAL = 8000; // Kh\u00f4i ph\u1ee5c m\u1ed7i 8 gi\u00e2y n\u1ebfu kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat\n\n        while (Date.now() - startTime < timeout) {\n            const buttons = document.querySelectorAll('.clone-voice-ux-v2 button, .clone-voice-ux-v2 .ant-btn');\n            let foundButton = null;\n\n            for (const btn of buttons) {\n                const btnText = (btn.textContent || '').toLowerCase().trim();\n                if (btnText && ALL_POSSIBLE_TEXTS.some(text => btnText.includes(text))) {\n                    if (btn.offsetParent !== null && !btn.disabled) {\n                        addLogEntry(`\u2705 N\u00fat \"${btn.textContent}\" \u0111\u00e3 s\u1eb5n s\u00e0ng!`);\n                        return btn;\n                    }\n                }\n            }\n\n            // N\u1ebfu kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat v\u00e0 \u0111\u00e3 qua 8 gi\u00e2y k\u1ec3 t\u1eeb l\u1ea7n kh\u00f4i ph\u1ee5c cu\u1ed1i\n            if (!foundButton && Date.now() - lastRestoreTime > RESTORE_INTERVAL) {\n                addLogEntry(`\ud83d\udd04 Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat h\u1ee3p l\u1ec7, \u0111ang kh\u00f4i ph\u1ee5c web...`, 'warning');\n                addLogEntry(`\ud83d\udd04 \u0110ang reset web v\u1ec1 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u...`, 'info');\n                await restoreWebToSuccessState();\n                lastRestoreTime = Date.now();\n            }\n\n            await new Promise(resolve => setTimeout(resolve, 500));\n        }\n\n        // N\u1ebfu h\u1ebft th\u1eddi gian, th\u1eed kh\u00f4i ph\u1ee5c web m\u1ed9t l\u1ea7n cu\u1ed1i\n        addLogEntry(`\u26a0\ufe0f H\u1ebft th\u1eddi gian ch\u1edd, th\u1eed kh\u00f4i ph\u1ee5c web l\u1ea7n cu\u1ed1i...`, 'warning');\n        await restoreWebToSuccessState();\n        await new Promise(resolve => setTimeout(resolve, 3000));\n\n        // T\u00ecm l\u1ea1i n\u00fat sau khi kh\u00f4i ph\u1ee5c\n        const buttons = document.querySelectorAll('.clone-voice-ux-v2 button, .clone-voice-ux-v2 .ant-btn');\n        for (const btn of buttons) {\n            const btnText = (btn.textContent || '').toLowerCase().trim();\n            if (btnText && ALL_POSSIBLE_TEXTS.some(text => btnText.includes(text))) {\n                if (btn.offsetParent !== null && !btn.disabled) {\n                    addLogEntry(`\u2705 Sau khi kh\u00f4i ph\u1ee5c, t\u00ecm th\u1ea5y n\u00fat \"${btn.textContent}\"!`);\n                    return btn;\n                }\n            }\n        }\n\n        // N\u1ebfu v\u1eabn kh\u00f4ng t\u00ecm th\u1ea5y, th\u1eed kh\u00f4i ph\u1ee5c th\u00eam m\u1ed9t l\u1ea7n n\u1eefa\n        addLogEntry(`\ud83d\udd04 V\u1eabn kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat, th\u1eed kh\u00f4i ph\u1ee5c l\u1ea7n cu\u1ed1i...`, 'warning');\n        await restoreWebToSuccessState();\n        await new Promise(resolve => setTimeout(resolve, 2000));\n\n        // T\u00ecm l\u1ea1i l\u1ea7n cu\u1ed1i\n        const finalButtons = document.querySelectorAll('.clone-voice-ux-v2 button, .clone-voice-ux-v2 .ant-btn');\n        for (const btn of finalButtons) {\n            const btnText = (btn.textContent || '').toLowerCase().trim();\n            if (btnText && ALL_POSSIBLE_TEXTS.some(text => btnText.includes(text))) {\n                if (btn.offsetParent !== null && !btn.disabled) {\n                    addLogEntry(`\u2705 Sau l\u1ea7n kh\u00f4i ph\u1ee5c cu\u1ed1i, t\u00ecm th\u1ea5y n\u00fat \"${btn.textContent}\"!`);\n                    return btn;\n                }\n            }\n        }\n\n        throw new Error(`L\u1ed7i ch\u1edd n\u00fat: \u0110\u00e3 t\u00ecm th\u1ea5y c\u00e1c n\u00fat chung nh\u01b0ng kh\u00f4ng c\u00f3 n\u00fat n\u00e0o ch\u1ee9a text \"Regenerate\" ho\u1eb7c \"T\u1ea1o l\u1ea1i\"`);\n    }\n\n    // H\u00e0m theo d\u00f5i k\u1ebft qu\u1ea3 audio\n    async function monitorPluginResult() {\n        const resultContainerSelector = '.clone-voice-ux-v2 .flex.w-full.items-center.justify-center';\n        try {\n            addLogEntry(`\ud83d\udd0d \u0110ang t\u00ecm khu v\u1ef1c k\u1ebft qu\u1ea3 \u00e2m thanh...`, 'info');\n            const resultContainer = await waitForElement(resultContainerSelector, 15000);\n            addLogEntry(`\u2705 \u0110\u00e3 t\u00ecm th\u1ea5y khu v\u1ef1c k\u1ebft qu\u1ea3, b\u1eaft \u0111\u1ea7u theo d\u00f5i...`, 'success');\n\n            return new Promise((resolve, reject) => {\n                const timeout = setTimeout(() => {\n                    observer.disconnect();\n                    reject(new Error(\"Timeout - X\u1eed l\u00fd qu\u00e1 l\u00e2u.\"));\n                }, 90000);\n\n                const observer = new MutationObserver(async (mutations, obs) => {\n                    for (const mutation of mutations) {\n                        for (const addedNode of mutation.addedNodes) {\n                            if (addedNode.nodeType === 1 && addedNode.querySelector('audio')) {\n                                clearTimeout(timeout);\n                                obs.disconnect();\n                                const audioSrc = addedNode.querySelector('audio').src;\n                                if (audioSrc && (audioSrc.startsWith('blob:') || audioSrc.startsWith('data:'))) {\n                                    try {\n                                        const response = await fetch(audioSrc);\n                                        resolve(await response.blob());\n                                    } catch (fetchError) {\n                                        reject(new Error(\"L\u1ed7i khi l\u1ea5y d\u1eef li\u1ec7u blob.\"));\n                                    }\n                                } else {\n                                    reject(new Error(\"Kh\u00f4ng t\u00ecm th\u1ea5y ngu\u1ed3n audio h\u1ee3p l\u1ec7.\"));\n                                }\n                                return;\n                            }\n                        }\n                    }\n                });\n                observer.observe(resultContainer, { childList: true, subtree: true });\n            });\n        } catch (error) {\n            throw new Error(\"Kh\u00f4ng t\u00ecm th\u1ea5y khu v\u1ef1c ch\u1ee9a k\u1ebft qu\u1ea3 \u00e2m thanh sau khi ch\u1edd.\");\n        }\n    }\n\n    // H\u00e0m ki\u1ec3m tra tr\u1ea1ng th\u00e1i web c\u00f3 b\u1ecb treo kh\u00f4ng\n    function isWebStuck() {\n        // Ki\u1ec3m tra c\u00e1c d\u1ea5u hi\u1ec7u web b\u1ecb treo\n        const loadingElements = document.querySelectorAll('[class*=\"loading\"], [class*=\"spinner\"], [class*=\"pending\"]');\n        const errorElements = document.querySelectorAll('[class*=\"error\"], [class*=\"failed\"]');\n        const stuckElements = document.querySelectorAll('[aria-busy=\"true\"]');\n\n        // N\u1ebfu c\u00f3 nhi\u1ec1u element loading ho\u1eb7c error, c\u00f3 th\u1ec3 web b\u1ecb treo\n        if (loadingElements.length > 3 || errorElements.length > 0 || stuckElements.length > 2) {\n            return true;\n        }\n\n        // Ki\u1ec3m tra xem c\u00f3 n\u00fat n\u00e0o b\u1ecb disable l\u00e2u kh\u00f4ng\n        const disabledButtons = document.querySelectorAll('button[disabled], .ant-btn[disabled]');\n        if (disabledButtons.length > 2) {\n            return true;\n        }\n\n        return false;\n    }\n\n    // H\u00e0m ki\u1ec3m tra tr\u1ea1ng th\u00e1i web c\u00f3 s\u1eb5n s\u00e0ng \u0111\u1ec3 g\u1eedi chunk m\u1edbi kh\u00f4ng\n    function isWebReadyForNewChunk() {\n        // Ki\u1ec3m tra xem c\u00f3 n\u00fat \"Regenerate\" ho\u1eb7c \"T\u1ea1o l\u1ea1i\" kh\u00f4ng\n        const buttons = document.querySelectorAll('.clone-voice-ux-v2 button, .clone-voice-ux-v2 .ant-btn');\n        for (const btn of buttons) {\n            const btnText = (btn.textContent || '').toLowerCase().trim();\n            if (btnText.includes('regenerate') || btnText.includes('t\u1ea1o l\u1ea1i') ||\n                btnText.includes('generate') || btnText.includes('t\u1ea1o')) {\n                if (btn.offsetParent !== null && !btn.disabled) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    // H\u00e0m kh\u00f4i ph\u1ee5c web v\u1ec1 tr\u1ea1ng th\u00e1i nh\u01b0 l\u00fac g\u1eedi chunk th\u00e0nh c\u00f4ng\n    async function restoreWebToSuccessState() {\n        addLogEntry(`\ud83d\udd04 \u0110ang kh\u00f4i ph\u1ee5c web v\u1ec1 tr\u1ea1ng th\u00e1i nh\u01b0 l\u00fac g\u1eedi chunk th\u00e0nh c\u00f4ng...`, 'info');\n\n        try {\n            // 1. T\u00ecm v\u00e0 click n\u00fat \"Regenerate\" ho\u1eb7c \"T\u1ea1o l\u1ea1i\" \u0111\u1ec3 reset v\u1ec1 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u\n            const regenerateButtons = document.querySelectorAll('button, .ant-btn');\n            let foundRegenerate = false;\n\n            for (const btn of regenerateButtons) {\n                const btnText = (btn.textContent || '').toLowerCase().trim();\n                if (btnText.includes('regenerate') || btnText.includes('t\u1ea1o l\u1ea1i') ||\n                    btnText.includes('generate') || btnText.includes('t\u1ea1o')) {\n                    if (btn.offsetParent !== null && !btn.disabled) {\n                        addLogEntry(`\ud83d\udd04 T\u00ecm th\u1ea5y n\u00fat \"${btn.textContent}\" - \u0111ang kh\u00f4i ph\u1ee5c...`, 'info');\n                        KxTOuAJu(btn);\n                        foundRegenerate = true;\n                        break;\n                    }\n                }\n            }\n\n            if (!foundRegenerate) {\n                addLogEntry(`\u26a0\ufe0f Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat reset, th\u1eed t\u00ecm n\u00fat kh\u00e1c...`, 'warning');\n                // T\u00ecm b\u1ea5t k\u1ef3 n\u00fat n\u00e0o c\u00f3 th\u1ec3 reset\n                const anyButton = document.querySelector('.clone-voice-ux-v2 button, .clone-voice-ux-v2 .ant-btn');\n                if (anyButton && anyButton.offsetParent !== null && !anyButton.disabled) {\n                    addLogEntry(`\ud83d\udd04 S\u1eed d\u1ee5ng n\u00fat \"${anyButton.textContent}\" \u0111\u1ec3 kh\u00f4i ph\u1ee5c...`, 'info');\n                    KxTOuAJu(anyButton);\n                    foundRegenerate = true;\n                }\n            }\n\n            if (foundRegenerate) {\n                // Ch\u1edd web x\u1eed l\u00fd reset\n                addLogEntry(`\u23f3 Ch\u1edd web x\u1eed l\u00fd kh\u00f4i ph\u1ee5c...`, 'info');\n                await new Promise(resolve => setTimeout(resolve, 3000));\n\n                // 2. Clear textarea \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i s\u1ea1ch\n                const textarea = document.getElementById('gemini-hidden-text-for-request');\n                if (textarea) {\n                    textarea.value = '';\n                    addLogEntry(`\ud83e\uddf9 \u0110\u00e3 clear textarea`, 'info');\n                }\n\n                // 3. Ch\u1edd th\u00eam m\u1ed9t ch\u00fat \u0111\u1ec3 web \u1ed5n \u0111\u1ecbnh\n                await new Promise(resolve => setTimeout(resolve, 2000));\n\n                // 4. Ki\u1ec3m tra l\u1ea1i xem web \u0111\u00e3 s\u1eb5n s\u00e0ng ch\u01b0a\n                if (isWebReadyForNewChunk()) {\n                    addLogEntry(`\u2705 Web \u0111\u00e3 \u0111\u01b0\u1ee3c kh\u00f4i ph\u1ee5c v\u1ec1 tr\u1ea1ng th\u00e1i s\u1eb5n s\u00e0ng!`, 'success');\n                    return true;\n                } else {\n                    addLogEntry(`\u26a0\ufe0f Web ch\u01b0a ho\u00e0n to\u00e0n s\u1eb5n s\u00e0ng, th\u1eed l\u1ea1i...`, 'warning');\n                    // Th\u1eed th\u00eam m\u1ed9t l\u1ea7n n\u1eefa\n                    await new Promise(resolve => setTimeout(resolve, 2000));\n                    if (isWebReadyForNewChunk()) {\n                        addLogEntry(`\u2705 Web \u0111\u00e3 s\u1eb5n s\u00e0ng sau l\u1ea7n th\u1eed th\u1ee9 2!`, 'success');\n                        return true;\n                    }\n                }\n            }\n\n            addLogEntry(`\u274c Kh\u00f4ng th\u1ec3 kh\u00f4i ph\u1ee5c web v\u1ec1 tr\u1ea1ng th\u00e1i s\u1eb5n s\u00e0ng`, 'error');\n            return false;\n\n        } catch (error) {\n            addLogEntry(`\u274c L\u1ed7i khi kh\u00f4i ph\u1ee5c web: ${error.message}`, 'error');\n            return false;\n        }\n    }\n\n    // H\u00e0m reset web v\u1ec1 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u (gi\u1eef nguy\u00ean cho t\u01b0\u01a1ng th\u00edch)\n    async function resetWebToInitialState() {\n        return await restoreWebToSuccessState();\n    }\n\n    // H\u00e0m x\u1eed l\u00fd t\u1eebng chunk v\u1edbi retry logic c\u1ea3i ti\u1ebfn\n    async function processSingleChunk(chunkObject) {\n        if (processingState.isStopped) return false;\n        for (let attempt = 1; attempt <= MAX_RETRIES_PER_CHUNK; attempt++) {\n            if (processingState.isStopped) return false;\n            while (processingState.isPaused && !processingState.isStopped) {\n                addLogEntry('\u2139\ufe0f \u0110\u00e3 t\u1ea1m d\u1eebng. Ch\u1edd \u0111\u1ec3 ti\u1ebfp t\u1ee5c...', 'warning');\n                await new Promise(resolve => setTimeout(resolve, 2000));\n            }\n\n            // Ch\u1ec9 reset web khi retry (l\u1ea7n th\u1eed > 1) v\u00ec l\u1ea7n \u0111\u1ea7u c\u00f3 th\u1ec3 web v\u1eabn ho\u1ea1t \u0111\u1ed9ng t\u1ed1t\n            if (attempt > 1) {\n                addLogEntry(`\ud83d\udd04 [Chunk ${chunkObject.originalIndex + 1}] L\u1ea7n th\u1eed ${attempt} - \u0110ang reset web...`, 'info');\n                addLogEntry(`\ud83d\udd04 \u0110ang kh\u00f4i ph\u1ee5c web v\u1ec1 tr\u1ea1ng th\u00e1i nh\u01b0 l\u00fac g\u1eedi chunk th\u00e0nh c\u00f4ng...`, 'info');\n                await restoreWebToSuccessState();\n            }\n\n            try {\n                // Ch\u1ec9 ki\u1ec3m tra web s\u1eb5n s\u00e0ng khi \u0111\u00e3 reset (l\u1ea7n th\u1eed > 1) ho\u1eb7c khi web c\u00f3 th\u1ec3 b\u1ecb treo\n                if (attempt > 1 || !isWebReadyForNewChunk()) {\n                    if (!isWebReadyForNewChunk()) {\n                        addLogEntry(`\u26a0\ufe0f [Chunk ${chunkObject.originalIndex + 1}] Web ch\u01b0a s\u1eb5n s\u00e0ng, \u0111ang kh\u00f4i ph\u1ee5c...`, 'warning');\n                        addLogEntry(`\ud83d\udd04 \u0110ang reset web...`, 'info');\n                        const restoreSuccess = await restoreWebToSuccessState();\n                        if (!restoreSuccess) {\n                            throw new Error(\"Web kh\u00f4ng s\u1eb5n s\u00e0ng v\u00e0 kh\u00f4ng th\u1ec3 kh\u00f4i ph\u1ee5c\");\n                        }\n                    }\n                }\n\n                document.getElementById('gemini-hidden-text-for-request').value = chunkObject.text;\n                addLogEntry(`\ud83d\udce6 [Chunk ${chunkObject.originalIndex + 1}] B\u1eaft \u0111\u1ea7u x\u1eed l\u00fd (th\u1eed l\u1ea7n ${attempt}/${MAX_RETRIES_PER_CHUNK})...`);\n\n                // S\u1eed d\u1ee5ng h\u00e0m waitForButton v\u1edbi c\u01a1 ch\u1ebf reset th\u00f4ng minh\n                addLogEntry(`\ud83d\udd0d [Chunk ${chunkObject.originalIndex + 1}] \u0110ang t\u00ecm n\u00fat s\u1eb5n s\u00e0ng...`, 'info');\n                const targetButton = await waitForButton(['regenerate', 't\u1ea1o l\u1ea1i', 'generate', 't\u1ea1o'], 20000);\n                KxTOuAJu(targetButton);\n                addLogEntry(`\u2705 \u0110\u00e3 g\u1eedi \u0111i chunk ${chunkObject.originalIndex + 1}`, 'success');\n\n                // Ch\u1edd website x\u1eed l\u00fd\n                addLogEntry(`\u23f3 \u0110ang ch\u1edd website x\u1eed l\u00fd chunk ${chunkObject.originalIndex + 1}...`, 'info');\n                await new Promise(resolve => setTimeout(resolve, 2000));\n\n                const audioBlob = await monitorPluginResult();\n                chunkObject.audioBlob = audioBlob;\n                chunkObject.status = 'success';\n                addLogEntry(`\u2705 [Chunk ${chunkObject.originalIndex + 1}] X\u1eed l\u00fd th\u00e0nh c\u00f4ng!`, 'success');\n                return true;\n            } catch (error) {\n                addLogEntry(`\u274c [Chunk ${chunkObject.originalIndex + 1}] L\u1ed7i l\u1ea7n ${attempt}: ${error.message}`, 'error');\n\n                // LU\u00d4N reset web khi g\u1eb7p l\u1ed7i tr\u01b0\u1edbc khi retry\n                addLogEntry(`\ud83d\udd04 Ph\u00e1t hi\u1ec7n l\u1ed7i, \u0111ang reset web v\u1ec1 tr\u1ea1ng th\u00e1i ban \u0111\u1ea7u...`, 'warning');\n                addLogEntry(`\ud83d\udd04 \u0110ang kh\u00f4i ph\u1ee5c web v\u1ec1 tr\u1ea1ng th\u00e1i nh\u01b0 l\u00fac g\u1eedi chunk th\u00e0nh c\u00f4ng...`, 'info');\n                await restoreWebToSuccessState();\n\n                if (attempt < MAX_RETRIES_PER_CHUNK) {\n                    addLogEntry(`\ud83d\udd04 S\u1ebd th\u1eed l\u1ea1i sau ${RETRY_DELAY_MS / 1000} gi\u00e2y...`, 'warning');\n                    await new Promise(resolve => setTimeout(resolve, RETRY_DELAY_MS));\n                }\n            }\n        }\n        chunkObject.status = 'failed';\n        addLogEntry(`\ud83d\udeab [Chunk ${chunkObject.originalIndex + 1}] Th\u1ea5t b\u1ea1i v\u0129nh vi\u1ec5n sau ${MAX_RETRIES_PER_CHUNK} l\u1ea7n th\u1eed. S\u1ebd b\u1ecf qua.`, 'error');\n        return false;\n    }\n\n    // H\u00e0m qu\u1ea3n l\u00fd h\u00e0ng \u0111\u1ee3i th\u00f4ng minh - N\u00e2ng c\u1ea5p: X\u1eed l\u00fd chunks l\u1ed7i tr\u1ef1c ti\u1ebfp\n    async function manageFullQueue() {\n        // L\u01b0\u1ee3t 1: X\u1eed l\u00fd t\u1ea5t c\u1ea3 chunks l\u1ea7n \u0111\u1ea7u\n        addLogEntry(`--- L\u01b0\u1ee3t 1: B\u1eaft \u0111\u1ea7u x\u1eed l\u00fd ${processingState.chunks.length} chunks ---`, 'info');\n        \n        for (const chunk of processingState.chunks) {\n            if (processingState.isStopped) break;\n            \n            chunk.status = 'processing';\n            await processSingleChunk(chunk);\n            const successfulChunks = processingState.chunks.filter(c => c.status === 'success').length;\n            nWHrScjZnIyNYzztyEWwM(successfulChunks, processingState.chunks.length);\n        }\n\n        if (processingState.isStopped) {\n            addLogEntry(\"\u2139\ufe0f Qu\u00e1 tr\u00ecnh \u0111\u00e3 \u0111\u01b0\u1ee3c ng\u01b0\u1eddi d\u00f9ng d\u1eebng l\u1ea1i.\", 'warning');\n            // Reset giao di\u1ec7n\n            document.getElementById('gemini-start-queue-btn').disabled = false;\n            document.getElementById('gemini-start-queue-btn').style.display = 'block';\n            document.getElementById('gemini-pause-btn').style.display = 'none';\n            document.getElementById('gemini-stop-btn').style.display = 'none';\n            return;\n        }\n\n        // Ki\u1ec3m tra chunks l\u1ed7i sau l\u01b0\u1ee3t \u0111\u1ea7u\n        const failedChunks = processingState.chunks.filter(c => c.status === 'failed' || c.status === 'processing');\n        \n        if (failedChunks.length === 0) {\n            addLogEntry(\"\ud83c\udf89 T\u1ea5t c\u1ea3 c\u00e1c chunk \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh c\u00f4ng!\", 'success');\n        } else {\n            // X\u00e1c \u0111\u1ecbnh c\u00e1c chunks l\u1ed7i\n            const failedIndices = failedChunks.map(c => c.originalIndex).sort((a, b) => a - b);\n            addLogEntry(`\u274c Ph\u00e1t hi\u1ec7n ${failedChunks.length} chunks l\u1ed7i: ${failedIndices.map(idx => idx + 1).join(', ')}`, 'error');\n            \n            // T\u00ecm ph\u1ea1m vi chunks c\u1ea7n x\u1eed l\u00fd (t\u1eeb chunk l\u1ed7i \u0111\u1ea7u ti\u00ean \u0111\u1ebfn chunk l\u1ed7i cu\u1ed1i c\u00f9ng)\n            const minFailedIndex = Math.min(...failedIndices);\n            const maxFailedIndex = Math.max(...failedIndices);\n            \n            addLogEntry(`\ud83d\udccb X\u00e1c \u0111\u1ecbnh ph\u1ea1m vi x\u1eed l\u00fd: Chunk ${minFailedIndex + 1} \u0111\u1ebfn ${maxFailedIndex + 1}`, 'info');\n            \n            // \u00c1p d\u1ee5ng c\u01a1 ch\u1ebf Reset an to\u00e0n: Kh\u00f4i ph\u1ee5c Giao di\u1ec7n m\u1ed9t l\u1ea7n\n            addLogEntry(`\ud83d\udd04 \u00c1p d\u1ee5ng c\u01a1 ch\u1ebf Reset an to\u00e0n: Kh\u00f4i ph\u1ee5c Giao di\u1ec7n...`, 'info');\n            addLogEntry(`\ud83d\udd04 \u0110ang nh\u1ea5n n\u00fat \"T\u1ea1o l\u1ea1i\" \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i web s\u1ea1ch s\u1ebd...`, 'info');\n            \n            try {\n                // T\u00ecm v\u00e0 click n\u00fat \"Regenerate\" ho\u1eb7c \"T\u1ea1o l\u1ea1i\"\n                const regenerateButtons = document.querySelectorAll('button, .ant-btn');\n                let foundRegenerate = false;\n\n                for (const btn of regenerateButtons) {\n                    const btnText = (btn.textContent || '').toLowerCase().trim();\n                    if (btnText.includes('regenerate') || btnText.includes('t\u1ea1o l\u1ea1i') ||\n                        btnText.includes('generate') || btnText.includes('t\u1ea1o')) {\n                        if (btn.offsetParent !== null && !btn.disabled) {\n                            addLogEntry(`\ud83d\udd04 T\u00ecm th\u1ea5y n\u00fat \"${btn.textContent}\" - \u0111ang reset...`, 'info');\n                            btn.click();\n                            foundRegenerate = true;\n                            break;\n                        }\n                    }\n                }\n\n                if (foundRegenerate) {\n                    // Ch\u1edd web x\u1eed l\u00fd reset\n                    addLogEntry(`\u23f3 Ch\u1edd web x\u1eed l\u00fd reset...`, 'info');\n                    await new Promise(resolve => setTimeout(resolve, 3000));\n\n                    // Clear textarea \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o tr\u1ea1ng th\u00e1i s\u1ea1ch\n                    const textarea = document.getElementById('gemini-hidden-text-for-request');\n                    if (textarea) {\n                        textarea.value = '';\n                        addLogEntry(`\ud83e\uddf9 \u0110\u00e3 clear textarea`, 'info');\n                    }\n\n                    // Ch\u1edd th\u00eam m\u1ed9t ch\u00fat \u0111\u1ec3 web \u1ed5n \u0111\u1ecbnh\n                    await new Promise(resolve => setTimeout(resolve, 2000));\n                    addLogEntry(`\u2705 Web \u0111\u00e3 \u0111\u01b0\u1ee3c reset th\u00e0nh c\u00f4ng!`, 'success');\n                } else {\n                    addLogEntry(`\u26a0\ufe0f Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat reset, th\u1eed t\u00ecm n\u00fat kh\u00e1c...`, 'warning');\n                    // T\u00ecm b\u1ea5t k\u1ef3 n\u00fat n\u00e0o c\u00f3 th\u1ec3 reset\n                    const anyButton = document.querySelector('.clone-voice-ux-v2 button, .clone-voice-ux-v2 .ant-btn');\n                    if (anyButton && anyButton.offsetParent !== null && !anyButton.disabled) {\n                        addLogEntry(`\ud83d\udd04 S\u1eed d\u1ee5ng n\u00fat \"${anyButton.textContent}\" \u0111\u1ec3 reset...`, 'info');\n                        anyButton.click();\n                        await new Promise(resolve => setTimeout(resolve, 3000));\n                        addLogEntry(`\u2705 Web \u0111\u00e3 \u0111\u01b0\u1ee3c reset b\u1eb1ng n\u00fat kh\u00e1c!`, 'success');\n                    } else {\n                        addLogEntry(`\u274c Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat n\u00e0o \u0111\u1ec3 reset web, ti\u1ebfp t\u1ee5c v\u1edbi restoreWebToSuccessState...`, 'error');\n                        await restoreWebToSuccessState();\n                    }\n                }\n            } catch (resetError) {\n                addLogEntry(`\u274c L\u1ed7i khi reset web: ${resetError.message}, ti\u1ebfp t\u1ee5c v\u1edbi restoreWebToSuccessState...`, 'error');\n                await restoreWebToSuccessState();\n            }\n            \n            // X\u1eed l\u00fd c\u00e1c chunks l\u1ed7i trong ph\u1ea1m vi t\u1eeb minFailedIndex \u0111\u1ebfn maxFailedIndex\n            // X\u1eed l\u00fd tu\u1ea7n t\u1ef1 ch\u1ec9 c\u00e1c chunks l\u1ed7i \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o gh\u00e9p \u0111\u00fang v\u1ecb tr\u00ed\n            addLogEntry(`--- L\u01b0\u1ee3t 2: X\u1eed l\u00fd l\u1ea1i chunks l\u1ed7i t\u1eeb ${minFailedIndex + 1} \u0111\u1ebfn ${maxFailedIndex + 1} ---`, 'info');\n            \n            for (let i = minFailedIndex; i <= maxFailedIndex; i++) {\n                if (processingState.isStopped) break;\n                \n                const chunk = processingState.chunks[i];\n                \n                // Ch\u1ec9 x\u1eed l\u00fd l\u1ea1i c\u00e1c chunks l\u1ed7i, b\u1ecf qua chunks \u0111\u00e3 th\u00e0nh c\u00f4ng\n                if (chunk.status === 'failed' || chunk.status === 'processing') {\n                    addLogEntry(`\ud83d\udce6 X\u1eed l\u00fd l\u1ea1i chunk ${i + 1} (chunk l\u1ed7i)...`, 'info');\n                    chunk.status = 'processing';\n                    await processSingleChunk(chunk);\n                    const successfulChunks = processingState.chunks.filter(c => c.status === 'success').length;\n                    nWHrScjZnIyNYzztyEWwM(successfulChunks, processingState.chunks.length);\n                } else if (chunk.status === 'success') {\n                    addLogEntry(`\u2705 Chunk ${i + 1} \u0111\u00e3 th\u00e0nh c\u00f4ng t\u1eeb tr\u01b0\u1edbc, b\u1ecf qua v\u00e0 ti\u1ebfp t\u1ee5c.`, 'success');\n                }\n            }\n            \n            addLogEntry(`\u2705 \u0110\u00e3 x\u1eed l\u00fd xong c\u00e1c chunks l\u1ed7i t\u1eeb ${minFailedIndex + 1} \u0111\u1ebfn ${maxFailedIndex + 1}`, 'success');\n        }\n\n        // Ki\u1ec3m tra k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng\n        if (!processingState.isStopped) {\n            const finalFailedChunks = processingState.chunks.filter(c => c.status === 'failed');\n            const successfulChunks = processingState.chunks.filter(c => c.status === 'success');\n\n            if (finalFailedChunks.length > 0) {\n                addLogEntry(`\ud83d\udeab Ho\u00e0n th\u00e0nh v\u1edbi ${successfulChunks.length}/${processingState.chunks.length} chunk th\u00e0nh c\u00f4ng.`, 'warning');\n                addLogEntry(`\u274c ${finalFailedChunks.length} chunk b\u1ecb l\u1ed7i: ${finalFailedChunks.map(c => c.originalIndex + 1).join(', ')}`, 'error');\n\n                if (successfulChunks.length > 0) {\n                    addLogEntry(\"\u26a0\ufe0f B\u1ea1n c\u00f3 th\u1ec3 gh\u00e9p file v\u1edbi c\u00e1c chunk \u0111\u00e3 th\u00e0nh c\u00f4ng (kh\u00f4ng \u0111\u1ea7y \u0111\u1ee7).\", 'warning');\n                }\n            } else {\n                addLogEntry(\"\u2705 \u0110\u00e3 x\u00e1c nh\u1eadn \u0111\u1ee7 t\u1ea5t c\u1ea3 c\u00e1c chunk. B\u1eaft \u0111\u1ea7u gh\u00e9p file...\", 'success');\n            }\n\n            // Ch\u1ec9 gh\u00e9p file n\u1ebfu c\u00f3 \u00edt nh\u1ea5t 1 chunk th\u00e0nh c\u00f4ng\n            addLogEntry(`\ud83d\udd0d Debug: C\u00f3 ${successfulChunks.length} chunk th\u00e0nh c\u00f4ng`, 'info');\n            addLogEntry(`\ud83d\udd0d Debug: T\u1ed5ng ${processingState.chunks.length} chunk`, 'info');\n\n            if (successfulChunks.length > 0) {\n                addLogEntry(\"\ud83d\ude80 B\u1eaft \u0111\u1ea7u g\u1ecdi h\u00e0m gh\u00e9p file cu\u1ed1i c\u00f9ng...\", 'info');\n                await finalMergeAndDownload();\n                addLogEntry(\"\u2705 Ho\u00e0n th\u00e0nh h\u00e0m gh\u00e9p file cu\u1ed1i c\u00f9ng!\", 'success');\n            } else {\n                addLogEntry(\"\u274c Kh\u00f4ng c\u00f3 chunk n\u00e0o th\u00e0nh c\u00f4ng \u0111\u1ec3 gh\u00e9p file!\", 'error');\n            }\n        }\n\n        // Reset giao di\u1ec7n\n        document.getElementById('gemini-start-queue-btn').disabled = false;\n        document.getElementById('gemini-start-queue-btn').style.display = 'block';\n        document.getElementById('gemini-pause-btn').style.display = 'none';\n        document.getElementById('gemini-stop-btn').style.display = 'none';\n    }\n    \n    // Expose ra global scope cho t\u1ea1o file h\u00e0ng lo\u1ea1t\n    window.manageFullQueue = manageFullQueue;\n\n\n\n    // H\u00e0m gh\u00e9p file cu\u1ed1i c\u00f9ng\n    async function finalMergeAndDownload() {\n        addLogEntry(\"\ud83c\udfaf B\u1eaeT \u0110\u1ea6U H\u00c0M GH\u00c9P FILE CU\u1ed0I C\u00d9NG\", 'success');\n        addLogEntry(\"\ud83d\udd0d Debug: \u0110ang ki\u1ec3m tra processingState.chunks...\", 'info');\n        addLogEntry(`\ud83d\udd0d Debug: processingState.chunks.length = ${processingState.chunks.length}`, 'info');\n\n        const timeTakenEl = document.getElementById('gemini-time-taken');\n        timeTakenEl.textContent = `Th\u1eddi gian x\u1eed l\u00fd: ${ymkKApNTfjOanYIBsxsoMNBX((new Date() - processingState.startTime) / 1000)}`;\n\n        // L\u1ecdc ch\u1ec9 c\u00e1c chunk th\u00e0nh c\u00f4ng\n        const successfulChunks = processingState.chunks.filter(c => c.status === 'success');\n        addLogEntry(`\ud83d\udd0d Debug: T\u00ecm th\u1ea5y ${successfulChunks.length} chunk th\u00e0nh c\u00f4ng`, 'info');\n\n        // Debug: Hi\u1ec3n th\u1ecb tr\u1ea1ng th\u00e1i c\u1ee7a t\u1ea5t c\u1ea3 chunk\n        processingState.chunks.forEach((chunk, index) => {\n            addLogEntry(`\ud83d\udd0d Debug: Chunk ${index + 1} - Status: ${chunk.status}, OriginalIndex: ${chunk.originalIndex}`, 'info');\n        });\n\n        const orderedBlobs = successfulChunks\n            .sort((a, b) => a.originalIndex - b.originalIndex)\n            .map(chunk => chunk.audioBlob);\n\n        if (orderedBlobs.length === 0) {\n            addLogEntry(\"\u274c Kh\u00f4ng c\u00f3 chunk n\u00e0o th\u00e0nh c\u00f4ng \u0111\u1ec3 gh\u00e9p file!\", 'error');\n            return;\n        }\n\n        if (orderedBlobs.length < processingState.chunks.length) {\n            const missingChunks = processingState.chunks.filter(c => c.status !== 'success');\n            addLogEntry(`\u26a0\ufe0f Gh\u00e9p file v\u1edbi ${orderedBlobs.length}/${processingState.chunks.length} chunk th\u00e0nh c\u00f4ng.`, 'warning');\n            addLogEntry(`\u274c Thi\u1ebfu chunk: ${missingChunks.map(c => c.originalIndex + 1).join(', ')}`, 'error');\n        }\n\n        // Khai b\u00e1o bi\u1ebfn \u1edf ngo\u00e0i \u0111\u1ec3 c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb m\u1ecdi n\u01a1i\n        let objectURL = null;\n        let downloadBtn = null;\n\n        try {\n            addLogEntry(\"\ud83d\udd27 \u0110ang t\u1ea1o file \u00e2m thanh cu\u1ed1i c\u00f9ng...\", 'info');\n            downloadBtn = document.getElementById('gemini-download-merged-btn');\n            const finalResultEl = document.getElementById('gemini-final-result');\n            const playPauseBtn = document.getElementById('waveform-play-pause');\n            const mergedBlob = new Blob(orderedBlobs, { type: 'audio/mpeg' });\n            objectURL = URL.createObjectURL(mergedBlob);\n\n            addLogEntry(\"\ud83d\udd17 \u0110ang thi\u1ebft l\u1eadp link t\u1ea3i xu\u1ed1ng...\", 'info');\n            downloadBtn.href = objectURL;\n            downloadBtn.download = i_B_kZYD();\n\n            addLogEntry(`\ud83d\udcc1 T\u00ean file: ${downloadBtn.download}`, 'info');\n            addLogEntry(\"\ud83c\udfb5 \u0110ang hi\u1ec3n th\u1ecb k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng...\", 'info');\n\n            addLogEntry(\"\ud83c\udfbc \u0110ang t\u1ea1o waveform...\", 'info');\n            finalResultEl.style.display = 'block';\n            document.getElementById('waveform-controls').style.display = 'block';\n            addLogEntry(\"\u2705 \u0110\u00e3 hi\u1ec3n th\u1ecb k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng v\u00e0 n\u00fat t\u1ea3i xu\u1ed1ng!\", 'success');\n\n            if (n_WwsStaC$jzsWjOIjRqedTG) n_WwsStaC$jzsWjOIjRqedTG.destroy();\n            n_WwsStaC$jzsWjOIjRqedTG = WaveSurfer.create({\n                container: '#gemini-waveform',\n                waveColor: '#bd93f9',\n                progressColor: '#ff79c6',\n                cursorColor: '#f8f8f2',\n                barWidth: 3,\n                barRadius: 3,\n                cursorWidth: 1,\n                height: 100,\n                barGap: 3\n            });\n            addLogEntry(\"\ud83d\udcca \u0110ang t\u1ea3i waveform...\", 'info');\n            n_WwsStaC$jzsWjOIjRqedTG.load(objectURL);\n            n_WwsStaC$jzsWjOIjRqedTG.on('pause', () => { playPauseBtn.innerHTML = '\u25b6\ufe0f'; });\n            n_WwsStaC$jzsWjOIjRqedTG.on('play', () => { playPauseBtn.innerHTML = '\u23f8\ufe0f'; });\n            addLogEntry(\"\u2705 Waveform \u0111\u00e3 s\u1eb5n s\u00e0ng!\", 'success');\n\n            addLogEntry(\"\ud83c\udf89 Gh\u00e9p file th\u00e0nh c\u00f4ng! File \u00e2m thanh \u0111\u00e3 s\u1eb5n s\u00e0ng!\", 'success');\n\n            // L\u01b0u file \u0111\u00e3 merge v\u00e0o l\u1ecbch s\u1eed IndexedDB (flow m\u1edbi - n\u1ebfu \u0111\u01b0\u1ee3c d\u00f9ng)\n            try {\n                const fileName = downloadBtn.download || 'merged_audio.mp3';\n                const db = window.historyDB || historyDB;\n                \n                if (db && typeof db.saveMergedFile === 'function') {\n                    await db.saveMergedFile(fileName, mergedBlob, {\n                        chunkCount: orderedBlobs.length,\n                        totalChunks: processingState.chunks.length\n                    });\n                    addLogEntry(`\ud83d\udcda \u0110\u00e3 l\u01b0u \"${fileName}\" v\u00e0o l\u1ecbch s\u1eed`, 'success');\n                }\n            } catch (historyError) {\n                console.error('L\u1ed7i l\u01b0u l\u1ecbch s\u1eed:', historyError);\n            }\n\n        } catch (e) {\n            addLogEntry(`\u274c L\u1ed7i khi t\u1ea1o file \u00e2m thanh cu\u1ed1i c\u00f9ng: ${e.message}`, 'error');\n        }\n\n        // \ud83c\udfaf T\u1ef0 \u0110\u1ed8NG T\u1ea2I XU\u1ed0NG NGAY SAU KHI GH\u00c9P XONG\n        if (objectURL && downloadBtn) {\n            addLogEntry(\"\ud83d\ude80 \u0110ang t\u1ef1 \u0111\u1ed9ng t\u1ea3i xu\u1ed1ng file \u00e2m thanh...\", 'info');\n\n            // T\u1ea1o link t\u1ea3i xu\u1ed1ng tr\u1ef1c ti\u1ebfp ngay l\u1eadp t\u1ee9c\n            setTimeout(() => {\n                try {\n                    addLogEntry(\"\ud83d\udd04 T\u1ea1o link t\u1ea3i xu\u1ed1ng tr\u1ef1c ti\u1ebfp...\", 'info');\n                    const directDownloadLink = document.createElement('a');\n                    directDownloadLink.href = objectURL;\n                    directDownloadLink.download = downloadBtn.download;\n                    directDownloadLink.style.display = 'none';\n                    document.body.appendChild(directDownloadLink);\n                    directDownloadLink.click();\n                    document.body.removeChild(directDownloadLink);\n                    addLogEntry(\"\u2705 \u0110\u00e3 t\u1ef1 \u0111\u1ed9ng t\u1ea3i xu\u1ed1ng file \u00e2m thanh!\", 'success');\n                } catch (error) {\n                    addLogEntry(`\u26a0\ufe0f L\u1ed7i khi t\u1ef1 \u0111\u1ed9ng t\u1ea3i xu\u1ed1ng: ${error.message}`, 'warning');\n                    addLogEntry(\"\ud83d\udca1 B\u1ea1n c\u00f3 th\u1ec3 click n\u00fat 'T\u1ea3i xu\u1ed1ng \u00e2m thanh' \u0111\u1ec3 t\u1ea3i file th\u1ee7 c\u00f4ng\", 'info');\n                }\n            }, 1000); // Ch\u1edd 1 gi\u00e2y \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o m\u1ecdi th\u1ee9 s\u1eb5n s\u00e0ng\n        } else {\n            addLogEntry(\"\u26a0\ufe0f Kh\u00f4ng th\u1ec3 t\u1ef1 \u0111\u1ed9ng t\u1ea3i xu\u1ed1ng v\u00ec thi\u1ebfu th\u00f4ng tin file\", 'warning');\n        }\n    }\n\n    // =======================================================\n    // == K\u1ebeT N\u1ed0I EVENT LISTENER V\u1edaI H\u1ec6 TH\u1ed0NG M\u1edaI ==\n    // =======================================================\n\n    // K\u1ebft n\u1ed1i n\u00fat Start v\u1edbi h\u1ec7 th\u1ed1ng th\u00f4ng minh\n    const startBtn = document.getElementById('gemini-start-queue-btn');\n    const pauseBtn = document.getElementById('gemini-pause-btn');\n    const stopBtn = document.getElementById('gemini-stop-btn');\n    const mainTextarea = document.getElementById('gemini-main-textarea');\n    const progressContainer = document.getElementById('gemini-progress-container');\n    const playPauseWaveformBtn = document.getElementById('waveform-play-pause');\n\n    if (startBtn) {\n        startBtn.addEventListener('click', () => {\n            let text = mainTextarea.value.trim();\n            \n            // \u2b50 TH\u00caM M\u1edaI: T\u1ef1 \u0111\u1ed9ng s\u1eeda \"ai\" \u2192 \"Ai\" v\u00e0 \"im\" \u2192 \"Im\" cho Ti\u1ebfng Vi\u1ec7t\n            if (typeof window.fixVietnameseWords === 'function') {\n                const fixedText = window.fixVietnameseWords(text);\n                if (fixedText !== text) {\n                    mainTextarea.value = fixedText;\n                    text = fixedText;\n                    console.log('\u2705 Auto-fixed Vietnamese words before starting audio generation');\n                    \n                    // Show notification (kh\u00f4ng ch\u1eb7n execution)\n                    if (typeof Swal !== 'undefined') {\n                        Swal.fire({\n                            toast: true,\n                            position: 'top-end',\n                            icon: 'info',\n                            title: '\u0110\u00e3 t\u1ef1 \u0111\u1ed9ng s\u1eeda t\u1eeb',\n                            text: '\u0110\u00e3 s\u1eeda \"ai\" \u2192 \"Ai\", \"im\" \u2192 \"Im\"',\n                            showConfirmButton: false,\n                            timer: 2000,\n                            timerProgressBar: true\n                        });\n                    }\n                }\n            }\n            \n            if (!text) {\n                Swal.fire({ icon: 'warning', title: 'Ch\u01b0a c\u00f3 n\u1ed9i dung', text: 'Vui l\u00f2ng nh\u1eadp v\u0103n b\u1ea3n c\u1ea7n t\u1ea1o gi\u1ecdng n\u00f3i.' });\n                return;\n            }\n\n            // \ud83d\udd27 X\u00d3A S\u1ea0CH C\u00c1C BI\u1ebeN TO\u00c0N C\u1ee4C C\u0168 \u0110\u1ec2 TR\u00c1NH N\u1ed0I TH\u1eeaA AUDIO\n            ZTQj$LF$o = [];\n            SI$acY = [];\n            ttuo$y_KhCV = 0;\n            window.chunkBlobs = []; // Force reset\n            window.totalChunksForCurrentBatch = 0; // Th\u00eam bi\u1ebfn \u0111\u1ebfm chunk cho batch hi\u1ec7n t\u1ea1i\n            window.chunkStatus = []; // Reset tr\u1ea1ng th\u00e1i chunk\n            window.failedChunks = []; // Reset danh s\u00e1ch chunk th\u1ea5t b\u1ea1i\n            addLogEntry('\ud83e\uddf9 \u0110\u00e3 x\u00f3a s\u1ea1ch d\u1eef li\u1ec7u audio c\u0169', 'info');\n\n            // 1. Kh\u1edfi t\u1ea1o tr\u1ea1ng th\u00e1i (\u0110\u00c3 N\u00c2NG C\u1ea4P)\n            processingState.isPaused = false;\n            processingState.isStopped = false;\n            processingState.startTime = new Date();\n\n            // Lu\u00f4n \u00e1p d\u1ee5ng t\u00e1ch chunk th\u00f4ng minh (theo \u0111o\u1ea1n, fallback theo d\u00f2ng/\u0111\u1ed9 d\u00e0i)\n            addLogEntry('\ud83e\udde0 \u00c1p d\u1ee5ng t\u00e1ch chunk th\u00f4ng minh.', 'info');\n            const chunksArray = smartSplitter(text, 3000);\n\n            // G\u00e1n m\u1ea3ng chunk \u0111\u00e3 x\u1eed l\u00fd v\u00e0o processingState\n            processingState.chunks = chunksArray.map((txt, index) => ({\n                text: txt.trim(), // Th\u00eam .trim() \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o s\u1ea1ch s\u1ebd\n                status: 'pending',\n                retryCount: 0,\n                originalIndex: index,\n                audioBlob: null\n            }));\n\n            // \ud83d\udd27 KH\u1edeI T\u1ea0O L\u1ea0I ARRAYS V\u1edaI \u0110\u00daNG S\u1ed0 L\u01af\u1ee2NG CHUNKS\n            window.totalChunksForCurrentBatch = chunksArray.length;\n            window.chunkBlobs = new Array(chunksArray.length).fill(null);\n            ZTQj$LF$o = new Array(chunksArray.length).fill(null);\n            SI$acY = chunksArray; // C\u1eadp nh\u1eadt SI$acY v\u1edbi chunks m\u1edbi\n            window.chunkStatus = new Array(chunksArray.length).fill('pending'); // Kh\u1edfi t\u1ea1o tr\u1ea1ng th\u00e1i chunk\n            window.failedChunks = []; // Reset danh s\u00e1ch chunk th\u1ea5t b\u1ea1i\n            addLogEntry(`\ud83d\udd27 \u0110\u00e3 kh\u1edfi t\u1ea1o arrays v\u1edbi ${chunksArray.length} v\u1ecb tr\u00ed cho batch m\u1edbi`, 'info');\n\n            // 2. C\u1eadp nh\u1eadt giao di\u1ec7n\n            startBtn.disabled = true;\n            startBtn.style.display = 'none';\n            pauseBtn.style.display = 'block';\n            stopBtn.style.display = 'block';\n            progressContainer.style.display = 'block';\n            document.getElementById('gemini-final-result').style.display = 'none';\n            if (n_WwsStaC$jzsWjOIjRqedTG) n_WwsStaC$jzsWjOIjRqedTG.destroy();\n            clearLog();\n            addLogEntry(`B\u1eaft \u0111\u1ea7u x\u1eed l\u00fd ${processingState.chunks.length} chunk...`, 'info');\n\n            // 3. B\u1eaft \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i th\u00f4ng minh\n            manageFullQueue();\n        });\n    }\n\n    // N\u00fat T\u1ea1m d\u1eebng / Ti\u1ebfp t\u1ee5c\n    if (pauseBtn) {\n        pauseBtn.addEventListener('click', () => {\n            processingState.isPaused = !processingState.isPaused;\n            pauseBtn.textContent = processingState.isPaused ? '\u25b6\ufe0f Ti\u1ebfp t\u1ee5c' : '\u23f8\ufe0f T\u1ea1m d\u1eebng';\n        });\n    }\n\n    // N\u00fat D\u1eebng h\u1eb3n\n    if (stopBtn) {\n        stopBtn.addEventListener('click', () => {\n            processingState.isStopped = true;\n            processingState.isPaused = false;\n            addLogEntry(\"\ud83d\udd34 Ng\u01b0\u1eddi d\u00f9ng \u0111\u00e3 y\u00eau c\u1ea7u d\u1eebng h\u1eb3n qu\u00e1 tr\u00ecnh.\", 'error');\n\n            // \ud83d\udd27 X\u00d3A S\u1ea0CH D\u1eee LI\u1ec6U KHI D\u1eeaNG\n            ZTQj$LF$o = [];\n            SI$acY = [];\n            ttuo$y_KhCV = 0;\n            window.chunkBlobs = [];\n            window.totalChunksForCurrentBatch = 0;\n            window.chunkStatus = [];\n            window.failedChunks = [];\n            processingState.chunks = [];\n            addLogEntry('\ud83e\uddf9 \u0110\u00e3 x\u00f3a s\u1ea1ch d\u1eef li\u1ec7u khi d\u1eebng', 'info');\n\n            // Reset giao di\u1ec7n\n            startBtn.disabled = false;\n            startBtn.style.display = 'block';\n            pauseBtn.style.display = 'none';\n            stopBtn.style.display = 'none';\n        });\n    }\n\n    // N\u00fat Play/Pause c\u1ee7a WaveSurfer\n    if (playPauseWaveformBtn) {\n        playPauseWaveformBtn.addEventListener('click', ()=>{\n            if(n_WwsStaC$jzsWjOIjRqedTG) n_WwsStaC$jzsWjOIjRqedTG.playPause();\n        });\n    }\n\n    // === TH\u00caM C\u1ea2NH B\u00c1O GMAIL \u0110\u0102NG NH\u1eacP ===\n\n    // H\u00e0m ki\u1ec3m tra \u0111\u0103ng nh\u1eadp Gmail \u0111\u01a1n gi\u1ea3n\n    function checkGmailLogin() {\n        // Ki\u1ec3m tra c\u00e1c d\u1ea5u hi\u1ec7u \u0111\u0103ng nh\u1eadp Gmail\n        const hasGmailCookies = document.cookie.includes('SAPISID=') ||\n                                document.cookie.includes('SID=') ||\n                                document.cookie.includes('HSID=');\n\n        const hasGmailStorage = Object.keys(localStorage).some(key =>\n            key.includes('google') && localStorage.getItem(key) &&\n            localStorage.getItem(key).length > 10\n        );\n\n        const hasGmailElements = document.querySelector('img[src*=\"googleusercontent\"]') !== null ||\n                                 document.querySelector('[aria-label*=\"Account\"]') !== null;\n\n        return hasGmailCookies || hasGmailStorage || hasGmailElements;\n    }\n\n    // H\u00e0m hi\u1ec3n th\u1ecb c\u1ea3nh b\u00e1o nh\u1eb9 nh\u00e0ng\n    function showGmailReminder() {\n        // T\u1ea1o th\u00f4ng b\u00e1o nh\u1eb9 nh\u00e0ng\n        const reminder = document.createElement('div');\n        reminder.id = 'gmail-reminder';\n        reminder.style.cssText = `\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 30px 40px;\n            border-radius: 20px;\n            box-shadow: 0 10px 30px rgba(0,0,0,0.4);\n            z-index: 10000;\n            font-family: 'Segoe UI', Arial, sans-serif;\n            font-size: 18px;\n            width: 600px;\n            min-height: 120px;\n            border-left: 6px solid #ffd700;\n            animation: fadeInScale 0.6s ease-out;\n            display: flex;\n            align-items: center;\n        `;\n\n        reminder.innerHTML = `\n            <div style=\"display: flex; align-items: center; gap: 20px; width: 100%;\">\n                <div style=\"font-size: 36px; flex-shrink: 0;\">\ud83d\udd10</div>\n                <div style=\"flex: 1; display: flex; flex-direction: column; gap: 8px;\">\n                    <div style=\"font-weight: bold; font-size: 22px; color: #ffd700; white-space: nowrap;\">C\u1ea3nh b\u00e1o \u0111\u0103ng nh\u1eadp Gmail</div>\n                    <div style=\"font-size: 16px; opacity: 0.95; line-height: 1.4; white-space: nowrap;\">\n                        Tool s\u1ebd l\u1ed7i n\u1ebfu b\u1ea1n kh\u00f4ng \u0111\u0103ng nh\u1eadp Gmail v\u00e0o trang Minimax.\n                    </div>\n                    <div style=\"font-size: 14px; opacity: 0.8; font-style: italic; white-space: nowrap;\">\n                        H\u00e3y \u0111\u0103ng nh\u1eadp \u0111\u1ec3 tool ho\u1ea1t \u0111\u1ed9ng.\n                    </div>\n                </div>\n                <button onclick=\"this.parentElement.parentElement.remove()\"\n                        style=\"background: rgba(255,255,255,0.25); border: 2px solid rgba(255,255,255,0.3); color: white; font-size: 24px; cursor: pointer; padding: 15px 20px; border-radius: 10px; margin-left: 15px; font-weight: bold; min-width: 60px; min-height: 60px; display: flex; align-items: center; justify-content: center;\"\n                        onmouseover=\"this.style.background='rgba(255,255,255,0.4)'; this.style.borderColor='rgba(255,255,255,0.5)'; this.style.transform='scale(1.05)'\"\n                        onmouseout=\"this.style.background='rgba(255,255,255,0.25)'; this.style.borderColor='rgba(255,255,255,0.3)'; this.style.transform='scale(1)'\">\n                    \u00d7\n                </button>\n            </div>\n        `;\n\n        // Th\u00eam CSS animation\n        const style = document.createElement('style');\n        style.textContent = `\n            @keyframes fadeInScale {\n                from {\n                    transform: translate(-50%, -50%) scale(0.8);\n                    opacity: 0;\n                }\n                to {\n                    transform: translate(-50%, -50%) scale(1);\n                    opacity: 1;\n                }\n            }\n            #gmail-reminder {\n                animation: fadeInScale 0.5s ease-out;\n            }\n        `;\n        document.head.appendChild(style);\n\n        document.body.appendChild(reminder);\n    }\n\n    // T\u00ean kh\u00f3a \u0111i\u1ec1u khi\u1ec3n v\u00f2ng l\u1eb7p reload\n    const RELOAD_LOOP_KEY = 'mmx_auto_reload_until_gmail_login_v1';\n    \n    // N\u1ebfu tr\u01b0\u1edbc \u0111\u00f3 \u0111\u00e3 b\u1eadt v\u00f2ng l\u1eb7p reload v\u00e0 v\u1eabn ch\u01b0a \u0111\u0103ng nh\u1eadp -> ti\u1ebfp t\u1ee5c reload ngay\n    try {\n        if (localStorage.getItem(RELOAD_LOOP_KEY) === '1' && !checkGmailLogin()) {\n            location.reload();\n        } else if (checkGmailLogin()) {\n            // \u0110\u00e3 \u0111\u0103ng nh\u1eadp th\u00ec t\u1eaft c\u1edd v\u00f2ng l\u1eb7p\n            localStorage.removeItem(RELOAD_LOOP_KEY);\n        }\n    } catch (e) {}\n\n    // Ch\u1edd 3 gi\u00e2y r\u1ed3i m\u1edbi ki\u1ec3m tra \u0111\u0103ng nh\u1eadp Gmail\n    setTimeout(() => {\n        if (checkGmailLogin()) {\n            try { localStorage.removeItem(RELOAD_LOOP_KEY); } catch (e) {}\n            return;\n        }\n\n        // Ch\u01b0a \u0111\u0103ng nh\u1eadp -> b\u1eadt c\u1edd v\u00e0 reset ngay l\u1eadp t\u1ee9c\n        try { localStorage.setItem(RELOAD_LOOP_KEY, '1'); } catch (e) {}\n        location.reload();\n    }, 3000);\n\n    // =================================================================\n    // == C\u01a0 CH\u1ebe T\u1ef0 \u0110\u1ed8NG RESET KHI PH\u00c1T HI\u1ec6N L\u1ed6I 403 ==\n    // =================================================================\n    \n    // Kh\u00f3a \u0111i\u1ec1u khi\u1ec3n c\u01a1 ch\u1ebf auto reset 403\n    const AUTO_RESET_403_KEY = 'mmx_auto_reset_403_v1';\n    \n    // Bi\u1ebfn theo d\u00f5i tr\u1ea1ng th\u00e1i c\u01a1 ch\u1ebf\n    let autoReset403Active = false;\n    let autoReset403Timer = null;\n    let error403Count = 0;\n    \n    // H\u00e0m ki\u1ec3m tra v\u00e0 x\u1eed l\u00fd l\u1ed7i 403\n    function handle403Error() {\n        if (!autoReset403Active) return;\n        \n        error403Count++;\n        console.log(`[AUTO RESET 403] Ph\u00e1t hi\u1ec7n l\u1ed7i 403 l\u1ea7n th\u1ee9 ${error403Count}`);\n        \n        // Reset trang ngay l\u1eadp t\u1ee9c\n        try {\n            localStorage.setItem(AUTO_RESET_403_KEY, '1');\n            location.reload();\n        } catch (e) {\n            console.error('[AUTO RESET 403] L\u1ed7i khi reset trang:', e);\n        }\n    }\n    \n    // H\u00e0m b\u1eaft \u0111\u1ea7u c\u01a1 ch\u1ebf auto reset 403\n    function startAutoReset403() {\n        if (autoReset403Active) return;\n        \n        autoReset403Active = true;\n        error403Count = 0;\n        \n        console.log('[AUTO RESET 403] B\u1eaft \u0111\u1ea7u c\u01a1 ch\u1ebf t\u1ef1 \u0111\u1ed9ng reset khi ph\u00e1t hi\u1ec7n l\u1ed7i 403');\n        \n        // T\u1ef1 \u0111\u1ed9ng t\u1eaft sau 5 gi\u00e2y\n        autoReset403Timer = setTimeout(() => {\n            stopAutoReset403();\n        }, 5000);\n    }\n    \n    // H\u00e0m d\u1eebng c\u01a1 ch\u1ebf auto reset 403\n    function stopAutoReset403() {\n        if (!autoReset403Active) return;\n        \n        autoReset403Active = false;\n        error403Count = 0;\n        \n        if (autoReset403Timer) {\n            clearTimeout(autoReset403Timer);\n            autoReset403Timer = null;\n        }\n        \n        try {\n            localStorage.removeItem(AUTO_RESET_403_KEY);\n        } catch (e) {}\n        \n        console.log('[AUTO RESET 403] \u0110\u00e3 t\u1eaft c\u01a1 ch\u1ebf t\u1ef1 \u0111\u1ed9ng reset');\n    }\n    \n    // Override XMLHttpRequest \u0111\u1ec3 b\u1eaft l\u1ed7i 403\n    const originalXHROpen = XMLHttpRequest.prototype.open;\n    const originalXHRSend = XMLHttpRequest.prototype.send;\n    \n    XMLHttpRequest.prototype.open = function(method, url, async, user, password) {\n        this._url = url;\n        return originalXHROpen.apply(this, arguments);\n    };\n    \n    XMLHttpRequest.prototype.send = function(data) {\n        const xhr = this;\n        \n        // Override onreadystatechange\n        const originalOnReadyStateChange = xhr.onreadystatechange;\n        xhr.onreadystatechange = function() {\n            if (originalOnReadyStateChange) {\n                originalOnReadyStateChange.apply(this, arguments);\n            }\n            \n            if (xhr.readyState === 4 && xhr.status === 403) {\n                console.log('[AUTO RESET 403] Ph\u00e1t hi\u1ec7n l\u1ed7i 403 t\u1eeb request:', xhr._url);\n                handle403Error();\n            }\n        };\n        \n        return originalXHRSend.apply(this, arguments);\n    };\n    \n    // Override fetch \u0111\u1ec3 b\u1eaft l\u1ed7i 403\n    const originalFetch = window.fetch;\n    window.fetch = function(url, options) {\n        return originalFetch.apply(this, arguments).then(response => {\n            if (response.status === 403) {\n                console.log('[AUTO RESET 403] Ph\u00e1t hi\u1ec7n l\u1ed7i 403 t\u1eeb fetch:', url);\n                handle403Error();\n            }\n            return response;\n        }).catch(error => {\n            if (error.message && error.message.includes('403')) {\n                console.log('[AUTO RESET 403] Ph\u00e1t hi\u1ec7n l\u1ed7i 403 t\u1eeb fetch catch:', url);\n                handle403Error();\n            }\n            throw error;\n        });\n    };\n    \n    // Ki\u1ec3m tra n\u1ebfu \u0111ang trong v\u00f2ng l\u1eb7p auto reset 403\n    try {\n        if (localStorage.getItem(AUTO_RESET_403_KEY) === '1') {\n            // \u0110ang trong v\u00f2ng l\u1eb7p auto reset, b\u1eaft \u0111\u1ea7u c\u01a1 ch\u1ebf ngay\n            startAutoReset403();\n        }\n    } catch (e) {}\n    \n    // B\u1eaft \u0111\u1ea7u c\u01a1 ch\u1ebf auto reset 403 sau khi trang load xong\n    setTimeout(() => {\n        startAutoReset403();\n    }, 1000);\n    \n    // Observer \u0111\u1ec3 theo d\u00f5i c\u00e1c th\u00f4ng b\u00e1o l\u1ed7i 403 tr\u00ean trang\n    function observeErrorMessages() {\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                if (mutation.type === 'childList') {\n                    mutation.addedNodes.forEach((node) => {\n                        if (node.nodeType === Node.ELEMENT_NODE) {\n                            // Ki\u1ec3m tra text content c\u00f3 ch\u1ee9a \"403\" kh\u00f4ng\n                            const textContent = node.textContent || '';\n                            if (textContent.includes('403') || textContent.includes('Request failed with status code 403')) {\n                                console.log('[AUTO RESET 403] Ph\u00e1t hi\u1ec7n th\u00f4ng b\u00e1o l\u1ed7i 403 tr\u00ean trang:', textContent);\n                                handle403Error();\n                                return;\n                            }\n                            \n                            // Ki\u1ec3m tra c\u00e1c element con\n                            const errorElements = node.querySelectorAll ? node.querySelectorAll('*') : [];\n                            errorElements.forEach((element) => {\n                                const elementText = element.textContent || '';\n                                if (elementText.includes('403') || elementText.includes('Request failed with status code 403')) {\n                                    console.log('[AUTO RESET 403] Ph\u00e1t hi\u1ec7n th\u00f4ng b\u00e1o l\u1ed7i 403 trong element:', elementText);\n                                    handle403Error();\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n        });\n        \n        // B\u1eaft \u0111\u1ea7u quan s\u00e1t to\u00e0n b\u1ed9 document\n        observer.observe(document.body, {\n            childList: true,\n            subtree: true,\n            characterData: true\n        });\n        \n        return observer;\n    }\n    \n    // B\u1eaft \u0111\u1ea7u quan s\u00e1t th\u00f4ng b\u00e1o l\u1ed7i\n    let errorObserver = null;\n    setTimeout(() => {\n        errorObserver = observeErrorMessages();\n    }, 2000);\n    \n    // Override user info text to show \"Kz Tool\" and keep it\n    function setUserInfoText() {\n        const userInfo = document.getElementById('gemini-user-info');\n        if (userInfo && userInfo.textContent !== '\u2705 Kz Tool') {\n            userInfo.textContent = '\u2705 Kz Tool';\n            userInfo.innerHTML = '\u2705 Kz Tool';\n        }\n    }\n    \n    // Set initial text\n    setTimeout(setUserInfoText, 500);\n    setTimeout(setUserInfoText, 1500);\n    setTimeout(setUserInfoText, 3000);\n    \n    // Observe changes and keep overriding\n    const userInfoObserver = new MutationObserver(() => {\n        setUserInfoText();\n    });\n    \n    setTimeout(() => {\n        const userInfo = document.getElementById('gemini-user-info');\n        if (userInfo) {\n            userInfoObserver.observe(userInfo, {\n                childList: true,\n                characterData: true,\n                subtree: true\n            });\n        }\n    }, 100);\n    \n    // =================================================================\n    // == INDEXEDDB - L\u01afU AUDIO \u0110\u00c3 UPLOAD ==\n    // =================================================================\n    \n    const DB_NAME = 'SavedAudioDB';\n    const DB_VERSION = 1;\n    const STORE_NAME = 'audios';\n    let db = null;\n    \n    // Initialize IndexedDB\n    function initIndexedDB() {\n        return new Promise((resolve, reject) => {\n            const request = indexedDB.open(DB_NAME, DB_VERSION);\n            \n            request.onerror = () => {\n                addLogEntry('\u274c Kh\u00f4ng th\u1ec3 m\u1edf IndexedDB', 'error');\n                reject(request.error);\n            };\n            \n            request.onsuccess = () => {\n                db = request.result;\n                addLogEntry('\u2705 IndexedDB \u0111\u00e3 kh\u1edfi t\u1ea1o', 'success');\n                resolve(db);\n            };\n            \n            request.onupgradeneeded = (event) => {\n                db = event.target.result;\n                if (!db.objectStoreNames.contains(STORE_NAME)) {\n                    const objectStore = db.createObjectStore(STORE_NAME, { keyPath: 'id', autoIncrement: true });\n                    objectStore.createIndex('name', 'name', { unique: false });\n                    objectStore.createIndex('uploadDate', 'uploadDate', { unique: false });\n                    addLogEntry('\u2705 \u0110\u00e3 t\u1ea1o object store cho audio', 'success');\n                }\n            };\n        });\n    }\n    \n    // Check if audio already exists in IndexedDB\n    async function isAudioExists(fileName) {\n        if (!db) return false;\n        \n        try {\n            const transaction = db.transaction([STORE_NAME], 'readonly');\n            const objectStore = transaction.objectStore(STORE_NAME);\n            const request = objectStore.getAll();\n            \n            return new Promise((resolve) => {\n                request.onsuccess = () => {\n                    const audios = request.result;\n                    const exists = audios.some(audio => audio.name === fileName);\n                    resolve(exists);\n                };\n                \n                request.onerror = () => {\n                    resolve(false);\n                };\n            });\n        } catch (error) {\n            return false;\n        }\n    }\n    \n    // Save audio to IndexedDB\n    async function saveAudioToIndexedDB(file, duration) {\n        if (!db) {\n            addLogEntry('\u26a0\ufe0f IndexedDB ch\u01b0a s\u1eb5n s\u00e0ng', 'warning');\n            return;\n        }\n        \n        // Check if audio already exists\n        const exists = await isAudioExists(file.name);\n        if (exists) {\n            addLogEntry(`\u26a0\ufe0f Audio \"${file.name}\" \u0111\u00e3 t\u1ed3n t\u1ea1i, b\u1ecf qua`, 'warning');\n            return;\n        }\n        \n        try {\n            const transaction = db.transaction([STORE_NAME], 'readwrite');\n            const objectStore = transaction.objectStore(STORE_NAME);\n            \n            const audioData = {\n                name: file.name,\n                blob: file,\n                duration: duration,\n                uploadDate: new Date().toISOString(),\n                size: file.size,\n                type: file.type\n            };\n            \n            const request = objectStore.add(audioData);\n            \n            return new Promise((resolve, reject) => {\n                request.onsuccess = () => {\n                    addLogEntry(`\ud83d\udcbe \u0110\u00e3 l\u01b0u audio: ${file.name}`, 'success');\n                    loadSavedAudios(); // Refresh list\n                    resolve(request.result);\n                };\n                \n                request.onerror = () => {\n                    addLogEntry(`\u274c L\u1ed7i l\u01b0u audio: ${request.error}`, 'error');\n                    reject(request.error);\n                };\n            });\n        } catch (error) {\n            addLogEntry(`\u274c L\u1ed7i saveAudioToIndexedDB: ${error}`, 'error');\n        }\n    }\n    \n    // Load saved audios from IndexedDB\n    async function loadSavedAudios() {\n        if (!db) {\n            addLogEntry('\u26a0\ufe0f IndexedDB ch\u01b0a s\u1eb5n s\u00e0ng', 'warning');\n            return;\n        }\n        \n        try {\n            const transaction = db.transaction([STORE_NAME], 'readonly');\n            const objectStore = transaction.objectStore(STORE_NAME);\n            const request = objectStore.getAll();\n            \n            request.onsuccess = () => {\n                const audios = request.result;\n                renderSavedAudiosList(audios);\n            };\n            \n            request.onerror = () => {\n                addLogEntry(`\u274c L\u1ed7i load audio: ${request.error}`, 'error');\n            };\n        } catch (error) {\n            addLogEntry(`\u274c L\u1ed7i loadSavedAudios: ${error}`, 'error');\n        }\n    }\n    \n    // Render saved audios list\n    function renderSavedAudiosList(audios) {\n        const savedAudioList = document.getElementById('saved-audio-list');\n        const clearBtn = document.getElementById('clear-saved-audio-btn');\n        \n        if (!savedAudioList) return;\n        \n        if (audios.length === 0) {\n            savedAudioList.innerHTML = '<div style=\"padding: 10px; text-align: center; color: #94a3b8;\">Ch\u01b0a c\u00f3 audio n\u00e0o \u0111\u01b0\u1ee3c l\u01b0u</div>';\n            if (clearBtn) clearBtn.style.display = 'none';\n            return;\n        }\n        \n        savedAudioList.innerHTML = '';\n        if (clearBtn) clearBtn.style.display = 'block';\n        \n        audios.forEach(audio => {\n            \n            const item = document.createElement('div');\n            item.className = 'saved-audio-item';\n            \n            const name = document.createElement('span');\n            name.className = 'saved-audio-name';\n            name.textContent = audio.name;\n            name.title = audio.name;\n            \n            const duration = document.createElement('span');\n            duration.className = 'saved-audio-duration';\n            duration.textContent = formatDuration(audio.duration);\n            \n            const date = document.createElement('span');\n            date.className = 'saved-audio-date';\n            const uploadDate = new Date(audio.uploadDate);\n            date.textContent = uploadDate.toLocaleDateString('vi-VN');\n            date.title = uploadDate.toLocaleString('vi-VN');\n            \n            const useBtn = document.createElement('button');\n            useBtn.className = 'use-saved-audio-btn';\n            useBtn.textContent = '\ud83d\udd04';\n            useBtn.title = 'Ch\u1ecdn audio n\u00e0y';\n            useBtn.onclick = (e) => {\n                e.stopPropagation();\n                useSavedAudio(audio);\n            };\n            \n            const deleteBtn = document.createElement('button');\n            deleteBtn.className = 'delete-saved-audio-btn';\n            deleteBtn.textContent = '\ud83d\uddd1\ufe0f';\n            deleteBtn.title = 'X\u00f3a audio n\u00e0y';\n            deleteBtn.onclick = (e) => {\n                e.stopPropagation();\n                e.preventDefault();\n                deleteSavedAudio(audio.id);\n            };\n            \n            item.appendChild(name);\n            item.appendChild(duration);\n            item.appendChild(date);\n            item.appendChild(useBtn);\n            item.appendChild(deleteBtn);\n            \n            savedAudioList.appendChild(item);\n        });\n    }\n    \n    // Format duration (helper function)\n    function formatDuration(seconds) {\n        const mins = Math.floor(seconds / 60);\n        const secs = Math.floor(seconds % 60);\n        return `${mins}:${secs.toString().padStart(2, '0')}`;\n    }\n    \n    // Use saved audio (populate file input)\n    async function useSavedAudio(audio) {\n        try {\n            addLogEntry(`\ud83d\udd04 \u0110ang ch\u1ecdn audio: ${audio.name}`, 'info');\n            \n            // Create a new File object from blob\n            const file = new File([audio.blob], audio.name, { type: audio.type });\n            \n            // Create DataTransfer to populate file input\n            const dataTransfer = new DataTransfer();\n            dataTransfer.items.add(file);\n            \n            const fileInput = document.getElementById('gemini-file-input');\n            if (fileInput) {\n                fileInput.files = dataTransfer.files;\n                \n                // Trigger change event\n                const event = new Event('change', { bubbles: true });\n                fileInput.dispatchEvent(event);\n                \n                addLogEntry(`\u2705 \u0110\u00e3 ch\u1ecdn audio: ${audio.name}`, 'success');\n                \n                Swal.fire({\n                    toast: true,\n                    position: 'top-end',\n                    icon: 'success',\n                    title: '\u0110\u00e3 ch\u1ecdn audio',\n                    text: audio.name,\n                    showConfirmButton: false,\n                    timer: 2000,\n                    timerProgressBar: true\n                });\n            }\n        } catch (error) {\n            addLogEntry(`\u274c L\u1ed7i useSavedAudio: ${error}`, 'error');\n            Swal.fire({\n                icon: 'error',\n                title: 'L\u1ed7i',\n                text: 'Kh\u00f4ng th\u1ec3 ch\u1ecdn audio n\u00e0y'\n            });\n        }\n    }\n    \n    // Delete saved audio\n    async function deleteSavedAudio(id) {\n        if (!db) return;\n        \n        // Check if Swal exists\n        if (typeof Swal === 'undefined') {\n            const nativeConfirm = confirm('B\u1ea1n c\u00f3 ch\u1eafc mu\u1ed1n x\u00f3a audio n\u00e0y?');\n            if (!nativeConfirm) return;\n            \n            const transaction = db.transaction([STORE_NAME], 'readwrite');\n            const objectStore = transaction.objectStore(STORE_NAME);\n            const request = objectStore.delete(id);\n            \n            request.onsuccess = () => {\n                addLogEntry('\u2705 \u0110\u00e3 x\u00f3a audio', 'success');\n                loadSavedAudios();\n                alert('\u0110\u00e3 x\u00f3a audio!');\n            };\n            \n            request.onerror = () => {\n                addLogEntry(`\u274c L\u1ed7i x\u00f3a audio`, 'error');\n            };\n            return;\n        }\n        \n        try {\n            const result = await Swal.fire({\n                title: 'X\u00e1c nh\u1eadn x\u00f3a',\n                text: 'B\u1ea1n c\u00f3 ch\u1eafc mu\u1ed1n x\u00f3a audio n\u00e0y?',\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonText: 'X\u00f3a',\n                cancelButtonText: 'H\u1ee7y',\n                confirmButtonColor: '#ff5555',\n                customClass: {\n                    container: 'delete-audio-swal-container',\n                    popup: 'delete-audio-swal-popup'\n                },\n                backdrop: true\n            });\n            \n            if (!result.isConfirmed) return;\n            \n            const transaction = db.transaction([STORE_NAME], 'readwrite');\n            const objectStore = transaction.objectStore(STORE_NAME);\n            const request = objectStore.delete(id);\n            \n            request.onsuccess = () => {\n                addLogEntry('\u2705 \u0110\u00e3 x\u00f3a audio', 'success');\n                loadSavedAudios();\n                \n                Swal.fire({\n                    toast: true,\n                    position: 'top-end',\n                    icon: 'success',\n                    title: '\u0110\u00e3 x\u00f3a',\n                    showConfirmButton: false,\n                    timer: 1500\n                });\n            };\n            \n            request.onerror = () => {\n                addLogEntry(`\u274c L\u1ed7i x\u00f3a audio`, 'error');\n            };\n        } catch (error) {\n            addLogEntry(`\u274c L\u1ed7i x\u00f3a: ${error.message}`, 'error');\n        }\n    }\n    \n    // Clear all saved audios\n    async function clearAllSavedAudios() {\n        if (!db) return;\n        \n        // Check if Swal exists\n        if (typeof Swal === 'undefined') {\n            const nativeConfirm = confirm('B\u1ea1n c\u00f3 ch\u1eafc mu\u1ed1n x\u00f3a T\u1ea4T C\u1ea2 audio \u0111\u00e3 l\u01b0u?');\n            if (!nativeConfirm) return;\n            \n            const transaction = db.transaction([STORE_NAME], 'readwrite');\n            const objectStore = transaction.objectStore(STORE_NAME);\n            const request = objectStore.clear();\n            \n            request.onsuccess = () => {\n                addLogEntry('\u2705 \u0110\u00e3 x\u00f3a t\u1ea5t c\u1ea3 audio', 'success');\n                loadSavedAudios();\n                alert('\u0110\u00e3 x\u00f3a t\u1ea5t c\u1ea3 audio!');\n            };\n            \n            request.onerror = () => {\n                addLogEntry(`\u274c L\u1ed7i x\u00f3a t\u1ea5t c\u1ea3`, 'error');\n            };\n            return;\n        }\n        \n        try {\n            const result = await Swal.fire({\n                title: 'X\u00f3a t\u1ea5t c\u1ea3?',\n                text: 'B\u1ea1n c\u00f3 ch\u1eafc mu\u1ed1n x\u00f3a T\u1ea4T C\u1ea2 audio \u0111\u00e3 l\u01b0u?',\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonText: 'X\u00f3a t\u1ea5t c\u1ea3',\n                cancelButtonText: 'H\u1ee7y',\n                confirmButtonColor: '#ff5555',\n                customClass: {\n                    container: 'delete-audio-swal-container',\n                    popup: 'delete-audio-swal-popup'\n                },\n                backdrop: true\n            });\n            \n            if (!result.isConfirmed) return;\n            \n            const transaction = db.transaction([STORE_NAME], 'readwrite');\n            const objectStore = transaction.objectStore(STORE_NAME);\n            const request = objectStore.clear();\n            \n            request.onsuccess = () => {\n                addLogEntry('\u2705 \u0110\u00e3 x\u00f3a t\u1ea5t c\u1ea3 audio', 'success');\n                loadSavedAudios();\n                \n                Swal.fire({\n                    icon: 'success',\n                    title: '\u0110\u00e3 x\u00f3a t\u1ea5t c\u1ea3',\n                    showConfirmButton: false,\n                    timer: 1500\n                });\n            };\n            \n            request.onerror = () => {\n                addLogEntry(`\u274c L\u1ed7i x\u00f3a t\u1ea5t c\u1ea3`, 'error');\n            };\n        } catch (error) {\n            addLogEntry(`\u274c L\u1ed7i x\u00f3a: ${error.message}`, 'error');\n        }\n    }\n    \n    // Initialize IndexedDB and load saved audios\n    setTimeout(async () => {\n        try {\n            await initIndexedDB();\n            await loadSavedAudios();\n            \n            // Setup clear all button\n            const clearBtn = document.getElementById('clear-saved-audio-btn');\n            if (clearBtn) {\n                clearBtn.addEventListener('click', clearAllSavedAudios);\n            }\n            \n            addLogEntry('\u2705 H\u1ec7 th\u1ed1ng l\u01b0u audio \u0111\u00e3 s\u1eb5n s\u00e0ng', 'success');\n        } catch (error) {\n            addLogEntry(`\u274c L\u1ed7i kh\u1edfi t\u1ea1o IndexedDB: ${error}`, 'error');\n        }\n    }, 2000);\n    \n    // Hook into file upload success to auto-save\n    // We'll intercept the gemini-file-input change event\n    setTimeout(() => {\n        const fileInput = document.getElementById('gemini-file-input');\n        if (fileInput) {\n            // Store original change handler\n            const originalOnChange = fileInput.onchange;\n            \n            fileInput.addEventListener('change', async function(e) {\n                const files = e.target.files;\n                if (!files || files.length === 0) {\n                    // N\u1ebfu x\u00f3a file, disable n\u00fat \"B\u1eaft \u0111\u1ea7u\"\n                    const startBtn = document.getElementById('gemini-start-queue-btn');\n                    if (startBtn) startBtn.disabled = true;\n                    return;\n                }\n                \n                // Auto-save each audio file\n                for (let i = 0; i < files.length; i++) {\n                    const file = files[i];\n                    if (file.type.startsWith('audio/') || file.name.match(/\\.(mp3|wav|m4a|mpeg)$/i)) {\n                        try {\n                            // Get audio duration\n                            const duration = await getAudioDuration(file);\n                            \n                            // Validate duration: only save if 20-60 seconds\n                            if (duration >= 20 && duration <= 60) {\n                                // Save to IndexedDB\n                                await saveAudioToIndexedDB(file, duration);\n                            } else {\n                                addLogEntry(`\u26a0\ufe0f Audio \"${file.name}\" (${Math.floor(duration)}s) kh\u00f4ng h\u1ee3p l\u1ec7, kh\u00f4ng l\u01b0u v\u00e0o th\u01b0 vi\u1ec7n`, 'warning');\n                            }\n                        } catch (error) {\n                            // Silent fail\n                        }\n                    }\n                }\n                \n                // \u2705 ENABLE n\u00fat \"B\u1eaft \u0111\u1ea7u\" sau khi upload audio th\u00e0nh c\u00f4ng\n                const startBtn = document.getElementById('gemini-start-queue-btn');\n                const mainTextarea = document.getElementById('gemini-main-textarea');\n                if (startBtn && files.length > 0) {\n                    startBtn.disabled = !mainTextarea || mainTextarea.value.trim() === '';\n                }\n            }, false); // Use capture: false to not interfere with validation\n        }\n    }, 2500);\n    \n    // Helper: Get audio duration (reuse existing function if available)\n    async function getAudioDuration(file) {\n        return new Promise((resolve, reject) => {\n            const audio = document.createElement('audio');\n            const url = URL.createObjectURL(file);\n            \n            audio.addEventListener('loadedmetadata', () => {\n                URL.revokeObjectURL(url);\n                resolve(audio.duration);\n            });\n            \n            audio.addEventListener('error', () => {\n                URL.revokeObjectURL(url);\n                reject(new Error('Kh\u00f4ng th\u1ec3 load audio'));\n            });\n            \n            audio.src = url;\n        });\n    }\n    \n    // =================================================================\n    // == END INDEXEDDB ==\n    // =================================================================\n\n    // =================================================================\n    // == HISTORY MODAL - HI\u1ec2N TH\u1eca AUDIO \u0110\u00c3 T\u1ea0O ==\n    // =================================================================\n    \n    function initHistoryModal() {\n        // Kh\u1edfi t\u1ea1o modal \"Audio \u0111\u00e3 t\u1ea1o\" v\u00e0 c\u00e1c event listeners\n        const openHistoryBtn = document.getElementById('open-history-modal-btn');\n        const historyModal = document.getElementById('history-modal');\n        const clearAllHistoryBtn = document.getElementById('clear-all-history-btn');\n        \n        if (!openHistoryBtn || !historyModal) {\n            console.warn('Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat ho\u1eb7c modal history');\n            return;\n        }\n\n        // \u0110\u1ea3m b\u1ea3o HistoryDB \u0111\u00e3 \u0111\u01b0\u1ee3c init (v\u1edbi delay \u0111\u1ec3 tr\u00e1nh race condition)\n        setTimeout(async () => {\n            try {\n                await historyDB.init();\n            } catch (error) {\n                console.error('L\u1ed7i kh\u1edfi t\u1ea1o HistoryDB:', error);\n            }\n        }, 2000);\n\n        // M\u1edf modal khi click n\u00fat \"Audio \u0111\u00e3 t\u1ea1o\"\n        openHistoryBtn.addEventListener('click', async () => {\n            try {\n                historyModal.style.display = 'flex';\n                await renderHistory();\n            } catch (error) {\n                console.error('L\u1ed7i m\u1edf history modal:', error);\n                Swal.fire({\n                    icon: 'error',\n                    title: 'L\u1ed7i',\n                    text: 'Kh\u00f4ng th\u1ec3 t\u1ea3i l\u1ecbch s\u1eed audio!'\n                });\n            }\n        });\n\n        // X\u00f3a t\u1ea5t c\u1ea3 l\u1ecbch s\u1eed - kh\u00f4ng c\u1ea7n confirm\n        if (clearAllHistoryBtn) {\n            clearAllHistoryBtn.addEventListener('click', async () => {\n                try {\n                    // X\u00f3a tr\u1ef1c ti\u1ebfp kh\u00f4ng c\u1ea7n confirm\n                    await historyDB.clearAllHistory();\n                    await renderHistory();\n                    addLogEntry('\u2705 \u0110\u00e3 x\u00f3a to\u00e0n b\u1ed9 l\u1ecbch s\u1eed', 'success');\n                    \n                    // Hi\u1ec3n th\u1ecb toast notification\n                    Swal.fire({\n                        toast: true,\n                        position: 'top-end',\n                        icon: 'success',\n                        title: '\u0110\u00e3 x\u00f3a t\u1ea5t c\u1ea3',\n                        showConfirmButton: false,\n                        timer: 2000\n                    });\n                } catch (error) {\n                    console.error('\u274c L\u1ed7i x\u00f3a t\u1ea5t c\u1ea3:', error);\n                    addLogEntry(`\u274c L\u1ed7i x\u00f3a t\u1ea5t c\u1ea3: ${error.message}`, 'error');\n                    Swal.fire({\n                        toast: true,\n                        position: 'top-end',\n                        icon: 'error',\n                        title: 'Kh\u00f4ng th\u1ec3 x\u00f3a l\u1ecbch s\u1eed',\n                        showConfirmButton: false,\n                        timer: 2000\n                    });\n                }\n            });\n        }\n\n        // Helper functions\n        function formatTime(timestamp) {\n            const date = new Date(timestamp);\n            const now = new Date();\n            const diffMs = now - date;\n            const diffMins = Math.floor(diffMs / 60000);\n            const diffHours = Math.floor(diffMs / 3600000);\n            const diffDays = Math.floor(diffMs / 86400000);\n\n            if (diffMins < 1) return 'V\u1eeba xong';\n            if (diffMins < 60) return `${diffMins} ph\u00fat tr\u01b0\u1edbc`;\n            if (diffHours < 24) return `${diffHours} gi\u1edd tr\u01b0\u1edbc`;\n            if (diffDays < 7) return `${diffDays} ng\u00e0y tr\u01b0\u1edbc`;\n            \n            return date.toLocaleDateString('vi-VN', {\n                day: '2-digit',\n                month: '2-digit',\n                year: 'numeric',\n                hour: '2-digit',\n                minute: '2-digit'\n            });\n        }\n\n        function formatSize(bytes) {\n            if (bytes < 1024) return bytes + ' B';\n            if (bytes < 1048576) return (bytes / 1024).toFixed(2) + ' KB';\n            return (bytes / 1048576).toFixed(2) + ' MB';\n        }\n\n        async function renderHistory() {\n            // Render danh s\u00e1ch audio \u0111\u00e3 l\u01b0u v\u00e0o modal\n            const historyList = document.getElementById('history-list');\n            if (!historyList) {\n                console.error('Element #history-list kh\u00f4ng t\u1ed3n t\u1ea1i');\n                return;\n            }\n\n            try {\n                if (!historyDB) {\n                    throw new Error('HistoryDB ch\u01b0a \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o');\n                }\n                \n                console.log('\u0110ang l\u1ea5y history t\u1eeb IndexedDB...');\n                const history = await historyDB.getAllHistory();\n                console.log('\u0110\u00e3 l\u1ea5y history:', history.length, 'items');\n                \n                if (history.length === 0) {\n                    historyList.innerHTML = `\n                        <div style=\"text-align: center; padding: 40px; color: #94a3b8;\">\n                            <div style=\"font-size: 48px; margin-bottom: 16px;\">\ud83c\udfb5</div>\n                            <div style=\"font-size: 16px;\">Ch\u01b0a c\u00f3 audio n\u00e0o \u0111\u01b0\u1ee3c t\u1ea1o</div>\n                            <div style=\"font-size: 14px; margin-top: 8px;\">Audio s\u1ebd t\u1ef1 \u0111\u1ed9ng l\u01b0u sau khi t\u1ea1o xong</div>\n                        </div>\n                    `;\n                    return;\n                }\n\n                historyList.innerHTML = history.map((item, index) => {\n                    // \u0110\u1ea3m b\u1ea3o item c\u00f3 ID (fallback n\u1ebfu c\u0169 kh\u00f4ng c\u00f3)\n                    const itemId = item.id !== undefined ? item.id : index;\n                    return `\n                    <div style=\"background: #1e1e2e; border: 1px solid #6272a4; border-radius: 8px; padding: 16px; display: flex; justify-content: space-between; align-items: center; transition: all 0.2s;\">\n                        <div style=\"flex: 1; min-width: 0;\">\n                            <div style=\"color: #f8f8f2; font-weight: 600; font-size: 15px; margin-bottom: 8px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\">\n                                \ud83c\udfb5 ${item.fileName || 'Kh\u00f4ng c\u00f3 t\u00ean'}\n                            </div>\n                            <div style=\"display: flex; gap: 12px; color: #94a3b8; font-size: 13px;\">\n                                <span>\ud83d\udcca ${formatSize(item.size || 0)}</span>\n                                <span>\u2022</span>\n                                <span>\ud83d\udd52 ${formatTime(item.timestamp || Date.now())}</span>\n                                ${item.chunkCount ? `<span>\u2022</span><span>\ud83d\udd22 ${item.chunkCount} chunks</span>` : ''}\n                            </div>\n                        </div>\n                        <div style=\"display: flex; gap: 6px; margin-left: 16px;\">\n                            <button class=\"download-history-btn\" data-id=\"${itemId}\" style=\"background: #50fa7b; color: #282a36; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-weight: 600; font-size: 13px; transition: all 0.2s;\">\n                                \u2b07\ufe0f T\u1ea3i\n                            </button>\n                            <button class=\"delete-history-btn\" data-id=\"${itemId}\" style=\"background: #ff5555; color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-weight: 600; font-size: 13px; transition: all 0.2s;\">\n                                \ud83d\uddd1\ufe0f X\u00f3a\n                            </button>\n                        </div>\n                    </div>\n                `;}).join('');\n\n                // G\u1eafn event listeners cho c\u00e1c n\u00fat download v\u00e0 delete\n                historyList.querySelectorAll('.download-history-btn').forEach(btn => {\n                    btn.addEventListener('click', async () => {\n                        const id = parseInt(btn.dataset.id);\n                        await downloadHistoryItem(id);\n                    });\n                });\n\n                historyList.querySelectorAll('.delete-history-btn').forEach(btn => {\n                    btn.addEventListener('click', async () => {\n                        const id = parseInt(btn.dataset.id);\n                        await deleteHistoryItem(id);\n                    });\n                });\n\n            } catch (error) {\n                console.error('L\u1ed7i render history:', error);\n                addLogEntry(`\u274c L\u1ed7i render history: ${error.message}`, 'error');\n                historyList.innerHTML = `\n                    <div style=\"text-align: center; padding: 40px; color: #ff5555;\">\n                        <div style=\"font-size: 48px; margin-bottom: 16px;\">\u26a0\ufe0f</div>\n                        <div style=\"font-size: 16px;\">L\u1ed7i t\u1ea3i l\u1ecbch s\u1eed audio</div>\n                        <div style=\"font-size: 12px; margin-top: 8px; color: #94a3b8;\">${error.message}</div>\n                    </div>\n                `;\n            }\n        }\n\n        async function downloadHistoryItem(id) {\n            try {\n                console.log('Download item with ID:', id);\n                const history = await historyDB.getAllHistory();\n                console.log('History items:', history.map(h => ({ id: h.id, fileName: h.fileName })));\n                const item = history.find(h => h.id == id); // D\u00f9ng == \u0111\u1ec3 so s\u00e1nh loose (string vs number)\n                \n                if (!item) {\n                    throw new Error(`Kh\u00f4ng t\u00ecm th\u1ea5y file v\u1edbi ID ${id}`);\n                }\n\n                const url = URL.createObjectURL(item.blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = item.fileName;\n                a.style.display = 'none';\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                URL.revokeObjectURL(url);\n\n                addLogEntry(`\u2705 \u0110\u00e3 t\u1ea3i xu\u1ed1ng: ${item.fileName}`, 'success');\n            } catch (error) {\n                console.error('\u274c L\u1ed7i t\u1ea3i xu\u1ed1ng:', error);\n                Swal.fire({\n                    icon: 'error',\n                    title: 'L\u1ed7i',\n                    text: 'Kh\u00f4ng th\u1ec3 t\u1ea3i xu\u1ed1ng file!'\n                });\n            }\n        }\n\n        async function deleteHistoryItem(id) {\n            try {\n                console.log('Delete item with ID:', id);\n                \n                // X\u00f3a tr\u1ef1c ti\u1ebfp kh\u00f4ng c\u1ea7n confirm\n                await historyDB.deleteHistoryItem(id);\n                await renderHistory();\n                addLogEntry('\u2705 \u0110\u00e3 x\u00f3a audio kh\u1ecfi l\u1ecbch s\u1eed', 'success');\n                \n                // Hi\u1ec3n th\u1ecb toast notification\n                Swal.fire({\n                    toast: true,\n                    position: 'top-end',\n                    icon: 'success',\n                    title: '\u0110\u00e3 x\u00f3a',\n                    showConfirmButton: false,\n                    timer: 1500\n                });\n            } catch (error) {\n                console.error('\u274c L\u1ed7i x\u00f3a:', error);\n                addLogEntry(`\u274c L\u1ed7i x\u00f3a: ${error.message}`, 'error');\n                Swal.fire({\n                    toast: true,\n                    position: 'top-end',\n                    icon: 'error',\n                    title: 'Kh\u00f4ng th\u1ec3 x\u00f3a file',\n                    showConfirmButton: false,\n                    timer: 2000\n                });\n            }\n        }\n    }\n\n    // Kh\u1edfi t\u1ea1o history modal sau khi DOM s\u1eb5n s\u00e0ng\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', initHistoryModal);\n    } else {\n        setTimeout(initHistoryModal, 100);\n    }\n\n    // =======================================================\n    // == BATCH PROCESSING SYSTEM ==\n    // =======================================================\n    \n    // Batch state management\n    let batchState = {\n        files: [],              // Danh s\u00e1ch File objects\n        selectedFiles: [],      // Danh s\u00e1ch file \u0111\u00e3 ch\u1ecdn (checked)\n        currentIndex: 0,        // Index file \u0111ang x\u1eed l\u00fd\n        isProcessing: false,    // \u0110ang x\u1eed l\u00fd hay kh\u00f4ng\n        isStopped: false,       // User b\u1ea5m d\u1eebng\n        successCount: 0,\n        failedCount: 0\n    };\n    \n    // Expose batchState ra global scope \u0111\u1ec3 auto-fix punctuation c\u00f3 th\u1ec3 truy c\u1eadp\n    window.batchState = batchState;\n\n    // H\u00e0m \u0111\u1ecdc file text\n    function readTextFile(file) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = (e) => resolve(e.target.result);\n            reader.onerror = (e) => reject(e);\n            reader.readAsText(file, 'UTF-8');\n        });\n    }\n\n    // H\u00e0m render danh s\u00e1ch file\n    function renderBatchFilesList() {\n        const listContainer = document.getElementById('batch-files-list');\n        const startBtn = document.getElementById('start-batch-btn');\n        \n        if (batchState.files.length === 0) {\n            listContainer.innerHTML = `\n                <div style=\"text-align: center; color: #94a3b8; padding: 40px;\">\n                    <div style=\"font-size: 48px; margin-bottom: 10px;\">\ud83d\udcc1</div>\n                    <div>Ch\u01b0a c\u00f3 file n\u00e0o \u0111\u01b0\u1ee3c ch\u1ecdn</div>\n                    <div style=\"font-size: 12px; margin-top: 5px;\">Click n\u00fat \"Ch\u1ecdn file text\" \u0111\u1ec3 b\u1eaft \u0111\u1ea7u</div>\n                </div>\n            `;\n            startBtn.disabled = true;\n            return;\n        }\n\n        let html = '<div style=\"display: flex; flex-direction: column; gap: 8px;\">';\n        batchState.files.forEach((file, index) => {\n            const sizeKB = (file.size / 1024).toFixed(2);\n            const isSelected = batchState.selectedFiles.includes(index);\n            html += `\n                <div style=\"display: flex; align-items: center; gap: 12px; padding: 12px; background: #282a36; border: 1px solid #6272a4; border-radius: 6px; transition: all 0.2s;\">\n                    <input type=\"checkbox\" class=\"batch-file-checkbox\" data-index=\"${index}\" ${isSelected ? 'checked' : ''} \n                           style=\"width: 18px; height: 18px; cursor: pointer;\">\n                    <div style=\"flex: 1; min-width: 0;\">\n                        <div style=\"color: #f8f8f2; font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\">\n                            \ud83d\udcc4 ${file.name}\n                        </div>\n                        <div style=\"color: #94a3b8; font-size: 12px; margin-top: 4px;\">\n                            ${sizeKB} KB\n                        </div>\n                    </div>\n                    <div style=\"color: #8be9fd; font-size: 20px;\">\n                        ${index + 1}\n                    </div>\n                </div>\n            `;\n        });\n        html += '</div>';\n        \n        listContainer.innerHTML = html;\n\n        // Attach event listeners cho checkboxes\n        document.querySelectorAll('.batch-file-checkbox').forEach(checkbox => {\n            checkbox.addEventListener('change', (e) => {\n                const index = parseInt(e.target.dataset.index);\n                if (e.target.checked) {\n                    if (!batchState.selectedFiles.includes(index)) {\n                        batchState.selectedFiles.push(index);\n                    }\n                } else {\n                    batchState.selectedFiles = batchState.selectedFiles.filter(i => i !== index);\n                }\n                startBtn.disabled = batchState.selectedFiles.length === 0;\n            });\n        });\n\n        // Enable start button n\u1ebfu c\u00f3 file \u0111\u01b0\u1ee3c ch\u1ecdn\n        startBtn.disabled = batchState.selectedFiles.length === 0;\n    }\n\n    // H\u00e0m x\u1eed l\u00fd 1 file - S\u1eed d\u1ee5ng simulate click thay v\u00ec g\u1ecdi h\u00e0m tr\u1ef1c ti\u1ebfp\n    async function processSingleBatchFile(file, index, total) {\n        return new Promise(async (resolve, reject) => {\n            try {\n                addLogEntry(`\ud83d\udcc4 [Batch ${index + 1}/${total}] B\u1eaft \u0111\u1ea7u x\u1eed l\u00fd: ${file.name}`, 'info');\n                \n                // === QUAN TR\u1eccNG: SET BATCH FLAG S\u1edaM ===\n                // \u0110\u1ea3m b\u1ea3o flag \u0111\u01b0\u1ee3c set TR\u01af\u1edaC KHI click n\u00fat \u0111\u1ec3 auto-fix punctuation ho\u1ea1t \u0111\u1ed9ng\n                if (!window.batchState) {\n                    window.batchState = {};\n                }\n                window.batchState.isProcessing = true;\n                // ===================================\n                \n                // 1. \u0110\u1ecdc n\u1ed9i dung file\n                const textContent = await readTextFile(file);\n                addLogEntry(`\u2705 \u0110\u00e3 \u0111\u1ecdc file (${(file.size / 1024).toFixed(2)} KB)`, 'info');\n                \n                // 2. G\u00e1n v\u00e0o textarea\n                const textarea = document.getElementById('gemini-main-textarea');\n                if (!textarea) {\n                    throw new Error('Kh\u00f4ng t\u00ecm th\u1ea5y textarea');\n                }\n                textarea.value = textContent;\n                \n                // 3. Update batch progress UI\n                document.getElementById('batch-current-file').textContent = file.name;\n                document.getElementById('batch-progress-text').textContent = `${index + 1}/${total}`;\n                const progressPercent = Math.round(((index + 1) / total) * 100);\n                document.getElementById('batch-progress-bar').style.width = `${progressPercent}%`;\n                \n                // 4. T\u00ecm n\u00fat Start\n                const startBtn = document.getElementById('gemini-start-queue-btn');\n                if (!startBtn) {\n                    throw new Error('Kh\u00f4ng t\u00ecm th\u1ea5y n\u00fat Start');\n                }\n                \n                // 5. Setup listener \u0111\u1ec3 bi\u1ebft khi n\u00e0o x\u1eed l\u00fd xong\n                let audioCompleted = false;\n                let checkInterval = null;\n                \n                // Function \u0111\u1ec3 check xem \u0111\u00e3 xong ch\u01b0a\n                const checkCompletion = () => {\n                    const downloadBtn = document.getElementById('gemini-download-merged-btn');\n                    const finalResult = document.getElementById('gemini-final-result');\n                    \n                    // Check n\u1ebfu UI hi\u1ec3n th\u1ecb k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng\n                    if (finalResult && finalResult.style.display === 'block' && \n                        downloadBtn && downloadBtn.href && downloadBtn.href.startsWith('blob:')) {\n                        audioCompleted = true;\n                        if (checkInterval) clearInterval(checkInterval);\n                        \n                        addLogEntry(`\u2705 [Batch ${index + 1}/${total}] Ho\u00e0n th\u00e0nh: ${file.name}`, 'success');\n                        batchState.successCount++;\n                        \n                        // \u0110\u1ee3i th\u00eam ch\u00fat \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o \u0111\u00e3 l\u01b0u v\u00e0o history\n                        setTimeout(() => resolve(true), 2000);\n                    }\n                };\n                \n                // 6. SIMULATE CLICK n\u00fat Start \u0111\u1ec3 trigger flow t\u1ef1 nhi\u00ean\n                addLogEntry(`\ud83d\uddb1\ufe0f \u0110ang trigger t\u1ea1o audio...`, 'info');\n                startBtn.click();\n                \n                // 7. Poll \u0111\u1ec3 check xem \u0111\u00e3 xong ch\u01b0a (check m\u1ed7i 2 gi\u00e2y)\n                checkInterval = setInterval(checkCompletion, 2000);\n                \n                // 8. Timeout sau 5 ph\u00fat\n                setTimeout(() => {\n                    if (!audioCompleted) {\n                        if (checkInterval) clearInterval(checkInterval);\n                        addLogEntry(`\u274c [Batch ${index + 1}/${total}] Timeout: ${file.name}`, 'error');\n                        batchState.failedCount++;\n                        resolve(false);\n                    }\n                }, 300000); // 5 ph\u00fat\n                \n            } catch (error) {\n                addLogEntry(`\u274c [Batch ${index + 1}/${total}] L\u1ed7i: ${file.name} - ${error.message}`, 'error');\n                console.error('L\u1ed7i t\u1ea1o file h\u00e0ng lo\u1ea1t:', error);\n                batchState.failedCount++;\n                reject(error);\n            }\n        });\n    }\n\n    // H\u00e0m x\u1eed l\u00fd batch ch\u00ednh\n    async function processBatchQueue() {\n        if (batchState.selectedFiles.length === 0) {\n            addLogEntry('\u26a0\ufe0f Ch\u01b0a ch\u1ecdn file n\u00e0o \u0111\u1ec3 x\u1eed l\u00fd', 'warning');\n            return;\n        }\n\n        // Set flag batch mode NGAY t\u1eeb \u0111\u1ea7u\n        batchState.isProcessing = true;\n        window.batchState = batchState; // Expose ra global\n        batchState.isStopped = false;\n        batchState.currentIndex = 0;\n        batchState.successCount = 0;\n        batchState.failedCount = 0;\n        \n        console.log('\ud83d\ude80 [Batch] B\u1eaft \u0111\u1ea7u - isProcessing:', batchState.isProcessing);\n\n        // Show progress, hide start button\n        document.getElementById('batch-progress').style.display = 'block';\n        document.getElementById('start-batch-btn').style.display = 'none';\n        document.getElementById('stop-batch-btn').style.display = 'block';\n        document.getElementById('select-batch-files-btn').disabled = true;\n\n        addLogEntry(`\ud83d\ude80 B\u1eaft \u0111\u1ea7u t\u1ea1o file h\u00e0ng lo\u1ea1t ${batchState.selectedFiles.length} file...`, 'success');\n\n        // Sort selected files \u0111\u1ec3 x\u1eed l\u00fd theo th\u1ee9 t\u1ef1\n        const sortedIndices = [...batchState.selectedFiles].sort((a, b) => a - b);\n\n        for (let i = 0; i < sortedIndices.length; i++) {\n            if (batchState.isStopped) {\n                addLogEntry('\u23f9\ufe0f T\u1ea1o file h\u00e0ng lo\u1ea1t \u0111\u00e3 b\u1ecb d\u1eebng b\u1edfi ng\u01b0\u1eddi d\u00f9ng', 'warning');\n                batchState.isProcessing = false; // Reset flag khi stop\n                break;\n            }\n\n            const fileIndex = sortedIndices[i];\n            const file = batchState.files[fileIndex];\n            batchState.currentIndex = i;\n\n            await processSingleBatchFile(file, i, sortedIndices.length);\n\n            // Delay nh\u1ecf gi\u1eefa c\u00e1c file\n            if (i < sortedIndices.length - 1) {\n                await new Promise(resolve => setTimeout(resolve, 2000));\n            }\n        }\n\n        // Ho\u00e0n th\u00e0nh (n\u1ebfu ch\u01b0a reset \u1edf tr\u00ean do stop)\n        batchState.isProcessing = false;\n        console.log('\u2705 [Batch] Ho\u00e0n th\u00e0nh - isProcessing:', batchState.isProcessing);\n        \n        document.getElementById('batch-progress').style.display = 'none';\n        document.getElementById('start-batch-btn').style.display = 'block';\n        document.getElementById('stop-batch-btn').style.display = 'none';\n        document.getElementById('select-batch-files-btn').disabled = false;\n\n        addLogEntry(`\ud83c\udf89 T\u1ea1o file h\u00e0ng lo\u1ea1t ho\u00e0n th\u00e0nh!`, 'success');\n        addLogEntry(`\u2705 Th\u00e0nh c\u00f4ng: ${batchState.successCount}/${sortedIndices.length}`, 'success');\n        if (batchState.failedCount > 0) {\n            addLogEntry(`\u274c Th\u1ea5t b\u1ea1i: ${batchState.failedCount}/${sortedIndices.length}`, 'error');\n        }\n\n        // Show notification\n        Swal.fire({\n            icon: batchState.failedCount === 0 ? 'success' : 'warning',\n            title: 'T\u1ea1o File H\u00e0ng Lo\u1ea1t Ho\u00e0n Th\u00e0nh!',\n            html: `\n                <div style=\"text-align: left;\">\n                    <p>\u2705 Th\u00e0nh c\u00f4ng: ${batchState.successCount} file</p>\n                    ${batchState.failedCount > 0 ? `<p>\u274c Th\u1ea5t b\u1ea1i: ${batchState.failedCount} file</p>` : ''}\n                    <p style=\"margin-top: 10px; color: #8be9fd;\">Ki\u1ec3m tra \"Audio \u0111\u00e3 t\u1ea1o\" \u0111\u1ec3 xem k\u1ebft qu\u1ea3!</p>\n                </div>\n            `\n        });\n    }\n\n    // Initialize batch modal\n    function initBatchModal() {\n        // Debug: Check if required functions are available\n        addLogEntry('\ud83d\udd0d [BATCH INIT] \u0110ang kh\u1edfi t\u1ea1o batch modal...', 'info');\n        addLogEntry(`\ud83d\udd0d [BATCH INIT] window.smartSplitter: ${typeof window.smartSplitter}`, 'info');\n        addLogEntry(`\ud83d\udd0d [BATCH INIT] window.manageFullQueue: ${typeof window.manageFullQueue}`, 'info');\n        addLogEntry(`\ud83d\udd0d [BATCH INIT] window.processingState: ${typeof window.processingState}`, 'info');\n        \n        const openBtn = document.getElementById('open-batch-modal-btn');\n        const modal = document.getElementById('batch-modal');\n        const selectBtn = document.getElementById('select-batch-files-btn');\n        const fileInput = document.getElementById('batch-files-input');\n        const startBtn = document.getElementById('start-batch-btn');\n        const stopBtn = document.getElementById('stop-batch-btn');\n\n        if (!openBtn || !modal) {\n            addLogEntry('\u26a0\ufe0f [BATCH INIT] Kh\u00f4ng t\u00ecm th\u1ea5y elements!', 'warning');\n            return;\n        }\n        \n        addLogEntry('\u2705 [BATCH INIT] Batch modal \u0111\u00e3 s\u1eb5n s\u00e0ng!', 'success');\n\n        // M\u1edf modal\n        openBtn.addEventListener('click', () => {\n            modal.style.display = 'flex';\n        });\n\n        // Ch\u1ecdn files\n        selectBtn.addEventListener('click', () => {\n            fileInput.click();\n        });\n\n        // Handle file selection\n        fileInput.addEventListener('change', (e) => {\n            const files = Array.from(e.target.files);\n            if (files.length === 0) return;\n\n            batchState.files = files;\n            // M\u1eb7c \u0111\u1ecbnh select all files\n            batchState.selectedFiles = files.map((_, index) => index);\n            \n            addLogEntry(`\ud83d\udcda \u0110\u00e3 ch\u1ecdn ${files.length} file text`, 'success');\n            renderBatchFilesList();\n        });\n\n        // Start batch\n        startBtn.addEventListener('click', () => {\n            processBatchQueue();\n        });\n\n        // Stop batch\n        stopBtn.addEventListener('click', () => {\n            batchState.isStopped = true;\n            batchState.isProcessing = false;\n            const ps = window.processingState || processingState;\n            if (ps) ps.isStopped = true;\n            addLogEntry('\u23f9\ufe0f \u0110ang d\u1eebng t\u1ea1o file h\u00e0ng lo\u1ea1t...', 'warning');\n        });\n    }\n\n    // Kh\u1edfi t\u1ea1o batch modal sau khi DOM v\u00e0 t\u1ea5t c\u1ea3 scripts \u0111\u00e3 s\u1eb5n s\u00e0ng\n    // Timeout l\u00e2u h\u01a1n \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o smartSplitter v\u00e0 c\u00e1c h\u00e0m kh\u00e1c \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', () => {\n            setTimeout(initBatchModal, 2000);\n        });\n    } else {\n        setTimeout(initBatchModal, 2000);\n    }\n\n    // L\u1eafng nghe s\u1ef1 ki\u1ec7n beforeunload \u0111\u1ec3 d\u1ecdn d\u1eb9p\n    window.addEventListener('beforeunload', () => {\n        stopAutoReset403();\n        if (errorObserver) {\n            errorObserver.disconnect();\n        }\n        \n        // Close IndexedDB connection\n        if (db) {\n            db.close();\n        }\n    });",
  "args": []
}